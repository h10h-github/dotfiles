<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Capybara::Node::Base - capybara-2.4.4 Documentation</title>

<link href="../../fonts.css" rel="stylesheet">
<link href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/navigation.js"></script>
<script src="../../js/search_index.js"></script>
<script src="../../js/search.js"></script>
<script src="../../js/searcher.js"></script>
<script src="../../js/darkfish.js"></script>


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../../Object.html">Object</a>
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="Finders.html">Capybara::Node::Finders</a>
  
  
  
    <li><a class="include" href="Actions.html">Capybara::Node::Actions</a>
  
  
  
    <li><a class="include" href="Matchers.html">Capybara::Node::Matchers</a>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-catch_error-3F">#catch_error?</a>
    
    <li ><a href="#method-i-driver">#driver</a>
    
    <li ><a href="#method-i-find_css">#find_css</a>
    
    <li ><a href="#method-i-find_xpath">#find_xpath</a>
    
    <li ><a href="#method-i-reload">#reload</a>
    
    <li ><a href="#method-i-synchronize">#synchronize</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Capybara::Node::Base">
  <h1 id="class-Capybara::Node::Base" class="class">
    class Capybara::Node::Base
  </h1>

  <section class="description">
    
<p>A {Capybara::Node::Base} represents either an element on a page through the
subclass {Capybara::Node::Element} or a document through
{Capybara::Node::Document}.</p>

<p>Both types of Node share the same methods, used for interacting with the
elements on the page. These methods are divided into three categories,
finders, actions and matchers. These are found in the modules
{Capybara::Node::Finders}, {Capybara::Node::Actions} and
{Capybara::Node::Matchers} respectively.</p>

<p>A {Capybara::Session} exposes all methods from {Capybara::Node::Document}
directly:</p>

<pre class="ruby"><span class="ruby-identifier">session</span> = <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span>.<span class="ruby-identifier">new</span>(:<span class="ruby-identifier">rack_test</span>, <span class="ruby-identifier">my_app</span>)
<span class="ruby-identifier">session</span>.<span class="ruby-identifier">visit</span>(<span class="ruby-string">&#39;/&#39;</span>)
<span class="ruby-identifier">session</span>.<span class="ruby-identifier">fill_in</span>(<span class="ruby-string">&#39;Foo&#39;</span>, :<span class="ruby-identifier">with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Bar&#39;</span>)    <span class="ruby-comment"># from Capybara::Node::Actions</span>
<span class="ruby-identifier">bar</span> = <span class="ruby-identifier">session</span>.<span class="ruby-identifier">find</span>(<span class="ruby-string">&#39;#bar&#39;</span>)                <span class="ruby-comment"># from Capybara::Node::Finders</span>
<span class="ruby-identifier">bar</span>.<span class="ruby-identifier">select</span>(<span class="ruby-string">&#39;Baz&#39;</span>, :<span class="ruby-identifier">from</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Quox&#39;</span>)        <span class="ruby-comment"># from Capybara::Node::Actions</span>
<span class="ruby-identifier">session</span>.<span class="ruby-identifier">has_css?</span>(<span class="ruby-string">&#39;#foobar&#39;</span>)               <span class="ruby-comment"># from Capybara::Node::Matchers</span>
</pre>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-base" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">base</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-parent" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parent</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-session" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">session</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(session, base)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/capybara/node/base.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">session</span>, <span class="ruby-identifier">base</span>)
  <span class="ruby-ivar">@session</span> = <span class="ruby-identifier">session</span>
  <span class="ruby-ivar">@base</span> = <span class="ruby-identifier">base</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-find_css" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_css</span><span
            class="method-args">(css)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@api private</p>
          
          

          
          <div class="method-source-code" id="find_css-source">
            <pre><span class="ruby-comment"># File lib/capybara/node/base.rb, line 101</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_css</span>(<span class="ruby-identifier">css</span>)
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">find_css</span>(<span class="ruby-identifier">css</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-find_xpath" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_xpath</span><span
            class="method-args">(xpath)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@api private</p>
          
          

          
          <div class="method-source-code" id="find_xpath-source">
            <pre><span class="ruby-comment"># File lib/capybara/node/base.rb, line 106</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_xpath</span>(<span class="ruby-identifier">xpath</span>)
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">find_xpath</span>(<span class="ruby-identifier">xpath</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reload" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reload</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>overridden in subclasses, e.g. <a
href="Element.html">Capybara::Node::Element</a></p>
          
          

          
          <div class="method-source-code" id="reload-source">
            <pre><span class="ruby-comment"># File lib/capybara/node/base.rb, line 37</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reload</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-synchronize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">synchronize</span><span
            class="method-args">(seconds=Capybara.default_wait_time, options = {}) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This method is Capybara&#39;s primary defence against asynchronicity
problems. It works by attempting to run a given block of code until it
succeeds. The exact behaviour of this method depends on a number of
factors. Basically there are certain exceptions which, when raised from the
block, instead of bubbling up, are caught, and the block is re-run.</p>

<p>Certain drivers, such as RackTest, have no support for asynchronous
processes, these drivers run the block, and any error raised bubbles up
immediately. This allows faster turn around in the case where an
expectation fails.</p>

<p>Only exceptions that are {Capybara::ElementNotFound} or any subclass
thereof cause the block to be rerun. Drivers may specify additional
exceptions which also cause reruns. This usually occurs when a node is
manipulated which no longer exists on the page. For example, the Selenium
driver specifies `Selenium::WebDriver::Error::ObsoleteElementError`.</p>

<p>As long as any of these exceptions are thrown, the block is re-run, until a
certain amount of time passes. The amount of time defaults to
{Capybara.default_wait_time} and can be overridden through the `seconds`
argument. This time is compared with the system time to see how much time
has passed. If the return value of `Time.now` is stubbed out, Capybara will
raise `Capybara::FrozenInTime`.</p>

<p>@param  [Integer] seconds         Number of seconds to retry this block
@param options [Hash] @option options [Array&lt;Exception&gt;] :errors
(driver.invalid_element_errors +</p>

<pre>[Capybara::ElementNotFound]) exception types that cause the block to be rerun</pre>

<p>@return [Object]                  The result of the given block @raise 
[Capybara::FrozenInTime]  If the return value of `Time.now` appears stuck</p>
          
          

          
          <div class="method-source-code" id="synchronize-source">
            <pre><span class="ruby-comment"># File lib/capybara/node/base.rb, line 76</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">synchronize</span>(<span class="ruby-identifier">seconds</span>=<span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">default_wait_time</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">start_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">synchronized</span>
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">session</span>.<span class="ruby-identifier">synchronized</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">yield</span>
    <span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
      <span class="ruby-identifier">session</span>.<span class="ruby-identifier">raise_server_error!</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">driver</span>.<span class="ruby-identifier">wait?</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">catch_error?</span>(<span class="ruby-identifier">e</span>, <span class="ruby-identifier">options</span>[<span class="ruby-value">:errors</span>])
      <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">if</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">start_time</span>) <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">seconds</span>
      <span class="ruby-identifier">sleep</span>(<span class="ruby-value">0.05</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">FrozenInTime</span>, <span class="ruby-string">&quot;time appears to be frozen, Capybara does not work with libraries which freeze time, consider using time travelling instead&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">start_time</span>
      <span class="ruby-identifier">reload</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Capybara</span>.<span class="ruby-identifier">automatic_reload</span>
      <span class="ruby-keyword">retry</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">session</span>.<span class="ruby-identifier">synchronized</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Protected Instance Methods</h3>
       </header>

    
      <div id="method-i-catch_error-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">catch_error?</span><span
            class="method-args">(error, errors = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="catch_error-3F-source">
            <pre><span class="ruby-comment"># File lib/capybara/node/base.rb, line 112</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">catch_error?</span>(<span class="ruby-identifier">error</span>, <span class="ruby-identifier">errors</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">errors</span> <span class="ruby-operator">||=</span> (<span class="ruby-identifier">driver</span>.<span class="ruby-identifier">invalid_element_errors</span> <span class="ruby-operator">+</span> [<span class="ruby-constant">Capybara</span><span class="ruby-operator">::</span><span class="ruby-constant">ElementNotFound</span>])
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">any?</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">type</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">error</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-driver" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">driver</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="driver-source">
            <pre><span class="ruby-comment"># File lib/capybara/node/base.rb, line 119</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">driver</span>
  <span class="ruby-identifier">session</span>.<span class="ruby-identifier">driver</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

