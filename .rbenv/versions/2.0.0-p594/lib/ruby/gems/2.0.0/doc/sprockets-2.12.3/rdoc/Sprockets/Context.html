<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Sprockets::Context - sprockets-2.12.3 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    
    <div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    
  
    <li><a class="extend" href="EngineError.html">Sprockets::EngineError</a>
  
  
  </ul>
</div>

    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-annotate_exception-21">#annotate_exception!</a>
    
    <li ><a href="#method-i-asset_data_uri">#asset_data_uri</a>
    
    <li ><a href="#method-i-asset_path">#asset_path</a>
    
    <li ><a href="#method-i-asset_requirable-3F">#asset_requirable?</a>
    
    <li ><a href="#method-i-audio_path">#audio_path</a>
    
    <li ><a href="#method-i-content_type">#content_type</a>
    
    <li ><a href="#method-i-depend_on">#depend_on</a>
    
    <li ><a href="#method-i-depend_on_asset">#depend_on_asset</a>
    
    <li ><a href="#method-i-evaluate">#evaluate</a>
    
    <li ><a href="#method-i-font_path">#font_path</a>
    
    <li ><a href="#method-i-image_path">#image_path</a>
    
    <li ><a href="#method-i-javascript_path">#javascript_path</a>
    
    <li ><a href="#method-i-logger">#logger</a>
    
    <li ><a href="#method-i-logical_path">#logical_path</a>
    
    <li ><a href="#method-i-require_asset">#require_asset</a>
    
    <li ><a href="#method-i-resolve">#resolve</a>
    
    <li ><a href="#method-i-root_path">#root_path</a>
    
    <li ><a href="#method-i-stub_asset">#stub_asset</a>
    
    <li ><a href="#method-i-stylesheet_path">#stylesheet_path</a>
    
    <li ><a href="#method-i-video_path">#video_path</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Sprockets::Context">
  <h1 id="class-Sprockets::Context" class="class">
    class Sprockets::Context
  </h1>

  <section class="description">
    
<p>`Context` provides helper methods to all `Tilt` processors. They are
typically accessed by ERB templates. You can mix in custom helpers by
injecting them into `Environment#context_class`. Do not mix them into
`Context` directly.</p>

<pre>environment.context_class.class_eval do
  include MyHelper
  def asset_url; end
end

&lt;%= asset_url &quot;foo.png&quot; %&gt;</pre>

<p>The `Context` also collects dependencies declared by assets. See
`DirectiveProcessor` for an example of this.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-__LINE__" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">__LINE__</span><span
            class="attribute-access-type">[W]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-_dependency_assets" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">_dependency_assets</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-_dependency_paths" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">_dependency_paths</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-_required_paths" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">_required_paths</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-_stubbed_assets" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">_stubbed_assets</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-environment" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">environment</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-pathname" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">pathname</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(environment, logical_path, pathname)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 29</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">environment</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
  <span class="ruby-ivar">@environment</span>  = <span class="ruby-identifier">environment</span>
  <span class="ruby-ivar">@logical_path</span> = <span class="ruby-identifier">logical_path</span>
  <span class="ruby-ivar">@pathname</span>     = <span class="ruby-identifier">pathname</span>
  <span class="ruby-ivar">@__LINE__</span>     = <span class="ruby-keyword">nil</span>

  <span class="ruby-ivar">@_required_paths</span>    = []
  <span class="ruby-ivar">@_stubbed_assets</span>    = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@_dependency_paths</span>  = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@_dependency_assets</span> = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>([<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>])
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-asset_data_uri" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">asset_data_uri</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a Base64-encoded `data:` URI with the contents of the asset at the
specified path, and marks that path as a dependency of the current file.</p>

<p>Use `asset_data_uri` from ERB with CSS or JavaScript assets:</p>

<pre>#logo { background: url(&lt;%= asset_data_uri &#39;logo.png&#39; %&gt;) }

$(&#39;&lt;img&gt;&#39;).attr(&#39;src&#39;, &#39;&lt;%= asset_data_uri &#39;avatar.jpg&#39; %&gt;&#39;)</pre>
          
          

          
          <div class="method-source-code" id="asset_data_uri-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 217</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">asset_data_uri</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset</span>  = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">find_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">base64</span> = <span class="ruby-constant">Base64</span>.<span class="ruby-identifier">encode64</span>(<span class="ruby-identifier">asset</span>.<span class="ruby-identifier">to_s</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\s+/</span>, <span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-node">&quot;data:#{asset.content_type};base64,#{Rack::Utils.escape(base64)}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-asset_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">asset_path</span><span
            class="method-args">(path, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Expands logical path to full url to asset.</p>

<p>NOTE: This helper is currently not implemented and should be customized by
the application. Though, in the future, some basics implemention may be
provided with different methods that are required to be overridden.</p>
          
          

          
          <div class="method-source-code" id="asset_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 230</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {})
      <span class="ruby-identifier">message</span> = <span class="ruby-value">&lt;&lt;-EOS
Custom asset_path helper is not implemented

Extend your environment context with a custom method.

    environment.context_class.class_eval do
      def asset_path(path, options = {})
      end
    end
      EOS</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-identifier">message</span>
    <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-asset_requirable-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">asset_requirable?</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Tests if target path is able to be safely required into the current
concatenation.</p>
          
          

          
          <div class="method-source-code" id="asset_requirable-3F-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 162</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">asset_requirable?</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">content_type</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-identifier">stat</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">stat</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">file?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">content_type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-audio_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">audio_path</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Expand logical audio asset path.</p>
          
          

          
          <div class="method-source-code" id="audio_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">audio_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:audio</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-content_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">content_type</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns content type of file</p>

<pre class="ruby"><span class="ruby-string">&#39;application/javascript&#39;</span>
<span class="ruby-string">&#39;text/css&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="content_type-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">content_type</span>
  <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">pathname</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-depend_on" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depend_on</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>`depend_on` allows you to state a dependency on a file without including
it.</p>

<p>This is used for caching purposes. Any changes made to the dependency file
with invalidate the cache of the source file.</p>
          
          

          
          <div class="method-source-code" id="depend_on-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 118</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">depend_on</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-ivar">@_dependency_paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-depend_on_asset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depend_on_asset</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>`depend_on_asset` allows you to state an asset dependency without including
it.</p>

<p>This is used for caching purposes. Any changes that would invalidate the
dependency asset will invalidate the source file. Unlike `depend_on`, this
will include recursively include the target asset&#39;s dependencies.</p>
          
          

          
          <div class="method-source-code" id="depend_on_asset-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 130</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-ivar">@_dependency_assets</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">filename</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-evaluate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evaluate</span><span
            class="method-args">(path, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Reads `path` and runs processors on the file.</p>

<p>This allows you to capture the result of an asset and include it directly
in another.</p>

<pre>&lt;%= evaluate &quot;bar.js&quot; %&gt;</pre>
          
          

          
          <div class="method-source-code" id="evaluate-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 177</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evaluate</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">pathname</span>   = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-identifier">processors</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:processors</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">processors</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:data</span>]
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:data</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:default_external_encoding</span>)
      <span class="ruby-identifier">mime_type</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">mime_types</span>(<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">extname</span>)
      <span class="ruby-identifier">encoding</span>  = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">encoding_for_mime_type</span>(<span class="ruby-identifier">mime_type</span>)
      <span class="ruby-identifier">result</span>    = <span class="ruby-constant">Sprockets</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">read_unicode</span>(<span class="ruby-identifier">pathname</span>, <span class="ruby-identifier">encoding</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">result</span> = <span class="ruby-constant">Sprockets</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">read_unicode</span>(<span class="ruby-identifier">pathname</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">processors</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">processor</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">template</span> = <span class="ruby-identifier">processor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>) { <span class="ruby-identifier">result</span> }
      <span class="ruby-identifier">result</span> = <span class="ruby-identifier">template</span>.<span class="ruby-identifier">render</span>(<span class="ruby-keyword">self</span>, {})
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
      <span class="ruby-identifier">annotate_exception!</span> <span class="ruby-identifier">e</span>
      <span class="ruby-identifier">raise</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-font_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">font_path</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Expand logical font asset path.</p>
          
          

          
          <div class="method-source-code" id="font_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 260</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">font_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:font</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-image_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">image_path</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Expand logical image asset path.</p>
          
          

          
          <div class="method-source-code" id="image_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">image_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:image</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-javascript_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">javascript_path</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Expand logical javascript asset path.</p>
          
          

          
          <div class="method-source-code" id="javascript_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 265</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">javascript_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:javascript</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-logical_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">logical_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns logical path without any file extensions.</p>

<pre class="ruby"><span class="ruby-string">&#39;app/javascripts/application.js&#39;</span>
<span class="ruby-comment"># =&gt; &#39;application&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="logical_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">logical_path</span>
  <span class="ruby-ivar">@logical_path</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-ivar">@logical_path</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-require_asset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">require_asset</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>`require_asset` declares `path` as a dependency of the file. The dependency
will be inserted before the file and will only be included once.</p>

<p>If ERB processing is enabled, you can use it to dynamically require assets.</p>

<pre>&lt;%= require_asset &quot;#{framework}.js&quot; %&gt;</pre>
          
          

          
          <div class="method-source-code" id="require_asset-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 145</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">require_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:content_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:self</span>)
  <span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-ivar">@_required_paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-resolve" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">resolve</span><span
            class="method-args">(path, options = {}, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Given a logical path, `resolve` will find and return the fully expanded
path. Relative paths will also be resolved. An optional `:content_type`
restriction can be supplied to restrict the search.</p>

<pre class="ruby"><span class="ruby-identifier">resolve</span>(<span class="ruby-string">&quot;foo.js&quot;</span>)
<span class="ruby-comment"># =&gt; &quot;/path/to/app/javascripts/foo.js&quot;</span>

<span class="ruby-identifier">resolve</span>(<span class="ruby-string">&quot;./bar.js&quot;</span>)
<span class="ruby-comment"># =&gt; &quot;/path/to/app/javascripts/bar.js&quot;</span>
</pre>
          
          

          
          <div class="method-source-code" id="resolve-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">pathname</span>   = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">absolute?</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">pathname</span>)
      <span class="ruby-identifier">pathname</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">FileNotFound</span>, <span class="ruby-node">&quot;couldn&#39;t find file &#39;#{pathname}&#39;&quot;</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">content_type</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:content_type</span>]
    <span class="ruby-identifier">content_type</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">content_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:self</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">format_extension</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">content_type</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">content_type</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">ContentTypeMismatch</span>, <span class="ruby-node">&quot;#{path} is &quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-node">&quot;&#39;#{attributes.content_type}&#39;, not &#39;#{content_type}&#39;&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">candidate</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">candidate</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">candidate</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">raise</span> <span class="ruby-constant">FileNotFound</span>, <span class="ruby-node">&quot;couldn&#39;t find file &#39;#{path}&#39;&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, {<span class="ruby-value">:base_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">dirname</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-root_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">root_path</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the environment path that contains the file.</p>

<p>If `app/javascripts` and `app/stylesheets` are in your path, and current
file is `app/javascripts/foo/bar.js`, `root_path` would return
`app/javascripts`.</p>
          
          

          
          <div class="method-source-code" id="root_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">root_path</span>
  <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">paths</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-identifier">path</span>] }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stub_asset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stub_asset</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>`stub_asset` blacklists `path` from being included in the bundle. `path`
must be an asset which may or may not already be included in the bundle.</p>
          
          

          
          <div class="method-source-code" id="stub_asset-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 155</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stub_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-ivar">@_stubbed_assets</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:content_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:self</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stylesheet_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stylesheet_path</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Expand logical stylesheet asset path.</p>
          
          

          
          <div class="method-source-code" id="stylesheet_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 270</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stylesheet_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:stylesheet</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-video_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">video_path</span><span
            class="method-args">(path)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Expand logical video asset path.</p>
          
          

          
          <div class="method-source-code" id="video_path-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 250</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">video_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:video</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-annotate_exception-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">annotate_exception!</span><span
            class="method-args">(exception)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Annotates exception backtrace with the original template that the exception
was raised in.</p>
          
          

          
          <div class="method-source-code" id="annotate_exception-21-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 277</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">annotate_exception!</span>(<span class="ruby-identifier">exception</span>)
  <span class="ruby-identifier">location</span> = <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">location</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;:#{@__LINE__}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@__LINE__</span>

  <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">Sprockets</span><span class="ruby-operator">::</span><span class="ruby-constant">EngineError</span>)
  <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">sprockets_annotation</span> = <span class="ruby-node">&quot;  (in #{location})&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-logger" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">logger</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="logger-source">
            <pre><span class="ruby-comment"># File lib/sprockets/context.rb, line 285</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">logger</span>
  <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">logger</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

