<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class ActiveRecord::ConnectionAdapters::TableDefinition - activerecord-4.2.1 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="TimestampDefaultDeprecation.html">ActiveRecord::ConnectionAdapters::TimestampDefaultDeprecation</a>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-5B-5D">#[]</a>
    
    <li ><a href="#method-i-aliased_types">#aliased_types</a>
    
    <li ><a href="#method-i-belongs_to">#belongs_to</a>
    
    <li ><a href="#method-i-column">#column</a>
    
    <li ><a href="#method-i-columns">#columns</a>
    
    <li ><a href="#method-i-create_column_definition">#create_column_definition</a>
    
    <li ><a href="#method-i-index">#index</a>
    
    <li ><a href="#method-i-native">#native</a>
    
    <li ><a href="#method-i-primary_key">#primary_key</a>
    
    <li ><a href="#method-i-references">#references</a>
    
    <li ><a href="#method-i-remove_column">#remove_column</a>
    
    <li ><a href="#method-i-timestamps">#timestamps</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-ActiveRecord::ConnectionAdapters::TableDefinition">
  <h1 id="class-ActiveRecord::ConnectionAdapters::TableDefinition" class="class">
    class ActiveRecord::ConnectionAdapters::TableDefinition
  </h1>

  <section class="description">
    
<p>Represents the schema of an SQL table in an abstract way. This class
provides methods for manipulating the schema representation.</p>

<p>Inside migration files, the <code>t</code> object in
<code>create_table</code> is actually of this type:</p>

<pre>class SomeMigration &lt; ActiveRecord::Migration
  def up
    create_table :foo do |t|
      puts t.class  # =&gt; &quot;ActiveRecord::ConnectionAdapters::TableDefinition&quot;
    end
  end

  def down
    ...
  end
end</pre>

<p>The table definitions The Columns are stored as a <a
href="ColumnDefinition.html">ColumnDefinition</a> in the
<code>columns</code> attribute.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-as" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">as</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-foreign_keys" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">foreign_keys</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-indexes" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">indexes</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>An array of <a href="ColumnDefinition.html">ColumnDefinition</a> objects,
representing the column changes that have been defined.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-name" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">name</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-options" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">options</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-temporary" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">temporary</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(types, name, temporary, options, as = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">types</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">temporary</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">as</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@columns_hash</span> = {}
  <span class="ruby-ivar">@indexes</span> = {}
  <span class="ruby-ivar">@foreign_keys</span> = {}
  <span class="ruby-ivar">@native</span> = <span class="ruby-identifier">types</span>
  <span class="ruby-ivar">@temporary</span> = <span class="ruby-identifier">temporary</span>
  <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
  <span class="ruby-ivar">@as</span> = <span class="ruby-identifier">as</span>
  <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a <a href="ColumnDefinition.html">ColumnDefinition</a> for the
column with name <code>name</code>.</p>
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 119</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-ivar">@columns_hash</span>[<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-belongs_to" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">belongs_to</span><span
            class="method-args">(*args)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="TableDefinition.html#method-i-references">references</a>
        </div>
        
      </div>

    
      <div id="method-i-column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column</span><span
            class="method-args">(name, type, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Instantiates a new column for the table. The <code>type</code> parameter is
normally one of the migrations native types, which is one of the following:
<code>:primary_key</code>, <code>:string</code>, <code>:text</code>,
<code>:integer</code>, <code>:float</code>, <code>:decimal</code>,
<code>:datetime</code>, <code>:time</code>, <code>:date</code>,
<code>:binary</code>, <code>:boolean</code>.</p>

<p>You may use a type not in this list as long as it is supported by your
database (for example, “polygon” in MySQL), but this will not be database
agnostic and should usually be avoided.</p>

<p>Available options are (none of these exists by default):</p>
<ul><li>
<p><code>:limit</code> - Requests a maximum column length. This is number of
characters for <code>:string</code> and <code>:text</code> columns and
number of bytes for <code>:binary</code> and <code>:integer</code> columns.</p>
</li><li>
<p><code>:default</code> - The column&#39;s default value. Use nil for NULL.</p>
</li><li>
<p><code>:null</code> - Allows or disallows <code>NULL</code> values in the
column. This option could have been named <code>:null_allowed</code>.</p>
</li><li>
<p><code>:precision</code> - Specifies the precision for a
<code>:decimal</code> column.</p>
</li><li>
<p><code>:scale</code> - Specifies the scale for a <code>:decimal</code>
column.</p>
</li><li>
<p><code>:index</code> - Create an index for the column. Can be either
<code>true</code> or an options hash.</p>
</li></ul>

<p>Note: The precision is the total number of significant digits and the scale
is the number of digits that can be stored following the decimal point. For
example, the number 123.45 has a precision of 5 and a scale of 2. A decimal
with a precision of 5 and a scale of 2 can range from -999.99 to 999.99.</p>

<p>Please be aware of different RDBMS implementations behavior with
<code>:decimal</code> columns:</p>
<ul><li>
<p>The SQL standard says the default scale should be 0, <code>:scale</code>
&lt;= <code>:precision</code>, and makes no comments about the requirements
of <code>:precision</code>.</p>
</li><li>
<p>MySQL: <code>:precision</code> [1..63], <code>:scale</code> [0..30].
Default is (10,0).</p>
</li><li>
<p>PostgreSQL: <code>:precision</code> [1..infinity], <code>:scale</code>
[0..infinity]. No default.</p>
</li><li>
<p>SQLite2: Any <code>:precision</code> and <code>:scale</code> may be used.
Internal storage as strings. No default.</p>
</li><li>
<p>SQLite3: No restrictions on <code>:precision</code> and
<code>:scale</code>, but the maximum supported <code>:precision</code> is
16. No default.</p>
</li><li>
<p>Oracle: <code>:precision</code> [1..38], <code>:scale</code> [-84..127].
Default is (38,0).</p>
</li><li>
<p>DB2: <code>:precision</code> [1..63], <code>:scale</code> [0..62]. Default
unknown.</p>
</li><li>
<p>SqlServer?: <code>:precision</code> [1..38], <code>:scale</code> [0..38].
Default (38,0).</p>
</li></ul>

<p>This method returns <code>self</code>.</p>

<h2 id="method-i-column-label-Examples">Examples<span><a href="#method-i-column-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-comment"># Assuming +td+ is an instance of TableDefinition</span>
<span class="ruby-identifier">td</span>.<span class="ruby-identifier">column</span>(:<span class="ruby-identifier">granted</span>, :<span class="ruby-identifier">boolean</span>)
<span class="ruby-comment"># granted BOOLEAN</span>

<span class="ruby-identifier">td</span>.<span class="ruby-identifier">column</span>(:<span class="ruby-identifier">picture</span>, :<span class="ruby-identifier">binary</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>.<span class="ruby-identifier">megabytes</span>)
<span class="ruby-comment"># =&gt; picture BLOB(2097152)</span>

<span class="ruby-identifier">td</span>.<span class="ruby-identifier">column</span>(:<span class="ruby-identifier">sales_stage</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">20</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;new&#39;</span>, <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
<span class="ruby-comment"># =&gt; sales_stage VARCHAR(20) DEFAULT &#39;new&#39; NOT NULL</span>

<span class="ruby-identifier">td</span>.<span class="ruby-identifier">column</span>(:<span class="ruby-identifier">bill_gates_money</span>, :<span class="ruby-identifier">decimal</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">15</span>, <span class="ruby-identifier">scale</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
<span class="ruby-comment"># =&gt; bill_gates_money DECIMAL(15,2)</span>

<span class="ruby-identifier">td</span>.<span class="ruby-identifier">column</span>(:<span class="ruby-identifier">sensor_reading</span>, :<span class="ruby-identifier">decimal</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>, <span class="ruby-identifier">scale</span><span class="ruby-operator">:</span> <span class="ruby-value">20</span>)
<span class="ruby-comment"># =&gt; sensor_reading DECIMAL(30,20)</span>

<span class="ruby-comment"># While &lt;tt&gt;:scale&lt;/tt&gt; defaults to zero on most databases, it</span>
<span class="ruby-comment"># probably wouldn&#39;t hurt to include it.</span>
<span class="ruby-identifier">td</span>.<span class="ruby-identifier">column</span>(:<span class="ruby-identifier">huge_integer</span>, :<span class="ruby-identifier">decimal</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>)
<span class="ruby-comment"># =&gt; huge_integer DECIMAL(30)</span>

<span class="ruby-comment"># Defines a column with a database-specific type.</span>
<span class="ruby-identifier">td</span>.<span class="ruby-identifier">column</span>(:<span class="ruby-identifier">foo</span>, <span class="ruby-string">&#39;polygon&#39;</span>)
<span class="ruby-comment"># =&gt; foo polygon</span>
</pre>

<h2 id="method-i-column-label-Short-hand+examples">Short-hand examples<span><a href="#method-i-column-label-Short-hand+examples">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Instead of calling <code>column</code> directly, you can also work with the
short-hand definitions for the default types. They use the type as the
method name instead of as a parameter and allow for multiple columns to be
defined in a single statement.</p>

<p>What can be written like this with the regular calls to column:</p>

<pre class="ruby"><span class="ruby-identifier">create_table</span> :<span class="ruby-identifier">products</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">shop_id</span>,     :<span class="ruby-identifier">integer</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">creator_id</span>,  :<span class="ruby-identifier">integer</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">item_number</span>, :<span class="ruby-identifier">string</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">name</span>,        :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Untitled&quot;</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">value</span>,       :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Untitled&quot;</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">created_at</span>,  :<span class="ruby-identifier">datetime</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">updated_at</span>,  :<span class="ruby-identifier">datetime</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">add_index</span> :<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">item_number</span>
</pre>

<p>can also be written as follows using the short-hand:</p>

<pre class="ruby"><span class="ruby-identifier">create_table</span> :<span class="ruby-identifier">products</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">integer</span> :<span class="ruby-identifier">shop_id</span>, :<span class="ruby-identifier">creator_id</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">string</span>  :<span class="ruby-identifier">item_number</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">string</span>  :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">value</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Untitled&quot;</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">timestamps</span> <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span>
</pre>

<p>There&#39;s a short-hand method for each of the type values declared at the
top. And then there&#39;s <a
href="TableDefinition.html#method-i-timestamps">#timestamps</a> that&#39;ll
add <code>created_at</code> and <code>updated_at</code> as datetimes.</p>

<p><a href="TableDefinition.html#method-i-references">#references</a> will add
an appropriately-named _id column, plus a corresponding _type column if the
<code>:polymorphic</code> option is supplied. If <code>:polymorphic</code>
is a hash of options, these will be used when creating the
<code>_type</code> column. The <code>:index</code> option will also create
an index, similar to calling <code>add_index</code>. So what can be written
like this:</p>

<pre class="ruby"><span class="ruby-identifier">create_table</span> :<span class="ruby-identifier">taggings</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">integer</span> :<span class="ruby-identifier">tag_id</span>, :<span class="ruby-identifier">tagger_id</span>, :<span class="ruby-identifier">taggable_id</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">string</span>  :<span class="ruby-identifier">tagger_type</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">string</span>  :<span class="ruby-identifier">taggable_type</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Photo&#39;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">add_index</span> :<span class="ruby-identifier">taggings</span>, :<span class="ruby-identifier">tag_id</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;index_taggings_on_tag_id&#39;</span>
<span class="ruby-identifier">add_index</span> :<span class="ruby-identifier">taggings</span>, [:<span class="ruby-identifier">tagger_id</span>, :<span class="ruby-identifier">tagger_type</span>]
</pre>

<p>Can also be written as follows using references:</p>

<pre class="ruby"><span class="ruby-identifier">create_table</span> :<span class="ruby-identifier">taggings</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">references</span> :<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;index_taggings_on_tag_id&#39;</span> }
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">references</span> :<span class="ruby-identifier">tagger</span>, <span class="ruby-identifier">polymorphic</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">references</span> :<span class="ruby-identifier">taggable</span>, <span class="ruby-identifier">polymorphic</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Photo&#39;</span> }
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="column-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 256</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">type</span> = <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_sym</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@columns_hash</span>[<span class="ruby-identifier">name</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@columns_hash</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">primary_key?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;you can&#39;t redefine the primary key column &#39;#{name}&#39;. To define a custom primary key, pass { id: false } to create_table.&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">index_options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:index</span>)
  <span class="ruby-identifier">index</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">index_options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">index_options</span> <span class="ruby-operator">:</span> {}) <span class="ruby-keyword">if</span> <span class="ruby-identifier">index_options</span>
  <span class="ruby-ivar">@columns_hash</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">new_column_definition</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-columns" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">columns</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="columns-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 110</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">columns</span>; <span class="ruby-ivar">@columns_hash</span>.<span class="ruby-identifier">values</span>; <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index</span><span
            class="method-args">(column_name, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds index options to the indexes hash, keyed by column name This is
primarily used to track indexes that need to be created after the table</p>

<pre class="ruby"><span class="ruby-identifier">index</span>(:<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;index_projects_on_account_id&#39;</span>)
</pre>
          
          

          
          <div class="method-source-code" id="index-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 286</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>(<span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">indexes</span>[<span class="ruby-identifier">column_name</span>] = <span class="ruby-identifier">options</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-primary_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">primary_key</span><span
            class="method-args">(name, type = :primary_key, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Appends a primary key definition to the table definition. Can be called
multiple times, but this is probably not a good idea.</p>
          
          

          
          <div class="method-source-code" id="primary_key-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 114</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">primary_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span> = <span class="ruby-value">:primary_key</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:primary_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-references" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">references</span><span
            class="method-args">(*args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a reference. Optionally adds a <code>type</code> column, if
<code>:polymorphic</code> option is provided.  <code>references</code> and
<code>belongs_to</code> are acceptable. The reference column will be an
<code>integer</code> by default, the <code>:type</code> option can be used
to specify a different type. A foreign key will be created if a
<code>foreign_key</code> option is passed.</p>

<pre class="ruby"><span class="ruby-identifier">t</span>.<span class="ruby-identifier">references</span>(:<span class="ruby-identifier">user</span>)
<span class="ruby-identifier">t</span>.<span class="ruby-identifier">references</span>(:<span class="ruby-identifier">user</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;string&quot;</span>)
<span class="ruby-identifier">t</span>.<span class="ruby-identifier">belongs_to</span>(:<span class="ruby-identifier">supplier</span>, <span class="ruby-identifier">polymorphic</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>

<p>See <a
href="SchemaStatements.html#method-i-add_reference">ActiveRecord::ConnectionAdapters::SchemaStatements#add_reference</a></p>
          
          

          
          <div class="method-source-code" id="references-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 317</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">references</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-identifier">polymorphic</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:polymorphic</span>)
  <span class="ruby-identifier">index_options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:index</span>)
  <span class="ruby-identifier">foreign_key_options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:foreign_key</span>)
  <span class="ruby-identifier">type</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:type</span>) <span class="ruby-operator">||</span> <span class="ruby-value">:integer</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">polymorphic</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">foreign_key_options</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;Cannot add a foreign key on a polymorphic relation&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">col</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">column</span>(<span class="ruby-node">&quot;#{col}_id&quot;</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span>)
    <span class="ruby-identifier">column</span>(<span class="ruby-node">&quot;#{col}_type&quot;</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">polymorphic</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">polymorphic</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">options</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">polymorphic</span>
    <span class="ruby-identifier">index</span>(<span class="ruby-identifier">polymorphic</span> <span class="ruby-operator">?</span> <span class="ruby-node">%w(type id)</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{col}_#{t}&quot;</span> } <span class="ruby-operator">:</span> <span class="ruby-node">&quot;#{col}_id&quot;</span>, <span class="ruby-identifier">index_options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">index_options</span> <span class="ruby-operator">:</span> {}) <span class="ruby-keyword">if</span> <span class="ruby-identifier">index_options</span>
    <span class="ruby-identifier">foreign_key</span>(<span class="ruby-identifier">col</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">pluralize</span>, <span class="ruby-identifier">foreign_key_options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">foreign_key_options</span> <span class="ruby-operator">:</span> {}) <span class="ruby-keyword">if</span> <span class="ruby-identifier">foreign_key_options</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="TableDefinition.html#method-i-belongs_to">belongs_to</a>
        </div>
        

        
      </div>

    
      <div id="method-i-remove_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_column</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="remove_column-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 270</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_column</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-ivar">@columns_hash</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-timestamps" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">timestamps</span><span
            class="method-args">(*args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Appends <code>:datetime</code> columns <code>:created_at</code> and
<code>:updated_at</code> to the table. See <a
href="SchemaStatements.html#method-i-add_timestamps">ActiveRecord::ConnectionAdapters::SchemaStatements#add_timestamps</a></p>

<pre class="ruby"><span class="ruby-identifier">t</span>.<span class="ruby-identifier">timestamps</span> <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
</pre>
          
          

          
          <div class="method-source-code" id="timestamps-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 298</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">timestamps</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-identifier">emit_warning_if_null_unspecified</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">column</span>(<span class="ruby-value">:created_at</span>, <span class="ruby-value">:datetime</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">column</span>(<span class="ruby-value">:updated_at</span>, <span class="ruby-value">:datetime</span>, <span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-aliased_types" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">aliased_types</span><span
            class="method-args">(name, fallback)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="aliased_types-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 364</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">aliased_types</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">fallback</span>)
  <span class="ruby-string">&#39;timestamp&#39;</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">?</span> <span class="ruby-value">:datetime</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">fallback</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-create_column_definition" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_column_definition</span><span
            class="method-args">(name, type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="create_column_definition-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 356</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_column_definition</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>)
  <span class="ruby-constant">ColumnDefinition</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-native" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">native</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="native-source">
            <pre><span class="ruby-comment"># File lib/active_record/connection_adapters/abstract/schema_definitions.rb, line 360</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">native</span>
  <span class="ruby-ivar">@native</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

