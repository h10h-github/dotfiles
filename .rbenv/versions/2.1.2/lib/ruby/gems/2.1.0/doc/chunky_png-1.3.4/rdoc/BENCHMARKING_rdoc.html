<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>BENCHMARKING - chunky_png</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-ChunkyPNG+benchmark+suite">ChunkyPNG benchmark suite</a>
    <li><a href="#label-Results">Results</a>
    <li><a href="#label-Why+is+this+relevant-3F">Why is this relevant?</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="./BENCHMARKING_rdoc.html">BENCHMARKING</a>
  
    <li><a href="./CHANGELOG_rdoc.html">CHANGELOG</a>
  
    <li><a href="./CONTRIBUTING_rdoc.html">CONTRIBUTING</a>
  
    <li><a href="./README_rdoc.html">README</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page BENCHMARKING.rdoc">

<h1 id="label-ChunkyPNG+benchmark+suite"><a href="ChunkyPNG.html">ChunkyPNG</a> benchmark suite<span><a href="#label-ChunkyPNG+benchmark+suite">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>I would like the performance of this library as good as possible, and I
will gladly accept changes to this library that improves performance.</p>

<p>The library comes with a basic benchmark suite is intended to test the
speed of PNG decoding and encoding against different ruby interpreters.
Execute them using rake. You can set the number of runs by passing the N
environment variable.</p>

<pre class="ruby"><span class="ruby-identifier">bundle</span> <span class="ruby-identifier">exec</span> <span class="ruby-identifier">rake</span> <span class="ruby-identifier">benchmark</span>:<span class="ruby-identifier">encoding</span>
<span class="ruby-identifier">bundle</span> <span class="ruby-identifier">exec</span> <span class="ruby-identifier">rake</span> <span class="ruby-identifier">benchmark</span>:<span class="ruby-identifier">decoding</span>

<span class="ruby-identifier">bundle</span> <span class="ruby-identifier">exec</span> <span class="ruby-identifier">rake</span> <span class="ruby-identifier">benchmark</span> <span class="ruby-constant">N</span>=<span class="ruby-value">10</span>      <span class="ruby-comment"># Run all of them with 10 iterations</span>
</pre>

<p>You can use rvm to run the benchmarks against different interpreters. Of
course, make sure that the chunky_png is installed for all your
interpreters.</p>

<pre>rvm 1.8.7,1.9.3,rbx bundle exec rake benchmark N=10</pre>

<h2 id="label-Results">Results<span><a href="#label-Results">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>What is a speed improvement on one interpreter doesn&#39;t necessarily mean
the performance will be better on other interpreters as well. Please make
sure to benchamrk different RUby interpreters. When it comes to different
Ruby interpreters, the priority is the performance on recent MRI versions.</p>

<p>Some very old benchmark result (using <code>N=50</code>) on my 2007 iMac
can be  found at <a
href="https://gist.github.com/wvanbergen/495323">gist.github.com/wvanbergen/495323</a>.</p>

<h2 id="label-Why+is+this+relevant-3F">Why is this relevant?<span><a href="#label-Why+is+this+relevant-3F">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p><a href="ChunkyPNG.html">ChunkyPNG</a> is a pure Ruby library to handle PNG
files. Decoding a PNG requires a lot of integer math and bitwise
operations, and moderate use of the unpack method to read binary data.
Encoding is a good test for +Array#pack+, and depending on the encoding
options, also requires a lot of calculations. Therefore, the library is a
good benchmark candidate for these methods and algorithms. It has been used
to improve the <code>Array#pack</code> and  <code>String#unpack</code>
methods in Rubinius.</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

