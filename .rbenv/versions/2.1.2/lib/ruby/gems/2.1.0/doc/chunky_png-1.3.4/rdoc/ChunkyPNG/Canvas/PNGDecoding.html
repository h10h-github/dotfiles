<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module ChunkyPNG::Canvas::PNGDecoding - chunky_png</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-decode_png_extract_1bit_value">#decode_png_extract_1bit_value</a>
    
    <li ><a href="#method-i-decode_png_extract_2bit_value">#decode_png_extract_2bit_value</a>
    
    <li ><a href="#method-i-decode_png_extract_4bit_value">#decode_png_extract_4bit_value</a>
    
    <li ><a href="#method-i-decode_png_image_pass">#decode_png_image_pass</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_grayscale_16bit">#decode_png_pixels_from_scanline_grayscale_16bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_grayscale_1bit">#decode_png_pixels_from_scanline_grayscale_1bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_grayscale_2bit">#decode_png_pixels_from_scanline_grayscale_2bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_grayscale_4bit">#decode_png_pixels_from_scanline_grayscale_4bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_grayscale_8bit">#decode_png_pixels_from_scanline_grayscale_8bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_grayscale_alpha_16bit">#decode_png_pixels_from_scanline_grayscale_alpha_16bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_grayscale_alpha_8bit">#decode_png_pixels_from_scanline_grayscale_alpha_8bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_indexed_1bit">#decode_png_pixels_from_scanline_indexed_1bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_indexed_2bit">#decode_png_pixels_from_scanline_indexed_2bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_indexed_4bit">#decode_png_pixels_from_scanline_indexed_4bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_indexed_8bit">#decode_png_pixels_from_scanline_indexed_8bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_method">#decode_png_pixels_from_scanline_method</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_truecolor_16bit">#decode_png_pixels_from_scanline_truecolor_16bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_truecolor_8bit">#decode_png_pixels_from_scanline_truecolor_8bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_truecolor_alpha_16bit">#decode_png_pixels_from_scanline_truecolor_alpha_16bit</a>
    
    <li ><a href="#method-i-decode_png_pixels_from_scanline_truecolor_alpha_8bit">#decode_png_pixels_from_scanline_truecolor_alpha_8bit</a>
    
    <li ><a href="#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>
    
    <li ><a href="#method-i-decode_png_resample_16bit_value">#decode_png_resample_16bit_value</a>
    
    <li ><a href="#method-i-decode_png_resample_1bit_value">#decode_png_resample_1bit_value</a>
    
    <li ><a href="#method-i-decode_png_resample_2bit_value">#decode_png_resample_2bit_value</a>
    
    <li ><a href="#method-i-decode_png_resample_4bit_value">#decode_png_resample_4bit_value</a>
    
    <li ><a href="#method-i-decode_png_resample_8bit_value">#decode_png_resample_8bit_value</a>
    
    <li ><a href="#method-i-decode_png_str_scanline">#decode_png_str_scanline</a>
    
    <li ><a href="#method-i-decode_png_str_scanline_average">#decode_png_str_scanline_average</a>
    
    <li ><a href="#method-i-decode_png_str_scanline_paeth">#decode_png_str_scanline_paeth</a>
    
    <li ><a href="#method-i-decode_png_str_scanline_sub">#decode_png_str_scanline_sub</a>
    
    <li ><a href="#method-i-decode_png_str_scanline_sub_none">#decode_png_str_scanline_sub_none</a>
    
    <li ><a href="#method-i-decode_png_str_scanline_up">#decode_png_str_scanline_up</a>
    
    <li ><a href="#method-i-decode_png_with_adam7_interlacing">#decode_png_with_adam7_interlacing</a>
    
    <li ><a href="#method-i-decode_png_without_interlacing">#decode_png_without_interlacing</a>
    
    <li ><a href="#method-i-from_blob">#from_blob</a>
    
    <li ><a href="#method-i-from_datastream">#from_datastream</a>
    
    <li ><a href="#method-i-from_file">#from_file</a>
    
    <li ><a href="#method-i-from_io">#from_io</a>
    
    <li ><a href="#method-i-from_stream">#from_stream</a>
    
    <li ><a href="#method-i-from_string">#from_string</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-ChunkyPNG::Canvas::PNGDecoding">
  <h1 id="module-ChunkyPNG::Canvas::PNGDecoding" class="module">
    module ChunkyPNG::Canvas::PNGDecoding
  </h1>

  <section class="description">
    
<p>The <a href="PNGDecoding.html">PNGDecoding</a> contains methods for
decoding PNG datastreams to create a  <a href="../Canvas.html">Canvas</a>
object. The datastream can be provided as filename, string or IO  stream.</p>

<p>Overview of the decoding process:</p>
<ul><li>
<p>The optional PLTE and tRNS chunk are decoded for the color palette of the
original image.</p>
</li><li>
<p>The contents of the IDAT chunks is combined, and uncompressed using Inflate
decompression to the image pixelstream.</p>
</li><li>
<p>Based on the color mode, width and height of the original image, which is
read from the PNG header (IHDR chunk), the amount of bytes per line is
determined.</p>
</li><li>
<p>For every line of pixels in the encoded image, the original byte values are
restored by unapplying the milter method for that line.</p>
</li><li>
<p>The read bytes are unfiltered given by the filter function specified by the
first byte of the line.</p>
</li><li>
<p>The unfiltered pixelstream are is into colored pixels, using the color
mode.</p>
</li><li>
<p>All lines combined to form the original image.</p>
</li></ul>

<p>For interlaced images, the original image was split into 7 subimages. These
images get decoded just like the process above (from step 3), and get 
combined to form the original images.</p>

<p>@see <a href="PNGEncoding.html">ChunkyPNG::Canvas::PNGEncoding</a> @see <a
href="http://www.w3.org/TR/PNG">www.w3.org/TR/PNG</a>/ The W3C PNG format
specification</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-decoding_palette" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">decoding_palette</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>The palette that is used to decode the image, loading from the PLTE and
tRNS chunk from the PNG stream. For RGB(A) images, no palette is required.
@return [ChunkyPNG::Palette]</p>
        
        </div>
      </div>
      
      <div id="attribute-i-transparent_color" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">transparent_color</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>The color to be replaced with fully transparent pixels.</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-decode_png_pixelstream" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixelstream</span><span
            class="method-args">(stream, width, height, color_mode, depth, interlace)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a canvas from a PNG encoded pixelstream, using a given width,
height,  color mode and interlacing mode. @param [String] stream The
pixelstream to read from. @param [Integer] width The width of the image.
@param [Integer] width The height of the image. @param [Integer] color_mode
The color mode of the encoded pixelstream. @param [Integer] depth The bit
depth of the pixel samples. @param [Integer] interlace The interlace method
of the encoded pixelstream. @return [ChunkyPNG::Canvas] The decoded <a
href="../Canvas.html">Canvas</a> instance.</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixelstream-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 100</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixelstream</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">interlace</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">ExpectationFailed</span>, <span class="ruby-string">&quot;This palette is not suitable for decoding!&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">decoding_palette</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">decoding_palette</span>.<span class="ruby-identifier">can_decode?</span>

  <span class="ruby-identifier">image</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">interlace</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">INTERLACING_NONE</span>;  <span class="ruby-identifier">decode_png_without_interlacing</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">INTERLACING_ADAM7</span>; <span class="ruby-identifier">decode_png_with_adam7_interlacing</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>)
    <span class="ruby-keyword">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">NotSupported</span>, <span class="ruby-node">&quot;Don&#39;t know how the handle interlacing method #{interlace}!&quot;</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-identifier">image</span>.<span class="ruby-identifier">pixels</span>.<span class="ruby-identifier">map!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">transparent_color</span> <span class="ruby-operator">?</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span><span class="ruby-operator">::</span><span class="ruby-constant">TRANSPARENT</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">c</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">transparent_color</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">image</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-from_blob" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">from_blob</span><span
            class="method-args">(str)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a <a href="../Canvas.html">Canvas</a> from a PNG encoded string.
@param [String] str The string to read from. @return [ChunkyPNG::Canvas]
The canvas decoded from the PNG encoded string.</p>
          
          

          
          <div class="method-source-code" id="from_blob-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 43</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">from_blob</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-identifier">from_datastream</span>(<span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Datastream</span>.<span class="ruby-identifier">from_blob</span>(<span class="ruby-identifier">str</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="PNGDecoding.html#method-i-from_string">from_string</a>
        </div>
        

        
      </div>

    
      <div id="method-i-from_datastream" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">from_datastream</span><span
            class="method-args">(ds)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes the <a href="../Canvas.html">Canvas</a> from a PNG datastream
instance. @param [ChunkyPNG::Datastream] ds The datastream to decode.
@return [ChunkyPNG::Canvas] The canvas decoded from the PNG datastream.</p>
          
          

          
          <div class="method-source-code" id="from_datastream-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">from_datastream</span>(<span class="ruby-identifier">ds</span>)
  <span class="ruby-identifier">width</span>      = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">header_chunk</span>.<span class="ruby-identifier">width</span>
  <span class="ruby-identifier">height</span>     = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">header_chunk</span>.<span class="ruby-identifier">height</span>
  <span class="ruby-identifier">color_mode</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">header_chunk</span>.<span class="ruby-identifier">color</span>
  <span class="ruby-identifier">interlace</span>  = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">header_chunk</span>.<span class="ruby-identifier">interlace</span>
  <span class="ruby-identifier">depth</span>      = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">header_chunk</span>.<span class="ruby-identifier">depth</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">width</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">height</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ExpectationFailed</span>, <span class="ruby-node">&quot;Invalid image size, width: #{width}, height: #{height}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">color_mode</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_INDEXED</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">decoding_palette</span> = <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Palette</span>.<span class="ruby-identifier">from_chunks</span>(<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">palette_chunk</span>, <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">transparency_chunk</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_TRUECOLOR</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">transparent_color</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">transparency_chunk</span>.<span class="ruby-identifier">truecolor_entry</span>(<span class="ruby-identifier">depth</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">transparency_chunk</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_GRAYSCALE</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">transparent_color</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">transparency_chunk</span>.<span class="ruby-identifier">grayscale_entry</span>(<span class="ruby-identifier">depth</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">transparency_chunk</span>
  <span class="ruby-keyword">end</span>
      
  <span class="ruby-identifier">decode_png_pixelstream</span>(<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">imagedata</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">interlace</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-from_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">from_file</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a <a href="../Canvas.html">Canvas</a> from a PNG encoded file.
@param [String] filename The file to read from. @return [ChunkyPNG::Canvas]
The canvas decoded from the PNG file.</p>
          
          

          
          <div class="method-source-code" id="from_file-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 52</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">from_file</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-identifier">from_datastream</span>(<span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Datastream</span>.<span class="ruby-identifier">from_file</span>(<span class="ruby-identifier">filename</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-from_io" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">from_io</span><span
            class="method-args">(io)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a <a href="../Canvas.html">Canvas</a> from a PNG encoded stream.
@param [IO, read] io The stream to read from. @return [ChunkyPNG::Canvas]
The canvas decoded from the PNG stream.</p>
          
          

          
          <div class="method-source-code" id="from_io-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">from_io</span>(<span class="ruby-identifier">io</span>)
  <span class="ruby-identifier">from_datastream</span>(<span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Datastream</span>.<span class="ruby-identifier">from_io</span>(<span class="ruby-identifier">io</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="PNGDecoding.html#method-i-from_stream">from_stream</a>
        </div>
        

        
      </div>

    
      <div id="method-i-from_stream" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">from_stream</span><span
            class="method-args">(io)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="PNGDecoding.html#method-i-from_io">from_io</a>
        </div>
        
      </div>

    
      <div id="method-i-from_string" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">from_string</span><span
            class="method-args">(str)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="PNGDecoding.html#method-i-from_blob">from_blob</a>
        </div>
        
      </div>

    
    </section>
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Protected Instance Methods</h3>
       </header>

    
      <div id="method-i-decode_png_extract_1bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_extract_1bit_value</span><span
            class="method-args">(byte, index)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Extract a bit from a byte on a given index. @param [Integer] byte The byte
(0..255) value to extract a bit from. @param [Integer] index The index
within the byte. This should be 0..7;</p>

<pre>the value will be modded by 8 to enforce this.</pre>

<p>@return [Integer] Either 1 or 0.</p>
          
          

          
          <div class="method-source-code" id="decode_png_extract_1bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_extract_1bit_value</span>(<span class="ruby-identifier">byte</span>, <span class="ruby-identifier">index</span>)
  <span class="ruby-identifier">bitshift</span> = <span class="ruby-value">7</span> <span class="ruby-operator">-</span> (<span class="ruby-identifier">index</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x07</span>)
  (<span class="ruby-identifier">byte</span> <span class="ruby-operator">&amp;</span> (<span class="ruby-value">0x01</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">bitshift</span>)) <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-identifier">bitshift</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_extract_2bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_extract_2bit_value</span><span
            class="method-args">(byte, index)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Extract 2 consecutive bits from a byte. @param [Integer] byte The byte
(0..255) value to extract a 2 bit value from. @param [Integer] index The
index within the byte. This should be either 0, 1, 2, or 3;</p>

<pre>the value will be modded by 4 to enforce this.</pre>

<p>@return [Integer] The extracted 2 bit value (0..3)</p>
          
          

          
          <div class="method-source-code" id="decode_png_extract_2bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_extract_2bit_value</span>(<span class="ruby-identifier">byte</span>, <span class="ruby-identifier">index</span>)
  <span class="ruby-identifier">bitshift</span> = <span class="ruby-value">6</span> <span class="ruby-operator">-</span> ((<span class="ruby-identifier">index</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x03</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">1</span>)
  (<span class="ruby-identifier">byte</span> <span class="ruby-operator">&amp;</span> (<span class="ruby-value">0x03</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">bitshift</span>)) <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-identifier">bitshift</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_extract_4bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_extract_4bit_value</span><span
            class="method-args">(byte, index)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Extract 4 consecutive bits from a byte. @param [Integer] byte The byte
(0..255) value to extract a 4 bit value from. @param [Integer] index The
index within the byte. This should be either 0 or 2;</p>

<pre>the value will be modded by 2 to enforce this.</pre>

<p>@return [Integer] The extracted 4bit value (0..15)</p>
          
          

          
          <div class="method-source-code" id="decode_png_extract_4bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 152</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_extract_4bit_value</span>(<span class="ruby-identifier">byte</span>, <span class="ruby-identifier">index</span>)
  (<span class="ruby-identifier">index</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x01</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> ((<span class="ruby-identifier">byte</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0xf0</span>) <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">4</span>) <span class="ruby-operator">:</span> (<span class="ruby-identifier">byte</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x0f</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_image_pass" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_image_pass</span><span
            class="method-args">(stream, width, height, color_mode, depth, start_pos)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a single PNG image pass width a given width, height and color 
mode, to a <a href="../Canvas.html">Canvas</a>, starting at the given
position in the stream.</p>

<p>A non-interlaced image only consists of one pass, while an Adam7 image
consists of 7 passes that must be combined after decoding.</p>

<p>@param stream (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param width (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param height (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param color_mode (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param [Integer] start_pos The position in the pixel stream to start
reading. @return (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_image_pass-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 382</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_image_pass</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">start_pos</span>)
  
  <span class="ruby-identifier">pixels</span> = []
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">width</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">height</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
    
    <span class="ruby-identifier">stream</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">EXTRA_BYTE</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">color_mode</span> <span class="ruby-operator">==</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_TRUECOLOR</span>
    <span class="ruby-identifier">pixel_decoder</span> = <span class="ruby-identifier">decode_png_pixels_from_scanline_method</span>(<span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>)
    <span class="ruby-identifier">line_length</span>   = <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">scanline_bytesize</span>(<span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">width</span>)
    <span class="ruby-identifier">pixel_size</span>    = <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">pixel_bytesize</span>(<span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>)
    
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">ExpectationFailed</span>, <span class="ruby-string">&quot;Invalid stream length!&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">bytesize</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">start_pos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">pass_bytesize</span>(<span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>)

    <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span> = <span class="ruby-identifier">start_pos</span>, <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">for</span> <span class="ruby-identifier">line_no</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">height</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">decode_png_str_scanline</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
      <span class="ruby-identifier">pixels</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">send</span>(<span class="ruby-identifier">pixel_decoder</span>, <span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)

      <span class="ruby-identifier">prev_pos</span> = <span class="ruby-identifier">pos</span>
      <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">line_length</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">new</span>(<span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">pixels</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_grayscale_16bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_grayscale_16bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 16-bit, grayscale image into a row of pixels.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_grayscale_16bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 346</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_grayscale_16bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-identifier">values</span> = <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-node">&quot;@#{pos + 1}n#{width}&quot;</span>)
  <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">grayscale</span>(<span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">value</span>)) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_grayscale_1bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_grayscale_1bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 1-bit, grayscale image into a row of pixels.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_grayscale_1bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 309</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_grayscale_1bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">decode_png_extract_1bit_value</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">3</span>)), <span class="ruby-identifier">index</span>)
    <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">?</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span><span class="ruby-operator">::</span><span class="ruby-constant">WHITE</span> <span class="ruby-operator">:</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span><span class="ruby-operator">::</span><span class="ruby-constant">BLACK</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_grayscale_2bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_grayscale_2bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 2-bit, grayscale image into a row of pixels.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_grayscale_2bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 319</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_grayscale_2bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">decode_png_extract_2bit_value</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">2</span>)), <span class="ruby-identifier">index</span>)
    <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">grayscale</span>(<span class="ruby-identifier">decode_png_resample_2bit_value</span>(<span class="ruby-identifier">value</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_grayscale_4bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_grayscale_4bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 4-bit, grayscale image into a row of pixels.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_grayscale_4bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 329</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_grayscale_4bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">decode_png_extract_4bit_value</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">1</span>)), <span class="ruby-identifier">index</span>)
    <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">grayscale</span>(<span class="ruby-identifier">decode_png_resample_4bit_value</span>(<span class="ruby-identifier">value</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_grayscale_8bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_grayscale_8bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of an 8-bit, grayscale image into a row of pixels.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_grayscale_8bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 339</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_grayscale_8bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">grayscale</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>)) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_grayscale_alpha_16bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_grayscale_alpha_16bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 16-bit, grayscale image with transparency into a
row of pixels. @params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_grayscale_alpha_16bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 298</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_grayscale_alpha_16bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-identifier">pixels</span> = []
  <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-node">&quot;@#{pos + 1}n#{width * 2}&quot;</span>).<span class="ruby-identifier">each_slice</span>(<span class="ruby-value">2</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">g</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">pixels</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">grayscale_alpha</span>(<span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">g</span>), <span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">a</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">pixels</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_grayscale_alpha_8bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_grayscale_alpha_8bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of an 8-bit, grayscale image with transparency into a
row of pixels. @params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_grayscale_alpha_8bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 291</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_grayscale_alpha_8bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">grayscale_alpha</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>), <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-value">2</span>)) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_indexed_1bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_indexed_1bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 1-bit, indexed image into a row of pixels. @param
[String] stream The stream to decode from. @param [Integer] pos The
position in the stream on which the scanline starts (including the filter
byte). @param [Integer] width The width in pixels of the scanline. @return
[Array&lt;Integer&gt;] An array of decoded pixels.</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_indexed_1bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 217</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_indexed_1bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">palette_pos</span> = <span class="ruby-identifier">decode_png_extract_1bit_value</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">3</span>)), <span class="ruby-identifier">index</span>) 
    <span class="ruby-identifier">decoding_palette</span>[<span class="ruby-identifier">palette_pos</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_indexed_2bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_indexed_2bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 2-bit, indexed image into a row of pixels. @params
(see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_indexed_2bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 227</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_indexed_2bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">palette_pos</span> = <span class="ruby-identifier">decode_png_extract_2bit_value</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">2</span>)), <span class="ruby-identifier">index</span>)
    <span class="ruby-identifier">decoding_palette</span>[<span class="ruby-identifier">palette_pos</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_indexed_4bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_indexed_4bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 4-bit, indexed image into a row of pixels. @params
(see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_indexed_4bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 237</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_indexed_4bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">palette_pos</span> = <span class="ruby-identifier">decode_png_extract_4bit_value</span>(<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">1</span>)), <span class="ruby-identifier">index</span>)
    <span class="ruby-identifier">decoding_palette</span>[<span class="ruby-identifier">palette_pos</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_indexed_8bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_indexed_8bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 8-bit, indexed image into a row of pixels. @params
(see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_indexed_8bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 247</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_indexed_8bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">width</span>).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">decoding_palette</span>[<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>)] }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_method" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_method</span><span
            class="method-args">(color_mode, depth)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the method name to use to decode scanlines into pixels. @param
[Integer] color_mode The color mode of the image. @param [Integer] depth
The bit depth of the image. @return [Symbol] The method name to use for
decoding, to be called on the canvas class. @raise
[ChunkyPNG::NotSupported] when the color_mode and/or bit depth is not
supported.</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_method-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 356</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_method</span>(<span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>)
  <span class="ruby-identifier">decoder_method</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">color_mode</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_TRUECOLOR</span>;       <span class="ruby-value">:&quot;decode_png_pixels_from_scanline_truecolor_#{depth}bit&quot;</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_TRUECOLOR_ALPHA</span>; <span class="ruby-value">:&quot;decode_png_pixels_from_scanline_truecolor_alpha_#{depth}bit&quot;</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_INDEXED</span>;         <span class="ruby-value">:&quot;decode_png_pixels_from_scanline_indexed_#{depth}bit&quot;</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_GRAYSCALE</span>;       <span class="ruby-value">:&quot;decode_png_pixels_from_scanline_grayscale_#{depth}bit&quot;</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">COLOR_GRAYSCALE_ALPHA</span>; <span class="ruby-value">:&quot;decode_png_pixels_from_scanline_grayscale_alpha_#{depth}bit&quot;</span>
    <span class="ruby-keyword">else</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">NotSupported</span>, <span class="ruby-node">&quot;No decoder found for color mode #{color_mode} and #{depth}-bit depth!&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">decoder_method</span>, <span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">decoder_method</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_truecolor_16bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_truecolor_16bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 16-bit, true color image into a row of pixels.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_truecolor_16bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 280</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_truecolor_16bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-identifier">pixels</span> = []
  <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-node">&quot;@#{pos + 1}n#{width * 3}&quot;</span>).<span class="ruby-identifier">each_slice</span>(<span class="ruby-value">3</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span>, <span class="ruby-identifier">g</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">pixels</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">rgb</span>(<span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">r</span>), <span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">g</span>), <span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">b</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">pixels</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_truecolor_8bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_truecolor_8bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of an 8-bit, true color image into a row of pixels.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_truecolor_8bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 273</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_truecolor_8bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-node">&quot;@#{pos + 1}&quot;</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-string">&#39;NX&#39;</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">width</span>)).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">|</span> <span class="ruby-value">0x000000ff</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_truecolor_alpha_16bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_truecolor_alpha_16bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of a 16-bit, true color image with transparency into a
row of pixels. @params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_truecolor_alpha_16bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 261</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_truecolor_alpha_16bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-identifier">pixels</span> = []
  <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-node">&quot;@#{pos + 1}n#{width * 4}&quot;</span>).<span class="ruby-identifier">each_slice</span>(<span class="ruby-value">4</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span>, <span class="ruby-identifier">g</span>, <span class="ruby-identifier">b</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">pixels</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">rgba</span>(<span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">r</span>), <span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">g</span>),
                                    <span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">b</span>), <span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">a</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">pixels</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_pixels_from_scanline_truecolor_alpha_8bit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_pixels_from_scanline_truecolor_alpha_8bit</span><span
            class="method-args">(stream, pos, width)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline of an 8-bit, true color image with transparency into a
row of pixels. @params (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixels_from_scanline_indexed_1bit">decode_png_pixels_from_scanline_indexed_1bit</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_pixels_from_scanline_truecolor_alpha_8bit-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_pixels_from_scanline_truecolor_alpha_8bit</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">width</span>)
  <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-node">&quot;@#{pos + 1}N#{width}&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_resample_16bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_resample_16bit_value</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Resamples a 16 bit value to an 8 bit value. This will discard some color
information. @param [Integer] value The 16 bit value to resample. @return
[Integer] The 8 bit resampled value</p>
          
          

          
          <div class="method-source-code" id="decode_png_resample_16bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_resample_16bit_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">value</span> <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">8</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_resample_1bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_resample_1bit_value</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Resamples a 1 bit value to an 8 bit value. @param [Integer] value The 1 bit
value to resample. @return [Integer] The 8 bit resampled value</p>
          
          

          
          <div class="method-source-code" id="decode_png_resample_1bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 207</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_resample_1bit_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-value">0x01</span> <span class="ruby-operator">?</span> <span class="ruby-value">0xff</span> <span class="ruby-operator">:</span> <span class="ruby-value">0x00</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_resample_2bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_resample_2bit_value</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Resamples a 2 bit value to an 8 bit value. @param [Integer] value The 2 bit
value to resample. @return [Integer] The 8 bit resampled value.</p>
          
          

          
          <div class="method-source-code" id="decode_png_resample_2bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 200</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_resample_2bit_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">value</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">6</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">4</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">2</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_resample_4bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_resample_4bit_value</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Resamples a 4 bit value to an 8 bit value. @param [Integer] value The 4 bit
value to resample. @return [Integer] The 8 bit resampled value.</p>
          
          

          
          <div class="method-source-code" id="decode_png_resample_4bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 193</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_resample_4bit_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">value</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">4</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_resample_8bit_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_resample_8bit_value</span><span
            class="method-args">(value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>No-op - available for completeness sake only @param [Integer] value The 8
bit value to resample. @return [Integer] The 8 bit resampled value</p>
          
          

          
          <div class="method-source-code" id="decode_png_resample_8bit_value-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 186</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_resample_8bit_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_str_scanline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_str_scanline</span><span
            class="method-args">(stream, pos, prev_pos, line_length, pixel_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline if it was encoded using filtering.</p>

<p>It will extract the filtering method from the first byte of the scanline,
and uses the  method to change the subsequent bytes to unfiltered values.
This will modify the pixelstream.</p>

<p>The bytes of the scanline can then be used to construct pixels, based on
the color mode..</p>

<p>@param [String] stream The pixelstream to undo the filtering in. @param
[Integer] pos The starting position of the scanline to decode. @param
[Integer, nil] prev_pos The starting position of the previously decoded
scanline, or <code>nil</code></p>

<pre>if this is the first scanline of the image.</pre>

<p>@param [Integer] line_length The number of bytes in the scanline,
discounting the filter method byte. @param [Integer] pixel_size The number
of bytes used per pixel, based on the color mode. @return [void]</p>
          
          

          
          <div class="method-source-code" id="decode_png_str_scanline-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 421</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_str_scanline</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">FILTER_NONE</span>;    <span class="ruby-comment"># noop</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">FILTER_SUB</span>;     <span class="ruby-identifier">decode_png_str_scanline_sub</span>(     <span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">FILTER_UP</span>;      <span class="ruby-identifier">decode_png_str_scanline_up</span>(      <span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">FILTER_AVERAGE</span>; <span class="ruby-identifier">decode_png_str_scanline_average</span>( <span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">FILTER_PAETH</span>;   <span class="ruby-identifier">decode_png_str_scanline_paeth</span>(   <span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
    <span class="ruby-keyword">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">NotSupported</span>, <span class="ruby-node">&quot;Unknown filter type: #{stream.getbyte(pos)}!&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_str_scanline_average" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_str_scanline_average</span><span
            class="method-args">(stream, pos, prev_pos, line_length, pixel_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline in a pixelstream that was encoded using AVERAGE
filtering. This will change the pixelstream to have unfiltered values.
@params (see <a
href="PNGDecoding.html#method-i-decode_png_str_scanline">decode_png_str_scanline</a>)
@return [void]</p>
          
          

          
          <div class="method-source-code" id="decode_png_str_scanline_average-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 464</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_str_scanline_average</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">line_length</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">a</span> = (<span class="ruby-identifier">i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pixel_size</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pixel_size</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">b</span> = <span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">setbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>, (<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>) <span class="ruby-operator">+</span> ((<span class="ruby-identifier">a</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">b</span>) <span class="ruby-operator">&gt;&gt;</span> <span class="ruby-value">1</span>)) <span class="ruby-operator">&amp;</span> <span class="ruby-value">0xff</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_str_scanline_paeth" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_str_scanline_paeth</span><span
            class="method-args">(stream, pos, prev_pos, line_length, pixel_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline in a pixelstream that was encoded using PAETH filtering.
This will change the pixelstream to have unfiltered values. @params (see <a
href="PNGDecoding.html#method-i-decode_png_str_scanline">decode_png_str_scanline</a>)
@return [void]</p>
          
          

          
          <div class="method-source-code" id="decode_png_str_scanline_paeth-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 476</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_str_scanline_paeth</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">line_length</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">cur_pos</span> = <span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>
    <span class="ruby-identifier">a</span> = (<span class="ruby-identifier">i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pixel_size</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">cur_pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pixel_size</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">b</span> = <span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">c</span> = (<span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pixel_size</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pixel_size</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">p</span> = <span class="ruby-identifier">a</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">b</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">c</span>
    <span class="ruby-identifier">pa</span> = (<span class="ruby-identifier">p</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">a</span>).<span class="ruby-identifier">abs</span>
    <span class="ruby-identifier">pb</span> = (<span class="ruby-identifier">p</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">b</span>).<span class="ruby-identifier">abs</span>
    <span class="ruby-identifier">pc</span> = (<span class="ruby-identifier">p</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">c</span>).<span class="ruby-identifier">abs</span>
    <span class="ruby-identifier">pr</span> = (<span class="ruby-identifier">pa</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">pb</span>) <span class="ruby-operator">?</span> (<span class="ruby-identifier">pa</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">pc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">a</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">c</span>) <span class="ruby-operator">:</span> (<span class="ruby-identifier">pb</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">pc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">b</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">c</span>)
    <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">setbyte</span>(<span class="ruby-identifier">cur_pos</span>, (<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">cur_pos</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">pr</span>) <span class="ruby-operator">&amp;</span> <span class="ruby-value">0xff</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_str_scanline_sub" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_str_scanline_sub</span><span
            class="method-args">(stream, pos, prev_pos, line_length, pixel_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline in a pixelstream that was encoded using SUB filtering.
This will change the pixelstream to have unfiltered values. @params (see <a
href="PNGDecoding.html#method-i-decode_png_str_scanline">decode_png_str_scanline</a>)
@return [void]</p>
          
          

          
          <div class="method-source-code" id="decode_png_str_scanline_sub-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 443</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_str_scanline_sub</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">line_length</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">setbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>, (<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>) <span class="ruby-operator">+</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pixel_size</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pixel_size</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)) <span class="ruby-operator">&amp;</span> <span class="ruby-value">0xff</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_str_scanline_sub_none" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_str_scanline_sub_none</span><span
            class="method-args">(stream, pos, prev_pos, line_length, pixel_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline that wasn&#39;t encoded using filtering. This is a
no-op. @params (see <a
href="PNGDecoding.html#method-i-decode_png_str_scanline">decode_png_str_scanline</a>)
@return [void]</p>
          
          

          
          <div class="method-source-code" id="decode_png_str_scanline_sub_none-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 435</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_str_scanline_sub_none</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
  <span class="ruby-comment"># noop - this method shouldn&#39;t get called.</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_str_scanline_up" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_str_scanline_up</span><span
            class="method-args">(stream, pos, prev_pos, line_length, pixel_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a scanline in a pixelstream that was encoded using UP filtering.
This will change the pixelstream to have unfiltered values. @params (see <a
href="PNGDecoding.html#method-i-decode_png_str_scanline">decode_png_str_scanline</a>)
@return [void]</p>
          
          

          
          <div class="method-source-code" id="decode_png_str_scanline_up-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 453</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_str_scanline_up</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">prev_pos</span>, <span class="ruby-identifier">line_length</span>, <span class="ruby-identifier">pixel_size</span>)
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">line_length</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">up</span> = <span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">prev_pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">setbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>, (<span class="ruby-identifier">stream</span>.<span class="ruby-identifier">getbyte</span>(<span class="ruby-identifier">pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">up</span>) <span class="ruby-operator">&amp;</span> <span class="ruby-value">0xff</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_with_adam7_interlacing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_with_adam7_interlacing</span><span
            class="method-args">(stream, width, height, color_mode, depth)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a canvas from a Adam 7 interlaced PNG encoded pixelstream, using a 
given width, height and color mode. @param stream (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param width (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param height (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param color_mode (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param depth (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_with_adam7_interlacing-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_with_adam7_interlacing</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>)
  <span class="ruby-identifier">canvas</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>)
  <span class="ruby-identifier">start_pos</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">pass</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-value">7</span>
    <span class="ruby-identifier">sm_width</span>, <span class="ruby-identifier">sm_height</span> = <span class="ruby-identifier">adam7_pass_size</span>(<span class="ruby-identifier">pass</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>)
    <span class="ruby-identifier">sm</span> = <span class="ruby-identifier">decode_png_image_pass</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">sm_width</span>, <span class="ruby-identifier">sm_height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">start_pos</span>)
    <span class="ruby-identifier">adam7_merge_pass</span>(<span class="ruby-identifier">pass</span>, <span class="ruby-identifier">canvas</span>, <span class="ruby-identifier">sm</span>)
    <span class="ruby-identifier">start_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">ChunkyPNG</span><span class="ruby-operator">::</span><span class="ruby-constant">Color</span>.<span class="ruby-identifier">pass_bytesize</span>(<span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">sm_width</span>, <span class="ruby-identifier">sm_height</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">canvas</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-decode_png_without_interlacing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decode_png_without_interlacing</span><span
            class="method-args">(stream, width, height, color_mode, depth)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decodes a canvas from a non-interlaced PNG encoded pixelstream, using a 
given width, height and color mode. @param stream (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param width (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param height (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param color_mode (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@param depth (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)
@return (see <a
href="PNGDecoding.html#method-i-decode_png_pixelstream">#decode_png_pixelstream</a>)</p>
          
          

          
          <div class="method-source-code" id="decode_png_without_interlacing-source">
            <pre><span class="ruby-comment"># File lib/chunky_png/canvas/png_decoding.rb, line 123</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_png_without_interlacing</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>)
  <span class="ruby-identifier">decode_png_image_pass</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>, <span class="ruby-identifier">color_mode</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-value">0</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

