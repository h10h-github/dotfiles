<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>active_support_core_extensions - rails-4.2.1 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-Active+Support+Core+Extensions">Active Support Core Extensions</a>
    <li><a href="#label-How+to+Load+Core+Extensions">How to Load Core Extensions</a>
    <li><a href="#label-Stand-Alone+Active+Support">Stand-Alone Active Support</a>
    <li><a href="#label-Cherry-picking+a+Definition">Cherry-picking a Definition</a>
    <li><a href="#label-Loading+Grouped+Core+Extensions">Loading Grouped Core Extensions</a>
    <li><a href="#label-Loading+All+Core+Extensions">Loading All Core Extensions</a>
    <li><a href="#label-Loading+All+Active+Support">Loading All Active Support</a>
    <li><a href="#label-Active+Support+Within+a+Ruby+on+Rails+Application">Active Support Within a Ruby on Rails Application</a>
    <li><a href="#label-Extensions+to+All+Objects">Extensions to All Objects</a>
    <li><a href="#label-blank-3F+and+present-3F"><code>blank?</code> and <code>present?</code></a>
    <li><a href="#label-presence"><code>presence</code></a>
    <li><a href="#label-duplicable-3F"><code>duplicable?</code></a>
    <li><a href="#label-deep_dup"><code>deep_dup</code></a>
    <li><a href="#label-try"><code>try</code></a>
    <li><a href="#label-class_eval-28-2Aargs-2C+-26block-29"><code>class_eval(*args, &amp;block)</code></a>
    <li><a href="#label-acts_like-3F-28duck-29"><code>acts_like?(duck)</code></a>
    <li><a href="#label-to_param"><code>to_param</code></a>
    <li><a href="#label-to_query"><code>to_query</code></a>
    <li><a href="#label-with_options"><code>with_options</code></a>
    <li><a href="#label-JSON+support">JSON support</a>
    <li><a href="#label-Instance+Variables">Instance Variables</a>
    <li><a href="#label-instance_values"><code>instance_values</code></a>
    <li><a href="#label-instance_variable_names"><code>instance_variable_names</code></a>
    <li><a href="#label-Silencing+Warnings-2C+Streams-2C+and+Exceptions">Silencing Warnings, Streams, and Exceptions</a>
    <li><a href="#label-in-3F"><code>in?</code></a>
    <li><a href="#label-Extensions+to+Module">Extensions to <code>Module</code></a>
    <li><a href="#label-alias_method_chain"><code>alias_method_chain</code></a>
    <li><a href="#label-Attributes">Attributes</a>
    <li><a href="#label-alias_attribute"><code>alias_attribute</code></a>
    <li><a href="#label-Internal+Attributes">Internal Attributes</a>
    <li><a href="#label-Module+Attributes">Module Attributes</a>
    <li><a href="#label-Parents">Parents</a>
    <li><a href="#label-parent"><code>parent</code></a>
    <li><a href="#label-parent_name"><code>parent_name</code></a>
    <li><a href="#label-parents"><code>parents</code></a>
    <li><a href="#label-Constants">Constants</a>
    <li><a href="#label-Qualified+Constant+Names">Qualified Constant Names</a>
    <li><a href="#label-Reachable">Reachable</a>
    <li><a href="#label-Anonymous">Anonymous</a>
    <li><a href="#label-Method+Delegation">Method Delegation</a>
    <li><a href="#label-Redefining+Methods">Redefining Methods</a>
    <li><a href="#label-Extensions+to+Class">Extensions to <code>Class</code></a>
    <li><a href="#label-Class+Attributes">Class Attributes</a>
    <li><a href="#label-class_attribute"><code>class_attribute</code></a>
    <li><a href="#label-cattr_reader-2C+cattr_writer-2C+and+cattr_accessor"><code>cattr_reader</code>, <code>cattr_writer</code>, and <code>cattr_accessor</code></a>
    <li><a href="#label-Subclasses+-26+Descendants">Subclasses &amp; Descendants</a>
    <li><a href="#label-subclasses"><code>subclasses</code></a>
    <li><a href="#label-descendants"><code>descendants</code></a>
    <li><a href="#label-Extensions+to+String">Extensions to <code>String</code></a>
    <li><a href="#label-Output+Safety">Output Safety</a>
    <li><a href="#label-Motivation">Motivation</a>
    <li><a href="#label-Safe+Strings">Safe Strings</a>
    <li><a href="#label-Transformation">Transformation</a>
    <li><a href="#label-Conversion+and+Coercion">Conversion and Coercion</a>
    <li><a href="#label-Copying">Copying</a>
    <li><a href="#label-remove"><code>remove</code></a>
    <li><a href="#label-squish"><code>squish</code></a>
    <li><a href="#label-truncate"><code>truncate</code></a>
    <li><a href="#label-truncate_words"><code>truncate_words</code></a>
    <li><a href="#label-inquiry"><code>inquiry</code></a>
    <li><a href="#label-starts_with-3F+and+ends_with-3F"><code>starts_with?</code> and <code>ends_with?</code></a>
    <li><a href="#label-strip_heredoc"><code>strip_heredoc</code></a>
    <li><a href="#label-indent"><code>indent</code></a>
    <li><a href="#label-Access">Access</a>
    <li><a href="#label-at-28position-29"><code>at(position)</code></a>
    <li><a href="#label-from-28position-29"><code>from(position)</code></a>
    <li><a href="#label-to-28position-29"><code>to(position)</code></a>
    <li><a href="#label-first-28limit+-3D+1-29"><code>first(limit = 1)</code></a>
    <li><a href="#label-last-28limit+-3D+1-29"><code>last(limit = 1)</code></a>
    <li><a href="#label-Inflections">Inflections</a>
    <li><a href="#label-pluralize"><code>pluralize</code></a>
    <li><a href="#label-singularize"><code>singularize</code></a>
    <li><a href="#label-camelize"><code>camelize</code></a>
    <li><a href="#label-underscore"><code>underscore</code></a>
    <li><a href="#label-titleize"><code>titleize</code></a>
    <li><a href="#label-dasherize"><code>dasherize</code></a>
    <li><a href="#label-demodulize"><code>demodulize</code></a>
    <li><a href="#label-deconstantize"><code>deconstantize</code></a>
    <li><a href="#label-parameterize"><code>parameterize</code></a>
    <li><a href="#label-tableize"><code>tableize</code></a>
    <li><a href="#label-classify"><code>classify</code></a>
    <li><a href="#label-constantize"><code>constantize</code></a>
    <li><a href="#label-humanize"><code>humanize</code></a>
    <li><a href="#label-foreign_key"><code>foreign_key</code></a>
    <li><a href="#label-Conversions">Conversions</a>
    <li><a href="#label-to_date-2C+to_time-2C+to_datetime"><code>to_date</code>, <code>to_time</code>, <code>to_datetime</code></a>
    <li><a href="#label-Extensions+to+Numeric">Extensions to <code>Numeric</code></a>
    <li><a href="#label-Bytes">Bytes</a>
    <li><a href="#label-Time">Time</a>
    <li><a href="#label-Formatting">Formatting</a>
    <li><a href="#label-Extensions+to+Integer">Extensions to <code>Integer</code></a>
    <li><a href="#label-multiple_of-3F"><code>multiple_of?</code></a>
    <li><a href="#label-ordinal"><code>ordinal</code></a>
    <li><a href="#label-ordinalize"><code>ordinalize</code></a>
    <li><a href="#label-Extensions+to+BigDecimal">Extensions to <code>BigDecimal</code></a>
    <li><a href="#label-to_s"><code>to_s</code></a>
    <li><a href="#label-to_formatted_s"><code>to_formatted_s</code></a>
    <li><a href="#label-Extensions+to+Enumerable">Extensions to <code>Enumerable</code></a>
    <li><a href="#label-sum"><code>sum</code></a>
    <li><a href="#label-index_by"><code>index_by</code></a>
    <li><a href="#label-many-3F"><code>many?</code></a>
    <li><a href="#label-exclude-3F"><code>exclude?</code></a>
    <li><a href="#label-Extensions+to+Array">Extensions to <code>Array</code></a>
    <li><a href="#label-Accessing">Accessing</a>
    <li><a href="#label-Adding+Elements">Adding Elements</a>
    <li><a href="#label-prepend"><code>prepend</code></a>
    <li><a href="#label-append"><code>append</code></a>
    <li><a href="#label-Options+Extraction">Options Extraction</a>
    <li><a href="#label-Conversions">Conversions</a>
    <li><a href="#label-to_sentence"><code>to_sentence</code></a>
    <li><a href="#label-to_formatted_s"><code>to_formatted_s</code></a>
    <li><a href="#label-to_xml"><code>to_xml</code></a>
    <li><a href="#label-Wrapping">Wrapping</a>
    <li><a href="#label-Duplicating">Duplicating</a>
    <li><a href="#label-Grouping">Grouping</a>
    <li><a href="#label-in_groups_of-28number-2C+fill_with+-3D+nil-29"><code>in_groups_of(number, fill_with = nil)</code></a>
    <li><a href="#label-in_groups-28number-2C+fill_with+-3D+nil-29"><code>in_groups(number, fill_with = nil)</code></a>
    <li><a href="#label-split-28value+-3D+nil-29"><code>split(value = nil)</code></a>
    <li><a href="#label-Extensions+to+Hash">Extensions to <code>Hash</code></a>
    <li><a href="#label-Conversions">Conversions</a>
    <li><a href="#label-to_xml"><code>to_xml</code></a>
    <li><a href="#label-Merging">Merging</a>
    <li><a href="#label-reverse_merge+and+reverse_merge-21"><code>reverse_merge</code> and <code>reverse_merge!</code></a>
    <li><a href="#label-reverse_update"><code>reverse_update</code></a>
    <li><a href="#label-deep_merge+and+deep_merge-21"><code>deep_merge</code> and <code>deep_merge!</code></a>
    <li><a href="#label-Deep+duplicating">Deep duplicating</a>
    <li><a href="#label-Working+with+Keys">Working with Keys</a>
    <li><a href="#label-except+and+except-21"><code>except</code> and <code>except!</code></a>
    <li><a href="#label-transform_keys+and+transform_keys-21"><code>transform_keys</code> and <code>transform_keys!</code></a>
    <li><a href="#label-stringify_keys+and+stringify_keys-21"><code>stringify_keys</code> and <code>stringify_keys!</code></a>
    <li><a href="#label-symbolize_keys+and+symbolize_keys-21"><code>symbolize_keys</code> and <code>symbolize_keys!</code></a>
    <li><a href="#label-to_options+and+to_options-21"><code>to_options</code> and <code>to_options!</code></a>
    <li><a href="#label-assert_valid_keys"><code>assert_valid_keys</code></a>
    <li><a href="#label-Working+with+Values">Working with Values</a>
    <li><a href="#label-transform_values+-26-26+transform_values-21"><code>transform_values</code> &amp;&amp; <code>transform_values!</code></a>
    <li><a href="#label-Slicing">Slicing</a>
    <li><a href="#label-Extracting">Extracting</a>
    <li><a href="#label-Indifferent+Access">Indifferent Access</a>
    <li><a href="#label-Compacting">Compacting</a>
    <li><a href="#label-Extensions+to+Regexp">Extensions to <code>Regexp</code></a>
    <li><a href="#label-multiline-3F"><code>multiline?</code></a>
    <li><a href="#label-Extensions+to+Range">Extensions to <code>Range</code></a>
    <li><a href="#label-to_s"><code>to_s</code></a>
    <li><a href="#label-include-3F"><code>include?</code></a>
    <li><a href="#label-overlaps-3F"><code>overlaps?</code></a>
    <li><a href="#label-Extensions+to+Proc">Extensions to <code>Proc</code></a>
    <li><a href="#label-bind"><code>bind</code></a>
    <li><a href="#label-Extensions+to+Date">Extensions to <code>Date</code></a>
    <li><a href="#label-Calculations">Calculations</a>
    <li><a href="#label-Date.current"><code>Date.current</code></a>
    <li><a href="#label-Named+dates">Named dates</a>
    <li><a href="#label-prev_year-2C+next_year"><code>prev_year</code>, <code>next_year</code></a>
    <li><a href="#label-prev_month-2C+next_month"><code>prev_month</code>, <code>next_month</code></a>
    <li><a href="#label-prev_quarter-2C+next_quarter"><code>prev_quarter</code>, <code>next_quarter</code></a>
    <li><a href="#label-beginning_of_week-2C+end_of_week"><code>beginning_of_week</code>, <code>end_of_week</code></a>
    <li><a href="#label-monday-2C+sunday"><code>monday</code>, <code>sunday</code></a>
    <li><a href="#label-prev_week-2C+next_week"><code>prev_week</code>, <code>next_week</code></a>
    <li><a href="#label-beginning_of_month-2C+end_of_month"><code>beginning_of_month</code>, <code>end_of_month</code></a>
    <li><a href="#label-beginning_of_quarter-2C+end_of_quarter"><code>beginning_of_quarter</code>, <code>end_of_quarter</code></a>
    <li><a href="#label-beginning_of_year-2C+end_of_year"><code>beginning_of_year</code>, <code>end_of_year</code></a>
    <li><a href="#label-Other+Date+Computations">Other Date Computations</a>
    <li><a href="#label-years_ago-2C+years_since"><code>years_ago</code>, <code>years_since</code></a>
    <li><a href="#label-months_ago-2C+months_since"><code>months_ago</code>, <code>months_since</code></a>
    <li><a href="#label-weeks_ago"><code>weeks_ago</code></a>
    <li><a href="#label-advance"><code>advance</code></a>
    <li><a href="#label-Changing+Components">Changing Components</a>
    <li><a href="#label-Durations">Durations</a>
    <li><a href="#label-Timestamps">Timestamps</a>
    <li><a href="#label-beginning_of_day-2C+end_of_day"><code>beginning_of_day</code>, <code>end_of_day</code></a>
    <li><a href="#label-beginning_of_hour-2C+end_of_hour"><code>beginning_of_hour</code>, <code>end_of_hour</code></a>
    <li><a href="#label-beginning_of_minute-2C+end_of_minute"><code>beginning_of_minute</code>, <code>end_of_minute</code></a>
    <li><a href="#label-ago-2C+since"><code>ago</code>, <code>since</code></a>
    <li><a href="#label-Other+Time+Computations">Other Time Computations</a>
    <li><a href="#label-Conversions">Conversions</a>
    <li><a href="#label-Extensions+to+DateTime">Extensions to <code>DateTime</code></a>
    <li><a href="#label-Calculations">Calculations</a>
    <li><a href="#label-Named+Datetimes">Named Datetimes</a>
    <li><a href="#label-DateTime.current"><code>DateTime.current</code></a>
    <li><a href="#label-Other+Extensions">Other Extensions</a>
    <li><a href="#label-seconds_since_midnight"><code>seconds_since_midnight</code></a>
    <li><a href="#label-utc"><code>utc</code></a>
    <li><a href="#label-utc-3F"><code>utc?</code></a>
    <li><a href="#label-advance"><code>advance</code></a>
    <li><a href="#label-Changing+Components">Changing Components</a>
    <li><a href="#label-Durations">Durations</a>
    <li><a href="#label-Extensions+to+Time">Extensions to <code>Time</code></a>
    <li><a href="#label-Calculations">Calculations</a>
    <li><a href="#label-Time.current"><code>Time.current</code></a>
    <li><a href="#label-all_day-2C+all_week-2C+all_month-2C+all_quarter+and+all_year"><code>all_day</code>, <code>all_week</code>, <code>all_month</code>, <code>all_quarter</code> and <code>all_year</code></a>
    <li><a href="#label-Time+Constructors">Time Constructors</a>
    <li><a href="#label-Durations">Durations</a>
    <li><a href="#label-Extensions+to+File">Extensions to <code>File</code></a>
    <li><a href="#label-atomic_write"><code>atomic_write</code></a>
    <li><a href="#label-Extensions+to+Marshal">Extensions to <code>Marshal</code></a>
    <li><a href="#label-load"><code>load</code></a>
    <li><a href="#label-Extensions+to+Logger">Extensions to <code>Logger</code></a>
    <li><a href="#label-around_-5Blevel-5D"><code>around_[level]</code></a>
    <li><a href="#label-silence"><code>silence</code></a>
    <li><a href="#label-datetime_format-3D"><code>datetime_format=</code></a>
    <li><a href="#label-Extensions+to+NameError">Extensions to <code>NameError</code></a>
    <li><a href="#label-Extensions+to+LoadError">Extensions to <code>LoadError</code></a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../README_md.html">README</a>
  
    <li><a href="../../guides/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="../../guides/Rakefile.html">Rakefile</a>
  
    <li><a href="../../guides/assets/images/icons/README.html">README</a>
  
    <li><a href="../../guides/assets/javascripts/guides_js.html">guides.js</a>
  
    <li><a href="../../guides/assets/javascripts/jquery_min_js.html">jquery.min.js</a>
  
    <li><a href="../../guides/assets/javascripts/responsive-tables_js.html">responsive-tables.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushAS3_js.html">shBrushAS3.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushAppleScript_js.html">shBrushAppleScript.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushBash_js.html">shBrushBash.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushCSharp_js.html">shBrushCSharp.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushColdFusion_js.html">shBrushColdFusion.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushCpp_js.html">shBrushCpp.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushCss_js.html">shBrushCss.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushDelphi_js.html">shBrushDelphi.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushDiff_js.html">shBrushDiff.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushErlang_js.html">shBrushErlang.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushGroovy_js.html">shBrushGroovy.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushJScript_js.html">shBrushJScript.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushJava_js.html">shBrushJava.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushJavaFX_js.html">shBrushJavaFX.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPerl_js.html">shBrushPerl.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPhp_js.html">shBrushPhp.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPlain_js.html">shBrushPlain.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPowerShell_js.html">shBrushPowerShell.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPython_js.html">shBrushPython.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushRuby_js.html">shBrushRuby.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushSass_js.html">shBrushSass.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushScala_js.html">shBrushScala.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushSql_js.html">shBrushSql.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushVb_js.html">shBrushVb.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushXml_js.html">shBrushXml.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shCore_js.html">shCore.js</a>
  
    <li><a href="../../guides/assets/stylesheets/fixes_css.html">fixes.css</a>
  
    <li><a href="../../guides/assets/stylesheets/kindle_css.html">kindle.css</a>
  
    <li><a href="../../guides/assets/stylesheets/main_css.html">main.css</a>
  
    <li><a href="../../guides/assets/stylesheets/print_css.html">print.css</a>
  
    <li><a href="../../guides/assets/stylesheets/reset_css.html">reset.css</a>
  
    <li><a href="../../guides/assets/stylesheets/responsive-tables_css.html">responsive-tables.css</a>
  
    <li><a href="../../guides/assets/stylesheets/style_css.html">style.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCore_css.html">shCore.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreDefault_css.html">shCoreDefault.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreDjango_css.html">shCoreDjango.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreEclipse_css.html">shCoreEclipse.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreEmacs_css.html">shCoreEmacs.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreFadeToGrey_css.html">shCoreFadeToGrey.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreMDUltra_css.html">shCoreMDUltra.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreMidnight_css.html">shCoreMidnight.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreRDark_css.html">shCoreRDark.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeDefault_css.html">shThemeDefault.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeDjango_css.html">shThemeDjango.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeEclipse_css.html">shThemeEclipse.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeEmacs_css.html">shThemeEmacs.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeFadeToGrey_css.html">shThemeFadeToGrey.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeMDUltra_css.html">shThemeMDUltra.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeMidnight_css.html">shThemeMidnight.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeRDark_css.html">shThemeRDark.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeRailsGuides_css.html">shThemeRailsGuides.css</a>
  
    <li><a href="../../guides/source/2_2_release_notes_md.html">2_2_release_notes</a>
  
    <li><a href="../../guides/source/2_3_release_notes_md.html">2_3_release_notes</a>
  
    <li><a href="../../guides/source/3_0_release_notes_md.html">3_0_release_notes</a>
  
    <li><a href="../../guides/source/3_1_release_notes_md.html">3_1_release_notes</a>
  
    <li><a href="../../guides/source/3_2_release_notes_md.html">3_2_release_notes</a>
  
    <li><a href="../../guides/source/4_0_release_notes_md.html">4_0_release_notes</a>
  
    <li><a href="../../guides/source/4_1_release_notes_md.html">4_1_release_notes</a>
  
    <li><a href="../../guides/source/4_2_release_notes_md.html">4_2_release_notes</a>
  
    <li><a href="../../guides/source/action_controller_overview_md.html">action_controller_overview</a>
  
    <li><a href="../../guides/source/action_mailer_basics_md.html">action_mailer_basics</a>
  
    <li><a href="../../guides/source/action_view_overview_md.html">action_view_overview</a>
  
    <li><a href="../../guides/source/active_job_basics_md.html">active_job_basics</a>
  
    <li><a href="../../guides/source/active_model_basics_md.html">active_model_basics</a>
  
    <li><a href="../../guides/source/active_record_basics_md.html">active_record_basics</a>
  
    <li><a href="../../guides/source/active_record_callbacks_md.html">active_record_callbacks</a>
  
    <li><a href="../../guides/source/active_record_migrations_md.html">active_record_migrations</a>
  
    <li><a href="../../guides/source/active_record_postgresql_md.html">active_record_postgresql</a>
  
    <li><a href="../../guides/source/active_record_querying_md.html">active_record_querying</a>
  
    <li><a href="../../guides/source/active_record_validations_md.html">active_record_validations</a>
  
    <li><a href="../../guides/source/active_support_core_extensions_md.html">active_support_core_extensions</a>
  
    <li><a href="../../guides/source/active_support_instrumentation_md.html">active_support_instrumentation</a>
  
    <li><a href="../../guides/source/api_documentation_guidelines_md.html">api_documentation_guidelines</a>
  
    <li><a href="../../guides/source/asset_pipeline_md.html">asset_pipeline</a>
  
    <li><a href="../../guides/source/association_basics_md.html">association_basics</a>
  
    <li><a href="../../guides/source/autoloading_and_reloading_constants_md.html">autoloading_and_reloading_constants</a>
  
    <li><a href="../../guides/source/caching_with_rails_md.html">caching_with_rails</a>
  
    <li><a href="../../guides/source/command_line_md.html">command_line</a>
  
    <li><a href="../../guides/source/configuring_md.html">configuring</a>
  
    <li><a href="../../guides/source/contributing_to_ruby_on_rails_md.html">contributing_to_ruby_on_rails</a>
  
    <li><a href="../../guides/source/debugging_rails_applications_md.html">debugging_rails_applications</a>
  
    <li><a href="../../guides/source/development_dependencies_install_md.html">development_dependencies_install</a>
  
    <li><a href="../../guides/source/documents_yaml.html">documents.yaml</a>
  
    <li><a href="../../guides/source/engines_md.html">engines</a>
  
    <li><a href="../../guides/source/form_helpers_md.html">form_helpers</a>
  
    <li><a href="../../guides/source/generators_md.html">generators</a>
  
    <li><a href="../../guides/source/getting_started_md.html">getting_started</a>
  
    <li><a href="../../guides/source/i18n_md.html">i18n</a>
  
    <li><a href="../../guides/source/initialization_md.html">initialization</a>
  
    <li><a href="../../guides/source/layouts_and_rendering_md.html">layouts_and_rendering</a>
  
    <li><a href="../../guides/source/maintenance_policy_md.html">maintenance_policy</a>
  
    <li><a href="../../guides/source/nested_model_forms_md.html">nested_model_forms</a>
  
    <li><a href="../../guides/source/plugins_md.html">plugins</a>
  
    <li><a href="../../guides/source/rails_application_templates_md.html">rails_application_templates</a>
  
    <li><a href="../../guides/source/rails_on_rack_md.html">rails_on_rack</a>
  
    <li><a href="../../guides/source/routing_md.html">routing</a>
  
    <li><a href="../../guides/source/ruby_on_rails_guides_guidelines_md.html">ruby_on_rails_guides_guidelines</a>
  
    <li><a href="../../guides/source/security_md.html">security</a>
  
    <li><a href="../../guides/source/testing_md.html">testing</a>
  
    <li><a href="../../guides/source/upgrading_ruby_on_rails_md.html">upgrading_ruby_on_rails</a>
  
    <li><a href="../../guides/source/working_with_javascript_in_rails_md.html">working_with_javascript_in_rails</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page guides/source/active_support_core_extensions.md">

<h1 id="label-Active+Support+Core+Extensions">Active Support Core Extensions<span><a href="#label-Active+Support+Core+Extensions">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>Active Support is the Ruby on Rails component responsible for providing
Ruby language extensions, utilities, and other transversal stuff.</p>

<p>It offers a richer bottom-line at the language level, targeted both at the
development of Rails applications, and at the development of Ruby on Rails
itself.</p>

<p>After reading this guide, you will know:</p>
<ul><li>
<p>What Core Extensions are.</p>
</li><li>
<p>How to load all extensions.</p>
</li><li>
<p>How to cherry-pick just the extensions you want.</p>
</li><li>
<p>What extensions Active Support provides.</p>
</li></ul>
<hr>

<h2 id="label-How+to+Load+Core+Extensions">How to Load Core Extensions<span><a href="#label-How+to+Load+Core+Extensions">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Stand-Alone+Active+Support">Stand-Alone Active Support<span><a href="#label-Stand-Alone+Active+Support">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>In order to have a near-zero default footprint, Active Support does not
load anything by default. It is broken in small pieces so that you can load
just what you need, and also has some convenience entry points to load
related extensions in one shot, even everything.</p>

<p>Thus, after a simple require like:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support&#39;</span>
</pre>

<p>objects do not even respond to <code>blank?</code>. Let&#39;s see how to
load its definition.</p>

<h4 id="label-Cherry-picking+a+Definition">Cherry-picking a Definition<span><a href="#label-Cherry-picking+a+Definition">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The most lightweight way to get <code>blank?</code> is to cherry-pick the
file that defines it.</p>

<p>For every single method defined as a core extension this guide has a note
that says where such a method is defined. In the case of
<code>blank?</code> the note reads:</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/blank.rb</code>.</p>

<p>That means that you can require it like this:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support/core_ext/object/blank&#39;</span>
</pre>

<p>Active Support has been carefully revised so that cherry-picking a file
loads only strictly needed dependencies, if any.</p>

<h4 id="label-Loading+Grouped+Core+Extensions">Loading Grouped Core Extensions<span><a href="#label-Loading+Grouped+Core+Extensions">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The next level is to simply load all extensions to <code>Object</code>. As
a rule of thumb, extensions to <code>SomeClass</code> are available in one
shot by loading <code>active_support/core_ext/some_class</code>.</p>

<p>Thus, to load all extensions to <code>Object</code> (including
<code>blank?</code>):</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support/core_ext/object&#39;</span>
</pre>

<h4 id="label-Loading+All+Core+Extensions">Loading All Core Extensions<span><a href="#label-Loading+All+Core+Extensions">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>You may prefer just to load all core extensions, there is a file for that:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support/core_ext&#39;</span>
</pre>

<h4 id="label-Loading+All+Active+Support">Loading All Active Support<span><a href="#label-Loading+All+Active+Support">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>And finally, if you want to have all Active Support available just issue:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;active_support/all&#39;</span>
</pre>

<p>That does not even put the entire Active Support in memory upfront indeed,
some stuff is configured via <code>autoload</code>, so it is only loaded if
used.</p>

<h3 id="label-Active+Support+Within+a+Ruby+on+Rails+Application">Active Support Within a Ruby on Rails Application<span><a href="#label-Active+Support+Within+a+Ruby+on+Rails+Application">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>A Ruby on Rails application loads all Active Support unless
<code>config.active_support.bare</code> is true. In that case, the
application will only load what the framework itself cherry-picks for its
own needs, and can still cherry-pick itself at any granularity level, as
explained in the previous section.</p>

<h2 id="label-Extensions+to+All+Objects">Extensions to All Objects<span><a href="#label-Extensions+to+All+Objects">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-blank-3F+and+present-3F"><code>blank?</code> and <code>present?</code><span><a href="#label-blank-3F+and+present-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The following values are considered to be blank in a Rails application:</p>
<ul><li>
<p><code>nil</code> and <code>false</code>,</p>
</li><li>
<p>strings composed only of whitespace (see note below),</p>
</li><li>
<p>empty arrays and hashes, and</p>
</li><li>
<p>any other object that responds to <code>empty?</code> and is empty.</p>
</li></ul>

<p>INFO: The predicate for strings uses the Unicode-aware character class
<code>[:space:]</code>, so for example U+2029 (paragraph separator) is
considered to be whitespace.</p>

<p>WARNING: Note that numbers are not mentioned. In particular, 0 and 0.0 are
<strong>not</strong> blank.</p>

<p>For example, this method from
<code>ActionController::HttpAuthentication::Token::ControllerMethods</code>
uses <code>blank?</code> for checking whether a token is present:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">authenticate</span>(<span class="ruby-identifier">controller</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">login_procedure</span>)
  <span class="ruby-identifier">token</span>, <span class="ruby-identifier">options</span> = <span class="ruby-identifier">token_and_options</span>(<span class="ruby-identifier">controller</span>.<span class="ruby-identifier">request</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">blank?</span>
    <span class="ruby-identifier">login_procedure</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The method <code>present?</code> is equivalent to <code>!blank?</code>.
This example is taken from
<code>ActionDispatch::Http::Cache::Response</code>:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">set_conditional_cache_control!</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>[<span class="ruby-string">&quot;Cache-Control&quot;</span>].<span class="ruby-identifier">present?</span>
  <span class="ruby-operator">...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/blank.rb</code>.</p>

<h3 id="label-presence"><code>presence</code><span><a href="#label-presence">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>presence</code> method returns its receiver if
<code>present?</code>, and <code>nil</code> otherwise. It is useful for
idioms like this:</p>

<pre class="ruby"><span class="ruby-identifier">host</span> = <span class="ruby-identifier">config</span>[:<span class="ruby-identifier">host</span>].<span class="ruby-identifier">presence</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;localhost&#39;</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/blank.rb</code>.</p>

<h3 id="label-duplicable-3F"><code>duplicable?</code><span><a href="#label-duplicable-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>A few fundamental objects in Ruby are singletons. For example, in the whole
life of a program the integer 1 refers always to the same instance:</p>

<pre class="ruby"><span class="ruby-value">1</span>.<span class="ruby-identifier">object_id</span>                 <span class="ruby-comment"># =&gt; 3</span>
<span class="ruby-constant">Math</span>.<span class="ruby-identifier">cos</span>(<span class="ruby-value">0</span>).<span class="ruby-identifier">to_i</span>.<span class="ruby-identifier">object_id</span>  <span class="ruby-comment"># =&gt; 3</span>
</pre>

<p>Hence, there&#39;s no way these objects can be duplicated through
<code>dup</code> or <code>clone</code>:</p>

<pre class="ruby"><span class="ruby-keyword">true</span>.<span class="ruby-identifier">dup</span>  <span class="ruby-comment"># =&gt; TypeError: can&#39;t dup TrueClass</span>
</pre>

<p>Some numbers which are not singletons are not duplicable either:</p>

<pre class="ruby"><span class="ruby-value">0.0</span>.<span class="ruby-identifier">clone</span>        <span class="ruby-comment"># =&gt; allocator undefined for Float</span>
(<span class="ruby-value">2</span><span class="ruby-operator">**</span><span class="ruby-value">1024</span>).<span class="ruby-identifier">clone</span>  <span class="ruby-comment"># =&gt; allocator undefined for Bignum</span>
</pre>

<p>Active Support provides <code>duplicable?</code> to programmatically query
an object about this property:</p>

<pre class="ruby"><span class="ruby-string">&quot;foo&quot;</span>.<span class="ruby-identifier">duplicable?</span> <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-string">&quot;&quot;</span>.<span class="ruby-identifier">duplicable?</span>    <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-value">0.0</span>.<span class="ruby-identifier">duplicable?</span>   <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-keyword">false</span>.<span class="ruby-identifier">duplicable?</span> <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>By definition all objects are <code>duplicable?</code> except
<code>nil</code>, <code>false</code>, <code>true</code>, symbols, numbers,
class, module, and method objects.</p>

<p>WARNING: Any class can disallow duplication by removing <code>dup</code>
and <code>clone</code> or raising exceptions from them. Thus only
<code>rescue</code> can tell whether a given arbitrary object is
duplicable. <code>duplicable?</code> depends on the hard-coded list above,
but it is much faster than <code>rescue</code>. Use it only if you know the
hard-coded list is enough in your use case.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/duplicable.rb</code>.</p>

<h3 id="label-deep_dup"><code>deep_dup</code><span><a href="#label-deep_dup">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>deep_dup</code> method returns deep copy of a given object.
Normally, when you <code>dup</code> an object that contains other objects,
Ruby does not <code>dup</code> them, so it creates a shallow copy of the
object. If you have an array with a string, for example, it will look like
this:</p>

<pre class="ruby"><span class="ruby-identifier">array</span>     = [<span class="ruby-string">&#39;string&#39;</span>]
<span class="ruby-identifier">duplicate</span> = <span class="ruby-identifier">array</span>.<span class="ruby-identifier">dup</span>

<span class="ruby-identifier">duplicate</span>.<span class="ruby-identifier">push</span> <span class="ruby-string">&#39;another-string&#39;</span>

<span class="ruby-comment"># the object was duplicated, so the element was added only to the duplicate</span>
<span class="ruby-identifier">array</span>     <span class="ruby-comment"># =&gt; [&#39;string&#39;]</span>
<span class="ruby-identifier">duplicate</span> <span class="ruby-comment"># =&gt; [&#39;string&#39;, &#39;another-string&#39;]</span>

<span class="ruby-identifier">duplicate</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-string">&#39;string&#39;</span>, <span class="ruby-string">&#39;foo&#39;</span>)

<span class="ruby-comment"># first element was not duplicated, it will be changed in both arrays</span>
<span class="ruby-identifier">array</span>     <span class="ruby-comment"># =&gt; [&#39;foo&#39;]</span>
<span class="ruby-identifier">duplicate</span> <span class="ruby-comment"># =&gt; [&#39;foo&#39;, &#39;another-string&#39;]</span>
</pre>

<p>As you can see, after duplicating the <code>Array</code> instance, we got
another object, therefore we can modify it and the original object will
stay unchanged. This is not true for array&#39;s elements, however. Since
<code>dup</code> does not make deep copy, the string inside the array is
still the same object.</p>

<p>If you need a deep copy of an object, you should use <code>deep_dup</code>.
Here is an example:</p>

<pre class="ruby"><span class="ruby-identifier">array</span>     = [<span class="ruby-string">&#39;string&#39;</span>]
<span class="ruby-identifier">duplicate</span> = <span class="ruby-identifier">array</span>.<span class="ruby-identifier">deep_dup</span>

<span class="ruby-identifier">duplicate</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-string">&#39;string&#39;</span>, <span class="ruby-string">&#39;foo&#39;</span>)

<span class="ruby-identifier">array</span>     <span class="ruby-comment"># =&gt; [&#39;string&#39;]</span>
<span class="ruby-identifier">duplicate</span> <span class="ruby-comment"># =&gt; [&#39;foo&#39;]</span>
</pre>

<p>If the object is not duplicable, <code>deep_dup</code> will just return it:</p>

<pre class="ruby"><span class="ruby-identifier">number</span> = <span class="ruby-value">1</span>
<span class="ruby-identifier">duplicate</span> = <span class="ruby-identifier">number</span>.<span class="ruby-identifier">deep_dup</span>
<span class="ruby-identifier">number</span>.<span class="ruby-identifier">object_id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">duplicate</span>.<span class="ruby-identifier">object_id</span>   <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p>

<h3 id="label-try"><code>try</code><span><a href="#label-try">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>When you want to call a method on an object only if it is not
<code>nil</code>, the simplest way to achieve it is with conditional
statements, adding unnecessary clutter. The alternative is to use
<code>try</code>. <code>try</code> is like <code>Object#send</code> except
that it returns <code>nil</code> if sent to <code>nil</code>.</p>

<p>Here is an example:</p>

<pre class="ruby"><span class="ruby-comment"># without try</span>
<span class="ruby-keyword">unless</span> <span class="ruby-ivar">@number</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-ivar">@number</span>.<span class="ruby-identifier">next</span>
<span class="ruby-keyword">end</span>

<span class="ruby-comment"># with try</span>
<span class="ruby-ivar">@number</span>.<span class="ruby-identifier">try</span>(:<span class="ruby-keyword">next</span>)
</pre>

<p>Another example is this code from
<code>ActiveRecord::ConnectionAdapters::AbstractAdapter</code> where
<code>@logger</code> could be <code>nil</code>. You can see that the code
uses <code>try</code> and avoids an unnecessary check.</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">log_info</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">ms</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">try</span>(:<span class="ruby-identifier">debug?</span>)
    <span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;%s (%.1fms)&#39;</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">name</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;SQL&#39;</span>, <span class="ruby-identifier">ms</span>]
    <span class="ruby-ivar">@logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-identifier">format_log_entry</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">sql</span>.<span class="ruby-identifier">squeeze</span>(<span class="ruby-string">&#39; &#39;</span>)))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p><code>try</code> can also be called without arguments but a block, which
will only be executed if the object is not nil:</p>

<pre class="ruby"><span class="ruby-ivar">@person</span>.<span class="ruby-identifier">try</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{p.first_name} #{p.last_name}&quot;</span> }
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/try.rb</code>.</p>

<h3 id="label-class_eval-28-2Aargs-2C+-26block-29"><code>class_eval(*args, &amp;block)</code><span><a href="#label-class_eval-28-2Aargs-2C+-26block-29">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>You can evaluate code in the context of any object&#39;s singleton class
using <code>class_eval</code>:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Proc</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">bind</span>(<span class="ruby-identifier">object</span>)
    <span class="ruby-identifier">block</span>, <span class="ruby-identifier">time</span> = <span class="ruby-keyword">self</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">current</span>
    <span class="ruby-identifier">object</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">method_name</span> = <span class="ruby-node">&quot;__bind_#{time.to_i}_#{time.usec}&quot;</span>
      <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">method_name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
      <span class="ruby-identifier">method</span> = <span class="ruby-identifier">instance_method</span>(<span class="ruby-identifier">method_name</span>)
      <span class="ruby-identifier">remove_method</span>(<span class="ruby-identifier">method_name</span>)
      <span class="ruby-identifier">method</span>
    <span class="ruby-keyword">end</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-identifier">object</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/kernel/singleton_class.rb</code>.</p>

<h3 id="label-acts_like-3F-28duck-29"><code>acts_like?(duck)</code><span><a href="#label-acts_like-3F-28duck-29">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>acts_like?</code> provides a way to check whether some
class acts like some other class based on a simple convention: a class that
provides the same interface as <code>String</code> defines</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">acts_like_string?</span>
<span class="ruby-keyword">end</span>
</pre>

<p>which is only a marker, its body or return value are irrelevant. Then,
client code can query for duck-type-safeness this way:</p>

<pre class="ruby"><span class="ruby-identifier">some_klass</span>.<span class="ruby-identifier">acts_like?</span>(:<span class="ruby-identifier">string</span>)
</pre>

<p>Rails has classes that act like <code>Date</code> or <code>Time</code> and
follow this contract.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/acts_like.rb</code>.</p>

<h3 id="label-to_param"><code>to_param</code><span><a href="#label-to_param">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>All objects in Rails respond to the method <code>to_param</code>, which is
meant to return something that represents them as values in a query string,
or as URL fragments.</p>

<p>By default <code>to_param</code> just calls <code>to_s</code>:</p>

<pre class="ruby"><span class="ruby-value">7</span>.<span class="ruby-identifier">to_param</span> <span class="ruby-comment"># =&gt; &quot;7&quot;</span>
</pre>

<p>The return value of <code>to_param</code> should <strong>not</strong> be
escaped:</p>

<pre class="ruby"><span class="ruby-string">&quot;Tom &amp; Jerry&quot;</span>.<span class="ruby-identifier">to_param</span> <span class="ruby-comment"># =&gt; &quot;Tom &amp; Jerry&quot;</span>
</pre>

<p>Several classes in Rails overwrite this method.</p>

<p>For example <code>nil</code>, <code>true</code>, and <code>false</code>
return themselves. <code>Array#to_param</code> calls <code>to_param</code>
on the elements and joins the result with “/”:</p>

<pre class="ruby">[<span class="ruby-value">0</span>, <span class="ruby-keyword">true</span>, <span class="ruby-constant">String</span>].<span class="ruby-identifier">to_param</span> <span class="ruby-comment"># =&gt; &quot;0/true/String&quot;</span>
</pre>

<p>Notably, the Rails routing system calls <code>to_param</code> on models to
get a value for the <code>:id</code> placeholder.
<code>ActiveRecord::Base#to_param</code> returns the <code>id</code> of a
model, but you can redefine that method in your models. For example, given</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">to_param</span>
    <span class="ruby-node">&quot;#{id}-#{name.parameterize}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>we get:</p>

<pre class="ruby"><span class="ruby-identifier">user_path</span>(<span class="ruby-ivar">@user</span>) <span class="ruby-comment"># =&gt; &quot;/users/357-john-smith&quot;</span>
</pre>

<p>WARNING. Controllers need to be aware of any redefinition of
<code>to_param</code> because when a request like that comes in
“357-john-smith” is the value of <code>params[:id]</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/to_param.rb</code>.</p>

<h3 id="label-to_query"><code>to_query</code><span><a href="#label-to_query">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Except for hashes, given an unescaped <code>key</code> this method
constructs the part of a query string that would map such key to what
<code>to_param</code> returns. For example, given</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">to_param</span>
    <span class="ruby-node">&quot;#{id}-#{name.parameterize}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>we get:</p>

<pre class="ruby"><span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">to_query</span>(<span class="ruby-string">&#39;user&#39;</span>) <span class="ruby-comment"># =&gt; user=357-john-smith</span>
</pre>

<p>This method escapes whatever is needed, both for the key and the value:</p>

<pre class="ruby"><span class="ruby-identifier">account</span>.<span class="ruby-identifier">to_query</span>(<span class="ruby-string">&#39;company[name]&#39;</span>)
<span class="ruby-comment"># =&gt; &quot;company%5Bname%5D=Johnson+%26+Johnson&quot;</span>
</pre>

<p>so its output is ready to be used in a query string.</p>

<p>Arrays return the result of applying <code>to_query</code> to each element
with <code><em>key</em>[]</code> as key, and join the result with “&amp;”:</p>

<pre class="ruby">[<span class="ruby-value">3.4</span>, <span class="ruby-value">-45.6</span>].<span class="ruby-identifier">to_query</span>(<span class="ruby-string">&#39;sample&#39;</span>)
<span class="ruby-comment"># =&gt; &quot;sample%5B%5D=3.4&amp;sample%5B%5D=-45.6&quot;</span>
</pre>

<p>Hashes also respond to <code>to_query</code> but with a different
signature. If no argument is passed a call generates a sorted series of
key/value assignments calling <code>to_query(key)</code> on its values.
Then it joins the result with “&amp;”:</p>

<pre class="ruby">{<span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}.<span class="ruby-identifier">to_query</span> <span class="ruby-comment"># =&gt; &quot;a=1&amp;b=2&amp;c=3&quot;</span>
</pre>

<p>The method <code>Hash#to_query</code> accepts an optional namespace for the
keys:</p>

<pre class="ruby">{<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-value">89</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;John Smith&quot;</span>}.<span class="ruby-identifier">to_query</span>(<span class="ruby-string">&#39;user&#39;</span>)
<span class="ruby-comment"># =&gt; &quot;user%5Bid%5D=89&amp;user%5Bname%5D=John+Smith&quot;</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/to_query.rb</code>.</p>

<h3 id="label-with_options"><code>with_options</code><span><a href="#label-with_options">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>with_options</code> provides a way to factor out common
options in a series of method calls.</p>

<p>Given a default options hash, <code>with_options</code> yields a proxy
object to a block. Within the block, methods called on the proxy are
forwarded to the receiver with their options merged. For example, you get
rid of the duplication in:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">customers</span>, <span class="ruby-identifier">dependent</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">destroy</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">products</span>,  <span class="ruby-identifier">dependent</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">destroy</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">invoices</span>,  <span class="ruby-identifier">dependent</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">destroy</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">expenses</span>,  <span class="ruby-identifier">dependent</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">destroy</span>
<span class="ruby-keyword">end</span>
</pre>

<p>this way:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Account</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">with_options</span> <span class="ruby-identifier">dependent</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">destroy</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assoc</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">customers</span>
    <span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">products</span>
    <span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">invoices</span>
    <span class="ruby-identifier">assoc</span>.<span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">expenses</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>That idiom may convey <em>grouping</em> to the reader as well. For example,
say you want to send a newsletter whose language depends on the user.
Somewhere in the mailer you could group locale-dependent bits like this:</p>

<pre class="ruby"><span class="ruby-constant">I18n</span>.<span class="ruby-identifier">with_options</span> <span class="ruby-identifier">locale</span><span class="ruby-operator">:</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">locale</span>, <span class="ruby-identifier">scope</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;newsletter&quot;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i18n</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">subject</span> <span class="ruby-identifier">i18n</span>.<span class="ruby-identifier">t</span> :<span class="ruby-identifier">subject</span>
  <span class="ruby-identifier">body</span>    <span class="ruby-identifier">i18n</span>.<span class="ruby-identifier">t</span> :<span class="ruby-identifier">body</span>, <span class="ruby-identifier">user_name</span><span class="ruby-operator">:</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span>
</pre>

<p>TIP: Since <code>with_options</code> forwards calls to its receiver they
can be nested. Each nesting level will merge inherited defaults in addition
to their own.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/object/with_options.rb</code>.</p>

<h3 id="label-JSON+support">JSON support<span><a href="#label-JSON+support">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Support provides a better implementation of <code>to_json</code>
than the <code>json</code> gem ordinarily provides for Ruby objects. This
is because some classes, like <code>Hash</code>, <code>OrderedHash</code>
and <code>Process::Status</code> need special handling in order to provide
a proper JSON representation.</p>

<p>NOTE: Defined in <code>active_support/core_ext/object/json.rb</code>.</p>

<h3 id="label-Instance+Variables">Instance Variables<span><a href="#label-Instance+Variables">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Support provides several methods to ease access to instance
variables.</p>

<h4 id="label-instance_values"><code>instance_values</code><span><a href="#label-instance_values">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>instance_values</code> returns a hash that maps instance
variable names without “@” to their corresponding values. Keys are strings:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">C</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>)
    <span class="ruby-ivar">@x</span>, <span class="ruby-ivar">@y</span> = <span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">C</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>, <span class="ruby-value">1</span>).<span class="ruby-identifier">instance_values</span> <span class="ruby-comment"># =&gt; {&quot;x&quot; =&gt; 0, &quot;y&quot; =&gt; 1}</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/object/instance_variables.rb</code>.</p>

<h4 id="label-instance_variable_names"><code>instance_variable_names</code><span><a href="#label-instance_variable_names">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>instance_variable_names</code> returns an array. Each name
includes the “@” sign.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">C</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>)
    <span class="ruby-ivar">@x</span>, <span class="ruby-ivar">@y</span> = <span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">C</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>, <span class="ruby-value">1</span>).<span class="ruby-identifier">instance_variable_names</span> <span class="ruby-comment"># =&gt; [&quot;@x&quot;, &quot;@y&quot;]</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/object/instance_variables.rb</code>.</p>

<h3 id="label-Silencing+Warnings-2C+Streams-2C+and+Exceptions">Silencing Warnings, Streams, and Exceptions<span><a href="#label-Silencing+Warnings-2C+Streams-2C+and+Exceptions">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The methods <code>silence_warnings</code> and <code>enable_warnings</code>
change the value of <code>$VERBOSE</code> accordingly for the duration of
their block, and reset it afterwards:</p>

<pre class="ruby"><span class="ruby-identifier">silence_warnings</span> { <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_set</span> <span class="ruby-string">&quot;RAILS_DEFAULT_LOGGER&quot;</span>, <span class="ruby-identifier">logger</span> }
</pre>

<p>You can silence any stream while a block runs with
<code>silence_stream</code>:</p>

<pre class="ruby"><span class="ruby-identifier">silence_stream</span>(<span class="ruby-constant">STDOUT</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># STDOUT is silent here</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The <code>quietly</code> method addresses the common use case where you
want to silence STDOUT and STDERR, even in subprocesses:</p>

<pre class="ruby"><span class="ruby-identifier">quietly</span> { <span class="ruby-identifier">system</span> <span class="ruby-string">&#39;bundle install&#39;</span> }
</pre>

<p>For example, the railties test suite uses that one in a few places to
prevent command messages from being echoed intermixed with the progress
status.</p>

<p>Silencing exceptions is also possible with <code>suppress</code>. This
method receives an arbitrary number of exception classes. If an exception
is raised during the execution of the block and is <code>kind_of?</code>
any of the arguments, <code>suppress</code> captures it and returns
silently. Otherwise the exception is reraised:</p>

<pre class="ruby"><span class="ruby-comment"># If the user is locked the increment is lost, no big deal.</span>
<span class="ruby-identifier">suppress</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StaleObjectError</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">increment!</span> :<span class="ruby-identifier">visits</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/kernel/reporting.rb</code>.</p>

<h3 id="label-in-3F"><code>in?</code><span><a href="#label-in-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The predicate <code>in?</code> tests if an object is included in another
object. An <code>ArgumentError</code> exception will be raised if the
argument passed does not respond to <code>include?</code>.</p>

<p>Examples of <code>in?</code>:</p>

<pre class="ruby"><span class="ruby-value">1</span>.<span class="ruby-identifier">in?</span>([<span class="ruby-value">1</span>,<span class="ruby-value">2</span>])        <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-string">&quot;lo&quot;</span>.<span class="ruby-identifier">in?</span>(<span class="ruby-string">&quot;hello&quot;</span>)   <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-value">25</span>.<span class="ruby-identifier">in?</span>(<span class="ruby-value">30</span><span class="ruby-operator">..</span><span class="ruby-value">50</span>)      <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-value">1</span>.<span class="ruby-identifier">in?</span>(<span class="ruby-value">1</span>)            <span class="ruby-comment"># =&gt; ArgumentError</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/inclusion.rb</code>.</p>

<h2 id="label-Extensions+to+Module">Extensions to <code>Module</code><span><a href="#label-Extensions+to+Module">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-alias_method_chain"><code>alias_method_chain</code><span><a href="#label-alias_method_chain">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Using plain Ruby you can wrap methods with other methods, that&#39;s called
<em>alias chaining</em>.</p>

<p>For example, let&#39;s say you&#39;d like params to be strings in
functional tests, as they are in real requests, but still want the
convenience of assigning integers and other kind of values. To accomplish
that you could wrap <code>ActionController::TestCase#process</code> this
way in <code>test/test_helper.rb</code>:</p>

<pre class="ruby"><span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestCase</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># save a reference to the original process method</span>
  <span class="ruby-identifier">alias_method</span> :<span class="ruby-identifier">original_process</span>, :<span class="ruby-identifier">process</span>

  <span class="ruby-comment"># now redefine process and delegate to original_process</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">process</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">params</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">session</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">flash</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">http_method</span>=<span class="ruby-string">&#39;GET&#39;</span>)
    <span class="ruby-identifier">params</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>]}.<span class="ruby-identifier">flatten</span>]
    <span class="ruby-identifier">original_process</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">session</span>, <span class="ruby-identifier">flash</span>, <span class="ruby-identifier">http_method</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>That&#39;s the method <code>get</code>, <code>post</code>, etc., delegate
the work to.</p>

<p>That technique has a risk, it could be the case that
<code>:original_process</code> was taken. To try to avoid collisions people
choose some label that characterizes what the chaining is about:</p>

<pre class="ruby"><span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestCase</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">process_with_stringified_params</span>(<span class="ruby-operator">...</span>)
    <span class="ruby-identifier">params</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>]}.<span class="ruby-identifier">flatten</span>]
    <span class="ruby-identifier">process_without_stringified_params</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">session</span>, <span class="ruby-identifier">flash</span>, <span class="ruby-identifier">http_method</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">alias_method</span> :<span class="ruby-identifier">process_without_stringified_params</span>, :<span class="ruby-identifier">process</span>
  <span class="ruby-identifier">alias_method</span> :<span class="ruby-identifier">process</span>, :<span class="ruby-identifier">process_with_stringified_params</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The method <code>alias_method_chain</code> provides a shortcut for that
pattern:</p>

<pre class="ruby"><span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">TestCase</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">process_with_stringified_params</span>(<span class="ruby-operator">...</span>)
    <span class="ruby-identifier">params</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>]}.<span class="ruby-identifier">flatten</span>]
    <span class="ruby-identifier">process_without_stringified_params</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">session</span>, <span class="ruby-identifier">flash</span>, <span class="ruby-identifier">http_method</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">alias_method_chain</span> :<span class="ruby-identifier">process</span>, :<span class="ruby-identifier">stringified_params</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Rails uses <code>alias_method_chain</code> all over the code base. For
example validations are added to <code>ActiveRecord::Base#save</code> by
wrapping the method that way in a separate module specialized in
validations.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/aliasing.rb</code>.</p>

<h3 id="label-Attributes">Attributes<span><a href="#label-Attributes">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-alias_attribute"><code>alias_attribute</code><span><a href="#label-alias_attribute">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Model attributes have a reader, a writer, and a predicate. You can alias a
model attribute having the corresponding three methods defined for you in
one shot. As in other aliasing methods, the new name is the first argument,
and the old name is the second (one mnemonic is that they go in the same
order as if you did an assignment):</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-comment"># You can refer to the email column as &quot;login&quot;.</span>
  <span class="ruby-comment"># This can be meaningful for authentication code.</span>
  <span class="ruby-identifier">alias_attribute</span> :<span class="ruby-identifier">login</span>, :<span class="ruby-identifier">email</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/module/aliasing.rb</code>.</p>

<h4 id="label-Internal+Attributes">Internal Attributes<span><a href="#label-Internal+Attributes">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>When you are defining an attribute in a class that is meant to be
subclassed, name collisions are a risk. That&#39;s remarkably important for
libraries.</p>

<p>Active Support defines the macros <code>attr_internal_reader</code>,
<code>attr_internal_writer</code>, and <code>attr_internal_accessor</code>.
They behave like their Ruby built-in <code>attr_*</code> counterparts,
except they name the underlying instance variable in a way that makes
collisions less likely.</p>

<p>The macro <code>attr_internal</code> is a synonym for
<code>attr_internal_accessor</code>:</p>

<pre class="ruby"><span class="ruby-comment"># library</span>
<span class="ruby-keyword">class</span> <span class="ruby-constant">ThirdPartyLibrary</span><span class="ruby-operator">::</span><span class="ruby-constant">Crawler</span>
  <span class="ruby-identifier">attr_internal</span> :<span class="ruby-identifier">log_level</span>
<span class="ruby-keyword">end</span>

<span class="ruby-comment"># client code</span>
<span class="ruby-keyword">class</span> <span class="ruby-constant">MyCrawler</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ThirdPartyLibrary</span><span class="ruby-operator">::</span><span class="ruby-constant">Crawler</span>
  <span class="ruby-identifier">attr_accessor</span> :<span class="ruby-identifier">log_level</span>
<span class="ruby-keyword">end</span>
</pre>

<p>In the previous example it could be the case that <code>:log_level</code>
does not belong to the public interface of the library and it is only used
for development. The client code, unaware of the potential conflict,
subclasses and defines its own <code>:log_level</code>. Thanks to
<code>attr_internal</code> there&#39;s no collision.</p>

<p>By default the internal instance variable is named with a leading
underscore, <code>@_log_level</code> in the example above. That&#39;s
configurable via <code>Module.attr_internal_naming_format</code> though,
you can pass any <code>sprintf</code>-like format string with a leading
<code>@</code> and a <code>%s</code> somewhere, which is where the name
will be placed. The default is <code>&quot;@_%s&quot;</code>.</p>

<p>Rails uses internal attributes in a few spots, for examples for views:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">ActionView</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">Base</span>
    <span class="ruby-identifier">attr_internal</span> :<span class="ruby-identifier">captures</span>
    <span class="ruby-identifier">attr_internal</span> :<span class="ruby-identifier">request</span>, :<span class="ruby-identifier">layout</span>
    <span class="ruby-identifier">attr_internal</span> :<span class="ruby-identifier">controller</span>, :<span class="ruby-identifier">template</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/module/attr_internal.rb</code>.</p>

<h4 id="label-Module+Attributes">Module Attributes<span><a href="#label-Module+Attributes">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The macros <code>mattr_reader</code>, <code>mattr_writer</code>, and
<code>mattr_accessor</code> are the same as the <code>cattr_*</code> macros
defined for class. In fact, the <code>cattr_*</code> macros are just
aliases for the <code>mattr_*</code> macros. Check <a
href="#class-attributes">Class Attributes</a>.</p>

<p>For example, the dependencies mechanism uses them:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">ActiveSupport</span>
  <span class="ruby-keyword">module</span> <span class="ruby-constant">Dependencies</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">warnings_on_first_load</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">history</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">loaded</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">mechanism</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">load_paths</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">load_once_paths</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">autoloaded_constants</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">explicitly_unloadable_constants</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">logger</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">log_activity</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">constant_watch_stack</span>
    <span class="ruby-identifier">mattr_accessor</span> :<span class="ruby-identifier">constant_watch_stack_mutex</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/module/attribute_accessors.rb</code>.</p>

<h3 id="label-Parents">Parents<span><a href="#label-Parents">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-parent"><code>parent</code><span><a href="#label-parent">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The <code>parent</code> method on a nested named module returns the module
that contains its corresponding constant:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">X</span>
  <span class="ruby-keyword">module</span> <span class="ruby-constant">Y</span>
    <span class="ruby-keyword">module</span> <span class="ruby-constant">Z</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">M</span> = <span class="ruby-constant">X</span><span class="ruby-operator">::</span><span class="ruby-constant">Y</span><span class="ruby-operator">::</span><span class="ruby-constant">Z</span>

<span class="ruby-constant">X</span><span class="ruby-operator">::</span><span class="ruby-constant">Y</span><span class="ruby-operator">::</span><span class="ruby-constant">Z</span>.<span class="ruby-identifier">parent</span> <span class="ruby-comment"># =&gt; X::Y</span>
<span class="ruby-constant">M</span>.<span class="ruby-identifier">parent</span>       <span class="ruby-comment"># =&gt; X::Y</span>
</pre>

<p>If the module is anonymous or belongs to the top-level, <code>parent</code>
returns <code>Object</code>.</p>

<p>WARNING: Note that in that case <code>parent_name</code> returns
<code>nil</code>.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/module/introspection.rb</code>.</p>

<h4 id="label-parent_name"><code>parent_name</code><span><a href="#label-parent_name">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The <code>parent_name</code> method on a nested named module returns the
fully-qualified name of the module that contains its corresponding
constant:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">X</span>
  <span class="ruby-keyword">module</span> <span class="ruby-constant">Y</span>
    <span class="ruby-keyword">module</span> <span class="ruby-constant">Z</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">M</span> = <span class="ruby-constant">X</span><span class="ruby-operator">::</span><span class="ruby-constant">Y</span><span class="ruby-operator">::</span><span class="ruby-constant">Z</span>

<span class="ruby-constant">X</span><span class="ruby-operator">::</span><span class="ruby-constant">Y</span><span class="ruby-operator">::</span><span class="ruby-constant">Z</span>.<span class="ruby-identifier">parent_name</span> <span class="ruby-comment"># =&gt; &quot;X::Y&quot;</span>
<span class="ruby-constant">M</span>.<span class="ruby-identifier">parent_name</span>       <span class="ruby-comment"># =&gt; &quot;X::Y&quot;</span>
</pre>

<p>For top-level or anonymous modules <code>parent_name</code> returns
<code>nil</code>.</p>

<p>WARNING: Note that in that case <code>parent</code> returns
<code>Object</code>.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/module/introspection.rb</code>.</p>

<h4 id="label-parents"><code>parents</code><span><a href="#label-parents">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>parents</code> calls <code>parent</code> on the receiver
and upwards until <code>Object</code> is reached. The chain is returned in
an array, from bottom to top:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">X</span>
  <span class="ruby-keyword">module</span> <span class="ruby-constant">Y</span>
    <span class="ruby-keyword">module</span> <span class="ruby-constant">Z</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">M</span> = <span class="ruby-constant">X</span><span class="ruby-operator">::</span><span class="ruby-constant">Y</span><span class="ruby-operator">::</span><span class="ruby-constant">Z</span>

<span class="ruby-constant">X</span><span class="ruby-operator">::</span><span class="ruby-constant">Y</span><span class="ruby-operator">::</span><span class="ruby-constant">Z</span>.<span class="ruby-identifier">parents</span> <span class="ruby-comment"># =&gt; [X::Y, X, Object]</span>
<span class="ruby-constant">M</span>.<span class="ruby-identifier">parents</span>       <span class="ruby-comment"># =&gt; [X::Y, X, Object]</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/module/introspection.rb</code>.</p>

<h3 id="label-Constants">Constants<span><a href="#label-Constants">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>local_constants</code> returns the names of the constants
that have been defined in the receiver module:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">X</span>
  <span class="ruby-constant">X1</span> = <span class="ruby-value">1</span>
  <span class="ruby-constant">X2</span> = <span class="ruby-value">2</span>
  <span class="ruby-keyword">module</span> <span class="ruby-constant">Y</span>
    <span class="ruby-constant">Y1</span> = :<span class="ruby-identifier">y1</span>
    <span class="ruby-constant">X1</span> = :<span class="ruby-identifier">overrides_X1_above</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">X</span>.<span class="ruby-identifier">local_constants</span>    <span class="ruby-comment"># =&gt; [:X1, :X2, :Y]</span>
<span class="ruby-constant">X</span><span class="ruby-operator">::</span><span class="ruby-constant">Y</span>.<span class="ruby-identifier">local_constants</span> <span class="ruby-comment"># =&gt; [:Y1, :X1]</span>
</pre>

<p>The names are returned as symbols.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/module/introspection.rb</code>.</p>

<h4 id="label-Qualified+Constant+Names">Qualified Constant Names<span><a href="#label-Qualified+Constant+Names">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The standard methods <code>const_defined?</code>, <code>const_get</code> ,
and <code>const_set</code> accept bare constant names. Active Support
extends this API to be able to pass relative qualified constant names.</p>

<p>The new methods are <code>qualified_const_defined?</code>,
<code>qualified_const_get</code>, and <code>qualified_const_set</code>.
Their arguments are assumed to be qualified constant names relative to
their receiver:</p>

<pre class="ruby"><span class="ruby-constant">Object</span>.<span class="ruby-identifier">qualified_const_defined?</span>(<span class="ruby-string">&quot;Math::PI&quot;</span>)       <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Object</span>.<span class="ruby-identifier">qualified_const_get</span>(<span class="ruby-string">&quot;Math::PI&quot;</span>)            <span class="ruby-comment"># =&gt; 3.141592653589793</span>
<span class="ruby-constant">Object</span>.<span class="ruby-identifier">qualified_const_set</span>(<span class="ruby-string">&quot;Math::Phi&quot;</span>, <span class="ruby-value">1.618034</span>) <span class="ruby-comment"># =&gt; 1.618034</span>
</pre>

<p>Arguments may be bare constant names:</p>

<pre class="ruby"><span class="ruby-constant">Math</span>.<span class="ruby-identifier">qualified_const_get</span>(<span class="ruby-string">&quot;E&quot;</span>) <span class="ruby-comment"># =&gt; 2.718281828459045</span>
</pre>

<p>These methods are analogous to their built-in counterparts. In particular,
<code>qualified_constant_defined?</code> accepts an optional second
argument to be able to say whether you want the predicate to look in the
ancestors. This flag is taken into account for each constant in the
expression while walking down the path.</p>

<p>For example, given</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
  <span class="ruby-constant">X</span> = <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">module</span> <span class="ruby-constant">N</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">C</span>
    <span class="ruby-identifier">include</span> <span class="ruby-constant">M</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p><code>qualified_const_defined?</code> behaves this way:</p>

<pre class="ruby"><span class="ruby-constant">N</span>.<span class="ruby-identifier">qualified_const_defined?</span>(<span class="ruby-string">&quot;C::X&quot;</span>, <span class="ruby-keyword">false</span>) <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-constant">N</span>.<span class="ruby-identifier">qualified_const_defined?</span>(<span class="ruby-string">&quot;C::X&quot;</span>, <span class="ruby-keyword">true</span>)  <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">N</span>.<span class="ruby-identifier">qualified_const_defined?</span>(<span class="ruby-string">&quot;C::X&quot;</span>)        <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>As the last example implies, the second argument defaults to true, as in
<code>const_defined?</code>.</p>

<p>For coherence with the built-in methods only relative paths are accepted.
Absolute qualified constant names like <code>::Math::PI</code> raise
<code>NameError</code>.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/module/qualified_const.rb</code>.</p>

<h3 id="label-Reachable">Reachable<span><a href="#label-Reachable">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>A named module is reachable if it is stored in its corresponding constant.
It means you can reach the module object via the constant.</p>

<p>That is what ordinarily happens, if a module is called “M”, the
<code>M</code> constant exists and holds it:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">M</span>.<span class="ruby-identifier">reachable?</span> <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>But since constants and modules are indeed kind of decoupled, module
objects can become unreachable:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">orphan</span> = <span class="ruby-constant">Object</span>.<span class="ruby-identifier">send</span>(:<span class="ruby-identifier">remove_const</span>, :<span class="ruby-constant">M</span>)

<span class="ruby-comment"># The module object is orphan now but it still has a name.</span>
<span class="ruby-identifier">orphan</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &quot;M&quot;</span>

<span class="ruby-comment"># You cannot reach it via the constant M because it does not even exist.</span>
<span class="ruby-identifier">orphan</span>.<span class="ruby-identifier">reachable?</span> <span class="ruby-comment"># =&gt; false</span>

<span class="ruby-comment"># Let&#39;s define a module called &quot;M&quot; again.</span>
<span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>

<span class="ruby-comment"># The constant M exists now again, and it stores a module</span>
<span class="ruby-comment"># object called &quot;M&quot;, but it is a new instance.</span>
<span class="ruby-identifier">orphan</span>.<span class="ruby-identifier">reachable?</span> <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/module/reachable.rb</code>.</p>

<h3 id="label-Anonymous">Anonymous<span><a href="#label-Anonymous">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>A module may or may not have a name:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">M</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &quot;M&quot;</span>

<span class="ruby-constant">N</span> = <span class="ruby-constant">Module</span>.<span class="ruby-identifier">new</span>
<span class="ruby-constant">N</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &quot;N&quot;</span>

<span class="ruby-constant">Module</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; nil</span>
</pre>

<p>You can check whether a module has a name with the predicate
<code>anonymous?</code>:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>
<span class="ruby-constant">M</span>.<span class="ruby-identifier">anonymous?</span> <span class="ruby-comment"># =&gt; false</span>

<span class="ruby-constant">Module</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">anonymous?</span> <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>Note that being unreachable does not imply being anonymous:</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">m</span> = <span class="ruby-constant">Object</span>.<span class="ruby-identifier">send</span>(:<span class="ruby-identifier">remove_const</span>, :<span class="ruby-constant">M</span>)

<span class="ruby-identifier">m</span>.<span class="ruby-identifier">reachable?</span> <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">m</span>.<span class="ruby-identifier">anonymous?</span> <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>though an anonymous module is unreachable by definition.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/anonymous.rb</code>.</p>

<h3 id="label-Method+Delegation">Method Delegation<span><a href="#label-Method+Delegation">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The macro <code>delegate</code> offers an easy way to forward methods.</p>

<p>Let&#39;s imagine that users in some application have login information in
the <code>User</code> model but name and other data in a separate
<code>Profile</code> model:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one</span> :<span class="ruby-identifier">profile</span>
<span class="ruby-keyword">end</span>
</pre>

<p>With that configuration you get a user&#39;s name via their profile,
<code>user.profile.name</code>, but it could be handy to still be able to
access such attribute directly:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one</span> :<span class="ruby-identifier">profile</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">name</span>
    <span class="ruby-identifier">profile</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>That is what <code>delegate</code> does for you:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">User</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_one</span> :<span class="ruby-identifier">profile</span>

  <span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">name</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">profile</span>
<span class="ruby-keyword">end</span>
</pre>

<p>It is shorter, and the intention more obvious.</p>

<p>The method must be public in the target.</p>

<p>The <code>delegate</code> macro accepts several methods:</p>

<pre class="ruby"><span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">age</span>, :<span class="ruby-identifier">address</span>, :<span class="ruby-identifier">twitter</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">profile</span>
</pre>

<p>When interpolated into a string, the <code>:to</code> option should become
an expression that evaluates to the object the method is delegated to.
Typically a string or symbol. Such an expression is evaluated in the
context of the receiver:</p>

<pre class="ruby"><span class="ruby-comment"># delegates to the Rails constant</span>
<span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">logger</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> :<span class="ruby-constant">Rails</span>

<span class="ruby-comment"># delegates to the receiver&#39;s class</span>
<span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> :<span class="ruby-keyword">class</span>
</pre>

<p>WARNING: If the <code>:prefix</code> option is <code>true</code> this is
less generic, see below.</p>

<p>By default, if the delegation raises <code>NoMethodError</code> and the
target is <code>nil</code> the exception is propagated. You can ask that
<code>nil</code> is returned instead with the <code>:allow_nil</code>
option:</p>

<pre class="ruby"><span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">name</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">profile</span>, <span class="ruby-identifier">allow_nil</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
</pre>

<p>With <code>:allow_nil</code> the call <code>user.name</code> returns
<code>nil</code> if the user has no profile.</p>

<p>The option <code>:prefix</code> adds a prefix to the name of the generated
method. This may be handy for example to get a better name:</p>

<pre class="ruby"><span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">street</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">address</span>, <span class="ruby-identifier">prefix</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
</pre>

<p>The previous example generates <code>address_street</code> rather than
<code>street</code>.</p>

<p>WARNING: Since in this case the name of the generated method is composed of
the target object and target method names, the <code>:to</code> option must
be a method name.</p>

<p>A custom prefix may also be configured:</p>

<pre class="ruby"><span class="ruby-identifier">delegate</span> :<span class="ruby-identifier">size</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">attachment</span>, <span class="ruby-identifier">prefix</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">avatar</span>
</pre>

<p>In the previous example the macro generates <code>avatar_size</code> rather
than <code>size</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/module/delegation.rb</code></p>

<h3 id="label-Redefining+Methods">Redefining Methods<span><a href="#label-Redefining+Methods">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>There are cases where you need to define a method with
<code>define_method</code>, but don&#39;t know whether a method with that
name already exists. If it does, a warning is issued if they are enabled.
No big deal, but not clean either.</p>

<p>The method <code>redefine_method</code> prevents such a potential warning,
removing the existing method before if needed.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/module/remove_method.rb</code></p>

<h2 id="label-Extensions+to+Class">Extensions to <code>Class</code><span><a href="#label-Extensions+to+Class">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Class+Attributes">Class Attributes<span><a href="#label-Class+Attributes">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-class_attribute"><code>class_attribute</code><span><a href="#label-class_attribute">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>class_attribute</code> declares one or more inheritable
class attributes that can be overridden at any level down the hierarchy.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">A</span>
  <span class="ruby-identifier">class_attribute</span> :<span class="ruby-identifier">x</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">B</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">A</span>; <span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">C</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">B</span>; <span class="ruby-keyword">end</span>

<span class="ruby-constant">A</span>.<span class="ruby-identifier">x</span> = :<span class="ruby-identifier">a</span>
<span class="ruby-constant">B</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; :a</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; :a</span>

<span class="ruby-constant">B</span>.<span class="ruby-identifier">x</span> = :<span class="ruby-identifier">b</span>
<span class="ruby-constant">A</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; :a</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; :b</span>

<span class="ruby-constant">C</span>.<span class="ruby-identifier">x</span> = :<span class="ruby-identifier">c</span>
<span class="ruby-constant">A</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; :a</span>
<span class="ruby-constant">B</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; :b</span>
</pre>

<p>For example <code>ActionMailer::Base</code> defines:</p>

<pre class="ruby"><span class="ruby-identifier">class_attribute</span> :<span class="ruby-identifier">default_params</span>
<span class="ruby-keyword">self</span>.<span class="ruby-identifier">default_params</span> = {
  <span class="ruby-identifier">mime_version</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;1.0&quot;</span>,
  <span class="ruby-identifier">charset</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;UTF-8&quot;</span>,
  <span class="ruby-identifier">content_type</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;text/plain&quot;</span>,
  <span class="ruby-identifier">parts_order</span><span class="ruby-operator">:</span> [ <span class="ruby-string">&quot;text/plain&quot;</span>, <span class="ruby-string">&quot;text/enriched&quot;</span>, <span class="ruby-string">&quot;text/html&quot;</span> ]
}.<span class="ruby-identifier">freeze</span>
</pre>

<p>They can also be accessed and overridden at the instance level.</p>

<pre class="ruby"><span class="ruby-constant">A</span>.<span class="ruby-identifier">x</span> = <span class="ruby-value">1</span>

<span class="ruby-identifier">a1</span> = <span class="ruby-constant">A</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">a2</span> = <span class="ruby-constant">A</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">a2</span>.<span class="ruby-identifier">x</span> = <span class="ruby-value">2</span>

<span class="ruby-identifier">a1</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; 1, comes from A</span>
<span class="ruby-identifier">a2</span>.<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; 2, overridden in a2</span>
</pre>

<p>The generation of the writer instance method can be prevented by setting
the option <code>:instance_writer</code> to <code>false</code>.</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">ActiveRecord</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">Base</span>
    <span class="ruby-identifier">class_attribute</span> :<span class="ruby-identifier">table_name_prefix</span>, <span class="ruby-identifier">instance_writer</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">table_name_prefix</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>A model may find that option useful as a way to prevent mass-assignment
from setting the attribute.</p>

<p>The generation of the reader instance method can be prevented by setting
the option <code>:instance_reader</code> to <code>false</code>.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">A</span>
  <span class="ruby-identifier">class_attribute</span> :<span class="ruby-identifier">x</span>, <span class="ruby-identifier">instance_reader</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">A</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">x</span> = <span class="ruby-value">1</span> <span class="ruby-comment"># NoMethodError</span>
</pre>

<p>For convenience <code>class_attribute</code> also defines an instance
predicate which is the double negation of what the instance reader returns.
In the examples above it would be called <code>x?</code>.</p>

<p>When <code>:instance_reader</code> is <code>false</code>, the instance
predicate returns a <code>NoMethodError</code> just like the reader method.</p>

<p>If you do not want the instance predicate, pass <code>instance_predicate:
false</code> and it will not be defined.</p>

<p>NOTE: Defined in <code>active_support/core_ext/class/attribute.rb</code></p>

<h4 id="label-cattr_reader-2C+cattr_writer-2C+and+cattr_accessor"><code>cattr_reader</code>, <code>cattr_writer</code>, and <code>cattr_accessor</code><span><a href="#label-cattr_reader-2C+cattr_writer-2C+and+cattr_accessor">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The macros <code>cattr_reader</code>, <code>cattr_writer</code>, and
<code>cattr_accessor</code> are analogous to their <code>attr_*</code>
counterparts but for classes. They initialize a class variable to
<code>nil</code> unless it already exists, and generate the corresponding
class methods to access it:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MysqlAdapter</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">AbstractAdapter</span>
  <span class="ruby-comment"># Generates class methods to access @@emulate_booleans.</span>
  <span class="ruby-identifier">cattr_accessor</span> :<span class="ruby-identifier">emulate_booleans</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">emulate_booleans</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Instance methods are created as well for convenience, they are just proxies
to the class attribute. So, instances can change the class attribute, but
cannot override it as it happens with <code>class_attribute</code> (see
above). For example given</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">ActionView</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">Base</span>
    <span class="ruby-identifier">cattr_accessor</span> :<span class="ruby-identifier">field_error_proc</span>
    <span class="ruby-identifier">@@field_error_proc</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{ <span class="ruby-operator">...</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>we can access <code>field_error_proc</code> in views.</p>

<p>Also, you can pass a block to <code>cattr_*</code> to set up the attribute
with a default value:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MysqlAdapter</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">AbstractAdapter</span>
  <span class="ruby-comment"># Generates class methods to access @@emulate_booleans with default value of true.</span>
  <span class="ruby-identifier">cattr_accessor</span>(:<span class="ruby-identifier">emulate_booleans</span>) { <span class="ruby-keyword">true</span> }
<span class="ruby-keyword">end</span>
</pre>

<p>The generation of the reader instance method can be prevented by setting
<code>:instance_reader</code> to <code>false</code> and the generation of
the writer instance method can be prevented by setting
<code>:instance_writer</code> to <code>false</code>. Generation of both
methods can be prevented by setting <code>:instance_accessor</code> to
<code>false</code>. In all cases, the value must be exactly
<code>false</code> and not any false value.</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">A</span>
  <span class="ruby-keyword">class</span> <span class="ruby-constant">B</span>
    <span class="ruby-comment"># No first_name instance reader is generated.</span>
    <span class="ruby-identifier">cattr_accessor</span> :<span class="ruby-identifier">first_name</span>, <span class="ruby-identifier">instance_reader</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
    <span class="ruby-comment"># No last_name= instance writer is generated.</span>
    <span class="ruby-identifier">cattr_accessor</span> :<span class="ruby-identifier">last_name</span>, <span class="ruby-identifier">instance_writer</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
    <span class="ruby-comment"># No surname instance reader or surname= writer is generated.</span>
    <span class="ruby-identifier">cattr_accessor</span> :<span class="ruby-identifier">surname</span>, <span class="ruby-identifier">instance_accessor</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>A model may find it useful to set <code>:instance_accessor</code> to
<code>false</code> as a way to prevent mass-assignment from setting the
attribute.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/module/attribute_accessors.rb</code>.</p>

<h3 id="label-Subclasses+-26+Descendants">Subclasses &amp; Descendants<span><a href="#label-Subclasses+-26+Descendants">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-subclasses"><code>subclasses</code><span><a href="#label-subclasses">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The <code>subclasses</code> method returns the subclasses of the receiver:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">C</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">subclasses</span> <span class="ruby-comment"># =&gt; []</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">B</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">C</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">subclasses</span> <span class="ruby-comment"># =&gt; [B]</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">A</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">B</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">subclasses</span> <span class="ruby-comment"># =&gt; [B]</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">D</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">C</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">subclasses</span> <span class="ruby-comment"># =&gt; [B, D]</span>
</pre>

<p>The order in which these classes are returned is unspecified.</p>

<p>NOTE: Defined in <code>active_support/core_ext/class/subclasses.rb</code>.</p>

<h4 id="label-descendants"><code>descendants</code><span><a href="#label-descendants">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The <code>descendants</code> method returns all classes that are
<code>&lt;</code> than its receiver:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">C</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">descendants</span> <span class="ruby-comment"># =&gt; []</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">B</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">C</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">descendants</span> <span class="ruby-comment"># =&gt; [B]</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">A</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">B</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">descendants</span> <span class="ruby-comment"># =&gt; [B, A]</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">D</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">C</span>; <span class="ruby-keyword">end</span>
<span class="ruby-constant">C</span>.<span class="ruby-identifier">descendants</span> <span class="ruby-comment"># =&gt; [B, A, D]</span>
</pre>

<p>The order in which these classes are returned is unspecified.</p>

<p>NOTE: Defined in <code>active_support/core_ext/class/subclasses.rb</code>.</p>

<h2 id="label-Extensions+to+String">Extensions to <code>String</code><span><a href="#label-Extensions+to+String">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Output+Safety">Output Safety<span><a href="#label-Output+Safety">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-Motivation">Motivation<span><a href="#label-Motivation">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Inserting data into HTML templates needs extra care. For example, you
can&#39;t just interpolate <code>@review.title</code> verbatim into an HTML
page. For one thing, if the review title is “Flanagan &amp; Matz rules!”
the output won&#39;t be well-formed because an ampersand has to be escaped
as “&amp;amp;”. What&#39;s more, depending on the application, that may be
a big security hole because users can inject malicious HTML setting a
hand-crafted review title. Check out the section about cross-site scripting
in the <a href="security.html#cross-site-scripting-xss">Security guide</a>
for further information about the risks.</p>

<h4 id="label-Safe+Strings">Safe Strings<span><a href="#label-Safe+Strings">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Active Support has the concept of <em>(html) safe</em> strings. A safe
string is one that is marked as being insertable into HTML as is. It is
trusted, no matter whether it has been escaped or not.</p>

<p>Strings are considered to be <em>unsafe</em> by default:</p>

<pre class="ruby"><span class="ruby-string">&quot;&quot;</span>.<span class="ruby-identifier">html_safe?</span> <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>You can obtain a safe string from a given one with the
<code>html_safe</code> method:</p>

<pre class="ruby"><span class="ruby-identifier">s</span> = <span class="ruby-string">&quot;&quot;</span>.<span class="ruby-identifier">html_safe</span>
<span class="ruby-identifier">s</span>.<span class="ruby-identifier">html_safe?</span> <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>It is important to understand that <code>html_safe</code> performs no
escaping whatsoever, it is just an assertion:</p>

<pre class="ruby"><span class="ruby-identifier">s</span> = <span class="ruby-string">&quot;&lt;script&gt;...&lt;/script&gt;&quot;</span>.<span class="ruby-identifier">html_safe</span>
<span class="ruby-identifier">s</span>.<span class="ruby-identifier">html_safe?</span> <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">s</span>            <span class="ruby-comment"># =&gt; &quot;&lt;script&gt;...&lt;/script&gt;&quot;</span>
</pre>

<p>It is your responsibility to ensure calling <code>html_safe</code> on a
particular string is fine.</p>

<p>If you append onto a safe string, either in-place with
<code>concat</code>/<code>&lt;&lt;</code>, or with <code>+</code>, the
result is a safe string. Unsafe arguments are escaped:</p>

<pre class="ruby"><span class="ruby-string">&quot;&quot;</span>.<span class="ruby-identifier">html_safe</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;&lt;&quot;</span> <span class="ruby-comment"># =&gt; &quot;&amp;lt;&quot;</span>
</pre>

<p>Safe arguments are directly appended:</p>

<pre class="ruby"><span class="ruby-string">&quot;&quot;</span>.<span class="ruby-identifier">html_safe</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;&lt;&quot;</span>.<span class="ruby-identifier">html_safe</span> <span class="ruby-comment"># =&gt; &quot;&lt;&quot;</span>
</pre>

<p>These methods should not be used in ordinary views. Unsafe values are
automatically escaped:</p>

<pre>&lt;%= @review.title %&gt; &lt;%# fine, escaped if needed %&gt;</pre>

<p>To insert something verbatim use the <code>raw</code> helper rather than
calling <code>html_safe</code>:</p>

<pre>&lt;%= raw @cms.current_template %&gt; &lt;%# inserts @cms.current_template as is %&gt;</pre>

<p>or, equivalently, use <code>&lt;%==</code>:</p>

<pre>&lt;%== @cms.current_template %&gt; &lt;%# inserts @cms.current_template as is %&gt;</pre>

<p>The <code>raw</code> helper calls <code>html_safe</code> for you:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">raw</span>(<span class="ruby-identifier">stringish</span>)
  <span class="ruby-identifier">stringish</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">html_safe</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/output_safety.rb</code>.</p>

<h4 id="label-Transformation">Transformation<span><a href="#label-Transformation">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>As a rule of thumb, except perhaps for concatenation as explained above,
any method that may change a string gives you an unsafe string. These are
<code>downcase</code>, <code>gsub</code>, <code>strip</code>,
<code>chomp</code>, <code>underscore</code>, etc.</p>

<p>In the case of in-place transformations like <code>gsub!</code> the
receiver itself becomes unsafe.</p>

<p>INFO: The safety bit is lost always, no matter whether the transformation
actually changed something.</p>

<h4 id="label-Conversion+and+Coercion">Conversion and Coercion<span><a href="#label-Conversion+and+Coercion">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Calling <code>to_s</code> on a safe string returns a safe string, but
coercion with <code>to_str</code> returns an unsafe string.</p>

<h4 id="label-Copying">Copying<span><a href="#label-Copying">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Calling <code>dup</code> or <code>clone</code> on safe strings yields safe
strings.</p>

<h3 id="label-remove"><code>remove</code><span><a href="#label-remove">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>remove</code> will remove all occurrences of the pattern:</p>

<pre class="ruby"><span class="ruby-string">&quot;Hello World&quot;</span>.<span class="ruby-identifier">remove</span>(<span class="ruby-regexp">/Hello /</span>) =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;World&quot;</span>
</pre>

<p>There&#39;s also the destructive version <code>String#remove!</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3 id="label-squish"><code>squish</code><span><a href="#label-squish">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>squish</code> strips leading and trailing whitespace, and
substitutes runs of whitespace with a single space each:</p>

<pre class="ruby"><span class="ruby-string">&quot; \n  foo\n\r \t bar \n&quot;</span>.<span class="ruby-identifier">squish</span> <span class="ruby-comment"># =&gt; &quot;foo bar&quot;</span>
</pre>

<p>There&#39;s also the destructive version <code>String#squish!</code>.</p>

<p>Note that it handles both ASCII and Unicode whitespace.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3 id="label-truncate"><code>truncate</code><span><a href="#label-truncate">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>truncate</code> returns a copy of its receiver truncated
after a given <code>length</code>:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate</span>(<span class="ruby-value">20</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh dear!...&quot;</span>
</pre>

<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate</span>(<span class="ruby-value">20</span>, <span class="ruby-identifier">omission</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;&amp;hellip;&#39;</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh &amp;hellip;&quot;</span>
</pre>

<p>Note in particular that truncation takes into account the length of the
omission string.</p>

<p>Pass a <code>:separator</code> to truncate the string at a natural break:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate</span>(<span class="ruby-value">18</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh dea...&quot;</span>
<span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate</span>(<span class="ruby-value">18</span>, <span class="ruby-identifier">separator</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39; &#39;</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh...&quot;</span>
</pre>

<p>The option <code>:separator</code> can be a regexp:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate</span>(<span class="ruby-value">18</span>, <span class="ruby-identifier">separator</span><span class="ruby-operator">:</span> <span class="ruby-regexp">/\s/</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh...&quot;</span>
</pre>

<p>In above examples “dear” gets cut first, but then <code>:separator</code>
prevents it.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3 id="label-truncate_words"><code>truncate_words</code><span><a href="#label-truncate_words">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>truncate_words</code> returns a copy of its receiver
truncated after a given number of words:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate_words</span>(<span class="ruby-value">4</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh dear!...&quot;</span>
</pre>

<p>Ellipsis can be customized with the <code>:omission</code> option:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate_words</span>(<span class="ruby-value">4</span>, <span class="ruby-identifier">omission</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;&amp;hellip;&#39;</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh dear!&amp;hellip;&quot;</span>
</pre>

<p>Pass a <code>:separator</code> to truncate the string at a natural break:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate_words</span>(<span class="ruby-value">3</span>, <span class="ruby-identifier">separator</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;!&#39;</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh dear! I shall be late...&quot;</span>
</pre>

<p>The option <code>:separator</code> can be a regexp:</p>

<pre class="ruby"><span class="ruby-string">&quot;Oh dear! Oh dear! I shall be late!&quot;</span>.<span class="ruby-identifier">truncate_words</span>(<span class="ruby-value">4</span>, <span class="ruby-identifier">separator</span><span class="ruby-operator">:</span> <span class="ruby-regexp">/\s/</span>)
<span class="ruby-comment"># =&gt; &quot;Oh dear! Oh dear!...&quot;</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/filters.rb</code>.</p>

<h3 id="label-inquiry"><code>inquiry</code><span><a href="#label-inquiry">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The <code>inquiry</code> method converts a string into a
<code>StringInquirer</code> object making equality checks prettier.</p>

<pre class="ruby"><span class="ruby-string">&quot;production&quot;</span>.<span class="ruby-identifier">inquiry</span>.<span class="ruby-identifier">production?</span> <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-string">&quot;active&quot;</span>.<span class="ruby-identifier">inquiry</span>.<span class="ruby-identifier">inactive?</span>       <span class="ruby-comment"># =&gt; false</span>
</pre>

<h3 id="label-starts_with-3F+and+ends_with-3F"><code>starts_with?</code> and <code>ends_with?</code><span><a href="#label-starts_with-3F+and+ends_with-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Support defines 3rd person aliases of
<code>String#start_with?</code> and <code>String#end_with?</code>:</p>

<pre class="ruby"><span class="ruby-string">&quot;foo&quot;</span>.<span class="ruby-identifier">starts_with?</span>(<span class="ruby-string">&quot;f&quot;</span>) <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-string">&quot;foo&quot;</span>.<span class="ruby-identifier">ends_with?</span>(<span class="ruby-string">&quot;o&quot;</span>)   <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/starts_ends_with.rb</code>.</p>

<h3 id="label-strip_heredoc"><code>strip_heredoc</code><span><a href="#label-strip_heredoc">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>strip_heredoc</code> strips indentation in heredocs.</p>

<p>For example in</p>

<pre class="ruby"><span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[:<span class="ruby-identifier">usage</span>]
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;    This command does such and such.

    Supported options are:
      -h         This message
      ...
&quot;</span>.<span class="ruby-identifier">strip_heredoc</span>
<span class="ruby-keyword">end</span>
</pre>

<p>the user would see the usage message aligned against the left margin.</p>

<p>Technically, it looks for the least indented line in the whole string, and
removes that amount of leading whitespace.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/strip.rb</code>.</p>

<h3 id="label-indent"><code>indent</code><span><a href="#label-indent">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Indents the lines in the receiver:</p>

<pre class="ruby"><span class="ruby-string">&quot;def some_method
  some_code
end
&quot;</span>.<span class="ruby-identifier">indent</span>(<span class="ruby-value">2</span>)
<span class="ruby-comment"># =&gt;</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">some_method</span>
    <span class="ruby-identifier">some_code</span>
  <span class="ruby-keyword">end</span>
</pre>

<p>The second argument, <code>indent_string</code>, specifies which indent
string to use. The default is <code>nil</code>, which tells the method to
make an educated guess peeking at the first indented line, and fallback to
a space if there is none.</p>

<pre class="ruby"><span class="ruby-string">&quot;  foo&quot;</span>.<span class="ruby-identifier">indent</span>(<span class="ruby-value">2</span>)        <span class="ruby-comment"># =&gt; &quot;    foo&quot;</span>
<span class="ruby-string">&quot;foo\n\t\tbar&quot;</span>.<span class="ruby-identifier">indent</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; &quot;\t\tfoo\n\t\t\t\tbar&quot;</span>
<span class="ruby-string">&quot;foo&quot;</span>.<span class="ruby-identifier">indent</span>(<span class="ruby-value">2</span>, <span class="ruby-string">&quot;\t&quot;</span>)    <span class="ruby-comment"># =&gt; &quot;\t\tfoo&quot;</span>
</pre>

<p>While <code>indent_string</code> is typically one space or tab, it may be
any string.</p>

<p>The third argument, <code>indent_empty_lines</code>, is a flag that says
whether empty lines should be indented. Default is false.</p>

<pre class="ruby"><span class="ruby-string">&quot;foo\n\nbar&quot;</span>.<span class="ruby-identifier">indent</span>(<span class="ruby-value">2</span>)            <span class="ruby-comment"># =&gt; &quot;  foo\n\n  bar&quot;</span>
<span class="ruby-string">&quot;foo\n\nbar&quot;</span>.<span class="ruby-identifier">indent</span>(<span class="ruby-value">2</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-keyword">true</span>) <span class="ruby-comment"># =&gt; &quot;  foo\n  \n  bar&quot;</span>
</pre>

<p>The <code>indent!</code> method performs indentation in-place.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/indent.rb</code>.</p>

<h3 id="label-Access">Access<span><a href="#label-Access">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-at-28position-29"><code>at(position)</code><span><a href="#label-at-28position-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Returns the character of the string at position <code>position</code>:</p>

<pre class="ruby"><span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>)  <span class="ruby-comment"># =&gt; &quot;h&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">4</span>)  <span class="ruby-comment"># =&gt; &quot;o&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">-1</span>) <span class="ruby-comment"># =&gt; &quot;o&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; nil</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4 id="label-from-28position-29"><code>from(position)</code><span><a href="#label-from-28position-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Returns the substring of the string starting at position
<code>position</code>:</p>

<pre class="ruby"><span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">0</span>)  <span class="ruby-comment"># =&gt; &quot;hello&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">2</span>)  <span class="ruby-comment"># =&gt; &quot;llo&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">-2</span>) <span class="ruby-comment"># =&gt; &quot;lo&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; &quot;&quot; if &lt; 1.9, nil in 1.9</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4 id="label-to-28position-29"><code>to(position)</code><span><a href="#label-to-28position-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Returns the substring of the string up to position <code>position</code>:</p>

<pre class="ruby"><span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">to</span>(<span class="ruby-value">0</span>)  <span class="ruby-comment"># =&gt; &quot;h&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">to</span>(<span class="ruby-value">2</span>)  <span class="ruby-comment"># =&gt; &quot;hel&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">to</span>(<span class="ruby-value">-2</span>) <span class="ruby-comment"># =&gt; &quot;hell&quot;</span>
<span class="ruby-string">&quot;hello&quot;</span>.<span class="ruby-identifier">to</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; &quot;hello&quot;</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4 id="label-first-28limit+-3D+1-29"><code>first(limit = 1)</code><span><a href="#label-first-28limit+-3D+1-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The call <code>str.first(n)</code> is equivalent to
<code>str.to(n-1)</code> if <code>n</code> &gt; 0, and returns an empty
string for <code>n</code> == 0.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h4 id="label-last-28limit+-3D+1-29"><code>last(limit = 1)</code><span><a href="#label-last-28limit+-3D+1-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The call <code>str.last(n)</code> is equivalent to
<code>str.from(-n)</code> if <code>n</code> &gt; 0, and returns an empty
string for <code>n</code> == 0.</p>

<p>NOTE: Defined in <code>active_support/core_ext/string/access.rb</code>.</p>

<h3 id="label-Inflections">Inflections<span><a href="#label-Inflections">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-pluralize"><code>pluralize</code><span><a href="#label-pluralize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>pluralize</code> returns the plural of its receiver:</p>

<pre class="ruby"><span class="ruby-string">&quot;table&quot;</span>.<span class="ruby-identifier">pluralize</span>     <span class="ruby-comment"># =&gt; &quot;tables&quot;</span>
<span class="ruby-string">&quot;ruby&quot;</span>.<span class="ruby-identifier">pluralize</span>      <span class="ruby-comment"># =&gt; &quot;rubies&quot;</span>
<span class="ruby-string">&quot;equipment&quot;</span>.<span class="ruby-identifier">pluralize</span> <span class="ruby-comment"># =&gt; &quot;equipment&quot;</span>
</pre>

<p>As the previous example shows, Active Support knows some irregular plurals
and uncountable nouns. Built-in rules can be extended in
<code>config/initializers/inflections.rb</code>. That file is generated by
the <code>rails</code> command and has instructions in comments.</p>

<p><code>pluralize</code> can also take an optional <code>count</code>
parameter. If <code>count == 1</code> the singular form will be returned.
For any other value of <code>count</code> the plural form will be returned:</p>

<pre class="ruby"><span class="ruby-string">&quot;dude&quot;</span>.<span class="ruby-identifier">pluralize</span>(<span class="ruby-value">0</span>) <span class="ruby-comment"># =&gt; &quot;dudes&quot;</span>
<span class="ruby-string">&quot;dude&quot;</span>.<span class="ruby-identifier">pluralize</span>(<span class="ruby-value">1</span>) <span class="ruby-comment"># =&gt; &quot;dude&quot;</span>
<span class="ruby-string">&quot;dude&quot;</span>.<span class="ruby-identifier">pluralize</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; &quot;dudes&quot;</span>
</pre>

<p>Active Record uses this method to compute the default table name that
corresponds to a model:</p>

<pre class="ruby"><span class="ruby-comment"># active_record/model_schema.rb</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">undecorated_table_name</span>(<span class="ruby-identifier">class_name</span> = <span class="ruby-identifier">base_class</span>.<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">class_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">demodulize</span>.<span class="ruby-identifier">underscore</span>
  <span class="ruby-identifier">pluralize_table_names</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">pluralize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">table_name</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-singularize"><code>singularize</code><span><a href="#label-singularize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The inverse of <code>pluralize</code>:</p>

<pre class="ruby"><span class="ruby-string">&quot;tables&quot;</span>.<span class="ruby-identifier">singularize</span>    <span class="ruby-comment"># =&gt; &quot;table&quot;</span>
<span class="ruby-string">&quot;rubies&quot;</span>.<span class="ruby-identifier">singularize</span>    <span class="ruby-comment"># =&gt; &quot;ruby&quot;</span>
<span class="ruby-string">&quot;equipment&quot;</span>.<span class="ruby-identifier">singularize</span> <span class="ruby-comment"># =&gt; &quot;equipment&quot;</span>
</pre>

<p>Associations compute the name of the corresponding default associated class
using this method:</p>

<pre class="ruby"><span class="ruby-comment"># active_record/reflection.rb</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">derive_class_name</span>
  <span class="ruby-identifier">class_name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">camelize</span>
  <span class="ruby-identifier">class_name</span> = <span class="ruby-identifier">class_name</span>.<span class="ruby-identifier">singularize</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">collection?</span>
  <span class="ruby-identifier">class_name</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-camelize"><code>camelize</code><span><a href="#label-camelize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>camelize</code> returns its receiver in camel case:</p>

<pre class="ruby"><span class="ruby-string">&quot;product&quot;</span>.<span class="ruby-identifier">camelize</span>    <span class="ruby-comment"># =&gt; &quot;Product&quot;</span>
<span class="ruby-string">&quot;admin_user&quot;</span>.<span class="ruby-identifier">camelize</span> <span class="ruby-comment"># =&gt; &quot;AdminUser&quot;</span>
</pre>

<p>As a rule of thumb you can think of this method as the one that transforms
paths into Ruby class or module names, where slashes separate namespaces:</p>

<pre class="ruby"><span class="ruby-string">&quot;backoffice/session&quot;</span>.<span class="ruby-identifier">camelize</span> <span class="ruby-comment"># =&gt; &quot;Backoffice::Session&quot;</span>
</pre>

<p>For example, Action Pack uses this method to load the class that provides a
certain session store:</p>

<pre class="ruby"><span class="ruby-comment"># action_controller/metal/session_management.rb</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">session_store=</span>(<span class="ruby-identifier">store</span>)
  <span class="ruby-identifier">@@session_store</span> = <span class="ruby-identifier">store</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>) <span class="ruby-operator">?</span>
    <span class="ruby-constant">ActionDispatch</span><span class="ruby-operator">::</span><span class="ruby-constant">Session</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">store</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">camelize</span>) <span class="ruby-operator">:</span>
    <span class="ruby-identifier">store</span>
<span class="ruby-keyword">end</span>
</pre>

<p><code>camelize</code> accepts an optional argument, it can be
<code>:upper</code> (default), or <code>:lower</code>. With the latter the
first letter becomes lowercase:</p>

<pre class="ruby"><span class="ruby-string">&quot;visual_effect&quot;</span>.<span class="ruby-identifier">camelize</span>(:<span class="ruby-identifier">lower</span>) <span class="ruby-comment"># =&gt; &quot;visualEffect&quot;</span>
</pre>

<p>That may be handy to compute method names in a language that follows that
convention, for example JavaScript.</p>

<p>INFO: As a rule of thumb you can think of <code>camelize</code> as the
inverse of <code>underscore</code>, though there are cases where that does
not hold: <code>&quot;SSLError&quot;.underscore.camelize</code> gives back
<code>&quot;SslError&quot;</code>. To support cases such as this, Active
Support allows you to specify acronyms in
<code>config/initializers/inflections.rb</code>:</p>

<pre class="ruby"><span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Inflector</span>.<span class="ruby-identifier">inflections</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inflect</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">inflect</span>.<span class="ruby-identifier">acronym</span> <span class="ruby-string">&#39;SSL&#39;</span>
<span class="ruby-keyword">end</span>

<span class="ruby-string">&quot;SSLError&quot;</span>.<span class="ruby-identifier">underscore</span>.<span class="ruby-identifier">camelize</span> <span class="ruby-comment"># =&gt; &quot;SSLError&quot;</span>
</pre>

<p><code>camelize</code> is aliased to <code>camelcase</code>.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-underscore"><code>underscore</code><span><a href="#label-underscore">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>underscore</code> goes the other way around, from camel
case to paths:</p>

<pre class="ruby"><span class="ruby-string">&quot;Product&quot;</span>.<span class="ruby-identifier">underscore</span>   <span class="ruby-comment"># =&gt; &quot;product&quot;</span>
<span class="ruby-string">&quot;AdminUser&quot;</span>.<span class="ruby-identifier">underscore</span> <span class="ruby-comment"># =&gt; &quot;admin_user&quot;</span>
</pre>

<p>Also converts “::” back to “/”:</p>

<pre class="ruby"><span class="ruby-string">&quot;Backoffice::Session&quot;</span>.<span class="ruby-identifier">underscore</span> <span class="ruby-comment"># =&gt; &quot;backoffice/session&quot;</span>
</pre>

<p>and understands strings that start with lowercase:</p>

<pre class="ruby"><span class="ruby-string">&quot;visualEffect&quot;</span>.<span class="ruby-identifier">underscore</span> <span class="ruby-comment"># =&gt; &quot;visual_effect&quot;</span>
</pre>

<p><code>underscore</code> accepts no argument though.</p>

<p>Rails class and module autoloading uses <code>underscore</code> to infer
the relative path without extension of a file that would define a given
missing constant:</p>

<pre class="ruby"><span class="ruby-comment"># active_support/dependencies.rb</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_missing_constant</span>(<span class="ruby-identifier">from_mod</span>, <span class="ruby-identifier">const_name</span>)
  <span class="ruby-operator">...</span>
  <span class="ruby-identifier">qualified_name</span> = <span class="ruby-identifier">qualified_name_for</span> <span class="ruby-identifier">from_mod</span>, <span class="ruby-identifier">const_name</span>
  <span class="ruby-identifier">path_suffix</span> = <span class="ruby-identifier">qualified_name</span>.<span class="ruby-identifier">underscore</span>
  <span class="ruby-operator">...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>INFO: As a rule of thumb you can think of <code>underscore</code> as the
inverse of <code>camelize</code>, though there are cases where that does
not hold. For example,
<code>&quot;SSLError&quot;.underscore.camelize</code> gives back
<code>&quot;SslError&quot;</code>.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-titleize"><code>titleize</code><span><a href="#label-titleize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>titleize</code> capitalizes the words in the receiver:</p>

<pre class="ruby"><span class="ruby-string">&quot;alice in wonderland&quot;</span>.<span class="ruby-identifier">titleize</span> <span class="ruby-comment"># =&gt; &quot;Alice In Wonderland&quot;</span>
<span class="ruby-string">&quot;fermat&#39;s enigma&quot;</span>.<span class="ruby-identifier">titleize</span>     <span class="ruby-comment"># =&gt; &quot;Fermat&#39;s Enigma&quot;</span>
</pre>

<p><code>titleize</code> is aliased to <code>titlecase</code>.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-dasherize"><code>dasherize</code><span><a href="#label-dasherize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>dasherize</code> replaces the underscores in the receiver
with dashes:</p>

<pre class="ruby"><span class="ruby-string">&quot;name&quot;</span>.<span class="ruby-identifier">dasherize</span>         <span class="ruby-comment"># =&gt; &quot;name&quot;</span>
<span class="ruby-string">&quot;contact_data&quot;</span>.<span class="ruby-identifier">dasherize</span> <span class="ruby-comment"># =&gt; &quot;contact-data&quot;</span>
</pre>

<p>The XML serializer of models uses this method to dasherize node names:</p>

<pre class="ruby"><span class="ruby-comment"># active_model/serializers/xml.rb</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reformat_name</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">camelize</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">camelize?</span>
  <span class="ruby-identifier">dasherize?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">dasherize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-demodulize"><code>demodulize</code><span><a href="#label-demodulize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Given a string with a qualified constant name, <code>demodulize</code>
returns the very constant name, that is, the rightmost part of it:</p>

<pre class="ruby"><span class="ruby-string">&quot;Product&quot;</span>.<span class="ruby-identifier">demodulize</span>                        <span class="ruby-comment"># =&gt; &quot;Product&quot;</span>
<span class="ruby-string">&quot;Backoffice::UsersController&quot;</span>.<span class="ruby-identifier">demodulize</span>    <span class="ruby-comment"># =&gt; &quot;UsersController&quot;</span>
<span class="ruby-string">&quot;Admin::Hotel::ReservationUtils&quot;</span>.<span class="ruby-identifier">demodulize</span> <span class="ruby-comment"># =&gt; &quot;ReservationUtils&quot;</span>
<span class="ruby-string">&quot;::Inflections&quot;</span>.<span class="ruby-identifier">demodulize</span>                  <span class="ruby-comment"># =&gt; &quot;Inflections&quot;</span>
<span class="ruby-string">&quot;&quot;</span>.<span class="ruby-identifier">demodulize</span>                               <span class="ruby-comment"># =&gt; &quot;&quot;</span>
</pre>

<p>Active Record for example uses this method to compute the name of a counter
cache column:</p>

<pre class="ruby"><span class="ruby-comment"># active_record/reflection.rb</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">counter_cache_column</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[:<span class="ruby-identifier">counter_cache</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
    <span class="ruby-node">&quot;#{active_record.name.demodulize.underscore.pluralize}_count&quot;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">options</span>[:<span class="ruby-identifier">counter_cache</span>]
    <span class="ruby-identifier">options</span>[:<span class="ruby-identifier">counter_cache</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-deconstantize"><code>deconstantize</code><span><a href="#label-deconstantize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Given a string with a qualified constant reference expression,
<code>deconstantize</code> removes the rightmost segment, generally leaving
the name of the constant&#39;s container:</p>

<pre class="ruby"><span class="ruby-string">&quot;Product&quot;</span>.<span class="ruby-identifier">deconstantize</span>                        <span class="ruby-comment"># =&gt; &quot;&quot;</span>
<span class="ruby-string">&quot;Backoffice::UsersController&quot;</span>.<span class="ruby-identifier">deconstantize</span>    <span class="ruby-comment"># =&gt; &quot;Backoffice&quot;</span>
<span class="ruby-string">&quot;Admin::Hotel::ReservationUtils&quot;</span>.<span class="ruby-identifier">deconstantize</span> <span class="ruby-comment"># =&gt; &quot;Admin::Hotel&quot;</span>
</pre>

<p>Active Support for example uses this method in
<code>Module#qualified_const_set</code>:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">qualified_const_set</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-constant">QualifiedConstUtils</span>.<span class="ruby-identifier">raise_if_absolute</span>(<span class="ruby-identifier">path</span>)

  <span class="ruby-identifier">const_name</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">demodulize</span>
  <span class="ruby-identifier">mod_name</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">deconstantize</span>
  <span class="ruby-identifier">mod</span> = <span class="ruby-identifier">mod_name</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">qualified_const_get</span>(<span class="ruby-identifier">mod_name</span>)
  <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">const_set</span>(<span class="ruby-identifier">const_name</span>, <span class="ruby-identifier">value</span>)
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-parameterize"><code>parameterize</code><span><a href="#label-parameterize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>parameterize</code> normalizes its receiver in a way that
can be used in pretty URLs.</p>

<pre class="ruby"><span class="ruby-string">&quot;John Smith&quot;</span>.<span class="ruby-identifier">parameterize</span> <span class="ruby-comment"># =&gt; &quot;john-smith&quot;</span>
<span class="ruby-string">&quot;Kurt Gödel&quot;</span>.<span class="ruby-identifier">parameterize</span> <span class="ruby-comment"># =&gt; &quot;kurt-godel&quot;</span>
</pre>

<p>In fact, the result string is wrapped in an instance of
<code>ActiveSupport::Multibyte::Chars</code>.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-tableize"><code>tableize</code><span><a href="#label-tableize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>tableize</code> is <code>underscore</code> followed by
<code>pluralize</code>.</p>

<pre class="ruby"><span class="ruby-string">&quot;Person&quot;</span>.<span class="ruby-identifier">tableize</span>      <span class="ruby-comment"># =&gt; &quot;people&quot;</span>
<span class="ruby-string">&quot;Invoice&quot;</span>.<span class="ruby-identifier">tableize</span>     <span class="ruby-comment"># =&gt; &quot;invoices&quot;</span>
<span class="ruby-string">&quot;InvoiceLine&quot;</span>.<span class="ruby-identifier">tableize</span> <span class="ruby-comment"># =&gt; &quot;invoice_lines&quot;</span>
</pre>

<p>As a rule of thumb, <code>tableize</code> returns the table name that
corresponds to a given model for simple cases. The actual implementation in
Active Record is not straight <code>tableize</code> indeed, because it also
demodulizes the class name and checks a few options that may affect the
returned string.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-classify"><code>classify</code><span><a href="#label-classify">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>classify</code> is the inverse of <code>tableize</code>.
It gives you the class name corresponding to a table name:</p>

<pre class="ruby"><span class="ruby-string">&quot;people&quot;</span>.<span class="ruby-identifier">classify</span>        <span class="ruby-comment"># =&gt; &quot;Person&quot;</span>
<span class="ruby-string">&quot;invoices&quot;</span>.<span class="ruby-identifier">classify</span>      <span class="ruby-comment"># =&gt; &quot;Invoice&quot;</span>
<span class="ruby-string">&quot;invoice_lines&quot;</span>.<span class="ruby-identifier">classify</span> <span class="ruby-comment"># =&gt; &quot;InvoiceLine&quot;</span>
</pre>

<p>The method understands qualified table names:</p>

<pre class="ruby"><span class="ruby-string">&quot;highrise_production.companies&quot;</span>.<span class="ruby-identifier">classify</span> <span class="ruby-comment"># =&gt; &quot;Company&quot;</span>
</pre>

<p>Note that <code>classify</code> returns a class name as a string. You can
get the actual class object invoking <code>constantize</code> on it,
explained next.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-constantize"><code>constantize</code><span><a href="#label-constantize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>constantize</code> resolves the constant reference
expression in its receiver:</p>

<pre class="ruby"><span class="ruby-string">&quot;Fixnum&quot;</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-comment"># =&gt; Fixnum</span>

<span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
  <span class="ruby-constant">X</span> = <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span>
<span class="ruby-string">&quot;M::X&quot;</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-comment"># =&gt; 1</span>
</pre>

<p>If the string evaluates to no known constant, or its content is not even a
valid constant name, <code>constantize</code> raises
<code>NameError</code>.</p>

<p>Constant name resolution by <code>constantize</code> starts always at the
top-level <code>Object</code> even if there is no leading “::”.</p>

<pre class="ruby"><span class="ruby-constant">X</span> = :<span class="ruby-identifier">in_Object</span>
<span class="ruby-keyword">module</span> <span class="ruby-constant">M</span>
  <span class="ruby-constant">X</span> = :<span class="ruby-identifier">in_M</span>

  <span class="ruby-constant">X</span>                 <span class="ruby-comment"># =&gt; :in_M</span>
  <span class="ruby-string">&quot;::X&quot;</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-comment"># =&gt; :in_Object</span>
  <span class="ruby-string">&quot;X&quot;</span>.<span class="ruby-identifier">constantize</span>   <span class="ruby-comment"># =&gt; :in_Object (!)</span>
<span class="ruby-keyword">end</span>
</pre>

<p>So, it is in general not equivalent to what Ruby would do in the same spot,
had a real constant be evaluated.</p>

<p>Mailer test cases obtain the mailer being tested from the name of the test
class using <code>constantize</code>:</p>

<pre class="ruby"><span class="ruby-comment"># action_mailer/test_case.rb</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">determine_default_mailer</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/Test$/</span>, <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">constantize</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NonInferrableMailerError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">name</span>)
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-humanize"><code>humanize</code><span><a href="#label-humanize">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>humanize</code> tweaks an attribute name for display to
end users.</p>

<p>Specifically performs these transformations:</p>
<ul><li>
<p>Applies human inflection rules to the argument.</p>
</li><li>
<p>Deletes leading underscores, if any.</p>
</li><li>
<p>Removes a “_id” suffix if present.</p>
</li><li>
<p>Replaces underscores with spaces, if any.</p>
</li><li>
<p>Downcases all words except acronyms.</p>
</li><li>
<p>Capitalizes the first word.</p>
</li></ul>

<p>The capitalization of the first word can be turned off by setting the
<code>:capitalize</code> option to false (default is true).</p>

<pre class="ruby"><span class="ruby-string">&quot;name&quot;</span>.<span class="ruby-identifier">humanize</span>                         <span class="ruby-comment"># =&gt; &quot;Name&quot;</span>
<span class="ruby-string">&quot;author_id&quot;</span>.<span class="ruby-identifier">humanize</span>                    <span class="ruby-comment"># =&gt; &quot;Author&quot;</span>
<span class="ruby-string">&quot;author_id&quot;</span>.<span class="ruby-identifier">humanize</span>(<span class="ruby-identifier">capitalize</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>) <span class="ruby-comment"># =&gt; &quot;author&quot;</span>
<span class="ruby-string">&quot;comments_count&quot;</span>.<span class="ruby-identifier">humanize</span>               <span class="ruby-comment"># =&gt; &quot;Comments count&quot;</span>
<span class="ruby-string">&quot;_id&quot;</span>.<span class="ruby-identifier">humanize</span>                          <span class="ruby-comment"># =&gt; &quot;Id&quot;</span>
</pre>

<p>If “SSL” was defined to be an acronym:</p>

<pre class="ruby"><span class="ruby-string">&#39;ssl_error&#39;</span>.<span class="ruby-identifier">humanize</span> <span class="ruby-comment"># =&gt; &quot;SSL error&quot;</span>
</pre>

<p>The helper method <code>full_messages</code> uses <code>humanize</code> as
a fallback to include attribute names:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">full_messages</span>
  <span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">attribute</span>, <span class="ruby-identifier">message</span><span class="ruby-operator">|</span> <span class="ruby-identifier">full_message</span>(<span class="ruby-identifier">attribute</span>, <span class="ruby-identifier">message</span>) }
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">def</span> <span class="ruby-identifier">full_message</span>
  <span class="ruby-operator">...</span>
  <span class="ruby-identifier">attr_name</span> = <span class="ruby-identifier">attribute</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-string">&#39;.&#39;</span>, <span class="ruby-string">&#39;_&#39;</span>).<span class="ruby-identifier">humanize</span>
  <span class="ruby-identifier">attr_name</span> = <span class="ruby-ivar">@base</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">human_attribute_name</span>(<span class="ruby-identifier">attribute</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-identifier">attr_name</span>)
  <span class="ruby-operator">...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h4 id="label-foreign_key"><code>foreign_key</code><span><a href="#label-foreign_key">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>foreign_key</code> gives a foreign key column name from a
class name. To do so it demodulizes, underscores, and adds “_id”:</p>

<pre class="ruby"><span class="ruby-string">&quot;User&quot;</span>.<span class="ruby-identifier">foreign_key</span>           <span class="ruby-comment"># =&gt; &quot;user_id&quot;</span>
<span class="ruby-string">&quot;InvoiceLine&quot;</span>.<span class="ruby-identifier">foreign_key</span>    <span class="ruby-comment"># =&gt; &quot;invoice_line_id&quot;</span>
<span class="ruby-string">&quot;Admin::Session&quot;</span>.<span class="ruby-identifier">foreign_key</span> <span class="ruby-comment"># =&gt; &quot;session_id&quot;</span>
</pre>

<p>Pass a false argument if you do not want the underscore in “_id”:</p>

<pre class="ruby"><span class="ruby-string">&quot;User&quot;</span>.<span class="ruby-identifier">foreign_key</span>(<span class="ruby-keyword">false</span>) <span class="ruby-comment"># =&gt; &quot;userid&quot;</span>
</pre>

<p>Associations use this method to infer foreign keys, for example
<code>has_one</code> and <code>has_many</code> do this:</p>

<pre class="ruby"><span class="ruby-comment"># active_record/associations.rb</span>
<span class="ruby-identifier">foreign_key</span> = <span class="ruby-identifier">options</span>[:<span class="ruby-identifier">foreign_key</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">reflection</span>.<span class="ruby-identifier">active_record</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">foreign_key</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/string/inflections.rb</code>.</p>

<h3 id="label-Conversions">Conversions<span><a href="#label-Conversions">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-to_date-2C+to_time-2C+to_datetime"><code>to_date</code>, <code>to_time</code>, <code>to_datetime</code><span><a href="#label-to_date-2C+to_time-2C+to_datetime">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The methods <code>to_date</code>, <code>to_time</code>, and
<code>to_datetime</code> are basically convenience wrappers around
<code>Date._parse</code>:</p>

<pre class="ruby"><span class="ruby-string">&quot;2010-07-27&quot;</span>.<span class="ruby-identifier">to_date</span>              <span class="ruby-comment"># =&gt; Tue, 27 Jul 2010</span>
<span class="ruby-string">&quot;2010-07-27 23:37:00&quot;</span>.<span class="ruby-identifier">to_time</span>     <span class="ruby-comment"># =&gt; Tue Jul 27 23:37:00 UTC 2010</span>
<span class="ruby-string">&quot;2010-07-27 23:37:00&quot;</span>.<span class="ruby-identifier">to_datetime</span> <span class="ruby-comment"># =&gt; Tue, 27 Jul 2010 23:37:00 +0000</span>
</pre>

<p><code>to_time</code> receives an optional argument <code>:utc</code> or
<code>:local</code>, to indicate which time zone you want the time in:</p>

<pre class="ruby"><span class="ruby-string">&quot;2010-07-27 23:42:00&quot;</span>.<span class="ruby-identifier">to_time</span>(:<span class="ruby-identifier">utc</span>)   <span class="ruby-comment"># =&gt; Tue Jul 27 23:42:00 UTC 2010</span>
<span class="ruby-string">&quot;2010-07-27 23:42:00&quot;</span>.<span class="ruby-identifier">to_time</span>(:<span class="ruby-identifier">local</span>) <span class="ruby-comment"># =&gt; Tue Jul 27 23:42:00 +0200 2010</span>
</pre>

<p>Default is <code>:utc</code>.</p>

<p>Please refer to the documentation of <code>Date._parse</code> for further
details.</p>

<p>INFO: The three of them return <code>nil</code> for blank receivers.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/string/conversions.rb</code>.</p>

<h2 id="label-Extensions+to+Numeric">Extensions to <code>Numeric</code><span><a href="#label-Extensions+to+Numeric">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Bytes">Bytes<span><a href="#label-Bytes">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>All numbers respond to these methods:</p>

<pre class="ruby"><span class="ruby-identifier">bytes</span>
<span class="ruby-identifier">kilobytes</span>
<span class="ruby-identifier">megabytes</span>
<span class="ruby-identifier">gigabytes</span>
<span class="ruby-identifier">terabytes</span>
<span class="ruby-identifier">petabytes</span>
<span class="ruby-identifier">exabytes</span>
</pre>

<p>They return the corresponding amount of bytes, using a conversion factor of
1024:</p>

<pre class="ruby"><span class="ruby-value">2</span>.<span class="ruby-identifier">kilobytes</span>   <span class="ruby-comment"># =&gt; 2048</span>
<span class="ruby-value">3</span>.<span class="ruby-identifier">megabytes</span>   <span class="ruby-comment"># =&gt; 3145728</span>
<span class="ruby-value">3.5</span>.<span class="ruby-identifier">gigabytes</span> <span class="ruby-comment"># =&gt; 3758096384</span>
<span class="ruby-value">-4</span>.<span class="ruby-identifier">exabytes</span>   <span class="ruby-comment"># =&gt; -4611686018427387904</span>
</pre>

<p>Singular forms are aliased so you are able to say:</p>

<pre class="ruby"><span class="ruby-value">1</span>.<span class="ruby-identifier">megabyte</span> <span class="ruby-comment"># =&gt; 1048576</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/numeric/bytes.rb</code>.</p>

<h3 id="label-Time">Time<span><a href="#label-Time">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Enables the use of time calculations and declarations, like
<code>45.minutes + 2.hours + 4.years</code>.</p>

<p>These methods use Time#advance for precise date calculations when using
from_now, ago, etc. as well as adding or subtracting their results from a
Time object. For example:</p>

<pre class="ruby"><span class="ruby-comment"># equivalent to Time.current.advance(months: 1)</span>
<span class="ruby-value">1</span>.<span class="ruby-identifier">month</span>.<span class="ruby-identifier">from_now</span>

<span class="ruby-comment"># equivalent to Time.current.advance(years: 2)</span>
<span class="ruby-value">2</span>.<span class="ruby-identifier">years</span>.<span class="ruby-identifier">from_now</span>

<span class="ruby-comment"># equivalent to Time.current.advance(months: 4, years: 5)</span>
(<span class="ruby-value">4</span>.<span class="ruby-identifier">months</span> <span class="ruby-operator">+</span> <span class="ruby-value">5</span>.<span class="ruby-identifier">years</span>).<span class="ruby-identifier">from_now</span>
</pre>

<h3 id="label-Formatting">Formatting<span><a href="#label-Formatting">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Enables the formatting of numbers in a variety of ways.</p>

<p>Produce a string representation of a number as a telephone number:</p>

<pre class="ruby"><span class="ruby-value">5551234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">phone</span>)
<span class="ruby-comment"># =&gt; 555-1234</span>
<span class="ruby-value">1235551234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">phone</span>)
<span class="ruby-comment"># =&gt; 123-555-1234</span>
<span class="ruby-value">1235551234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">phone</span>, <span class="ruby-identifier">area_code</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
<span class="ruby-comment"># =&gt; (123) 555-1234</span>
<span class="ruby-value">1235551234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">phone</span>, <span class="ruby-identifier">delimiter</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot; &quot;</span>)
<span class="ruby-comment"># =&gt; 123 555 1234</span>
<span class="ruby-value">1235551234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">phone</span>, <span class="ruby-identifier">area_code</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">extension</span><span class="ruby-operator">:</span> <span class="ruby-value">555</span>)
<span class="ruby-comment"># =&gt; (123) 555-1234 x 555</span>
<span class="ruby-value">1235551234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">phone</span>, <span class="ruby-identifier">country_code</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; +1-123-555-1234</span>
</pre>

<p>Produce a string representation of a number as currency:</p>

<pre class="ruby"><span class="ruby-value">1234567890.50</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">currency</span>)                 <span class="ruby-comment"># =&gt; $1,234,567,890.50</span>
<span class="ruby-value">1234567890.506</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">currency</span>)                <span class="ruby-comment"># =&gt; $1,234,567,890.51</span>
<span class="ruby-value">1234567890.506</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">currency</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>)  <span class="ruby-comment"># =&gt; $1,234,567,890.506</span>
</pre>

<p>Produce a string representation of a number as a percentage:</p>

<pre class="ruby"><span class="ruby-value">100</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">percentage</span>)
<span class="ruby-comment"># =&gt; 100.000%</span>
<span class="ruby-value">100</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">percentage</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
<span class="ruby-comment"># =&gt; 100%</span>
<span class="ruby-value">1000</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">percentage</span>, <span class="ruby-identifier">delimiter</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;.&#39;</span>, <span class="ruby-identifier">separator</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;,&#39;</span>)
<span class="ruby-comment"># =&gt; 1.000,000%</span>
<span class="ruby-value">302.24398923423</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">percentage</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span>)
<span class="ruby-comment"># =&gt; 302.24399%</span>
</pre>

<p>Produce a string representation of a number in delimited form:</p>

<pre class="ruby"><span class="ruby-value">12345678</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">delimited</span>)                     <span class="ruby-comment"># =&gt; 12,345,678</span>
<span class="ruby-value">12345678.05</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">delimited</span>)                  <span class="ruby-comment"># =&gt; 12,345,678.05</span>
<span class="ruby-value">12345678</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">delimited</span>, <span class="ruby-identifier">delimiter</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;.&quot;</span>)     <span class="ruby-comment"># =&gt; 12.345.678</span>
<span class="ruby-value">12345678</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">delimited</span>, <span class="ruby-identifier">delimiter</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;,&quot;</span>)     <span class="ruby-comment"># =&gt; 12,345,678</span>
<span class="ruby-value">12345678.05</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">delimited</span>, <span class="ruby-identifier">separator</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot; &quot;</span>)  <span class="ruby-comment"># =&gt; 12,345,678 05</span>
</pre>

<p>Produce a string representation of a number rounded to a precision:</p>

<pre class="ruby"><span class="ruby-value">111.2345</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">rounded</span>)                     <span class="ruby-comment"># =&gt; 111.235</span>
<span class="ruby-value">111.2345</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">rounded</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)       <span class="ruby-comment"># =&gt; 111.23</span>
<span class="ruby-value">13</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">rounded</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span>)             <span class="ruby-comment"># =&gt; 13.00000</span>
<span class="ruby-value">389.32314</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">rounded</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>)      <span class="ruby-comment"># =&gt; 389</span>
<span class="ruby-value">111.2345</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">rounded</span>, <span class="ruby-identifier">significant</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)  <span class="ruby-comment"># =&gt; 111</span>
</pre>

<p>Produce a string representation of a number as a human-readable number of
bytes:</p>

<pre class="ruby"><span class="ruby-value">123</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human_size</span>)            <span class="ruby-comment"># =&gt; 123 Bytes</span>
<span class="ruby-value">1234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human_size</span>)           <span class="ruby-comment"># =&gt; 1.21 KB</span>
<span class="ruby-value">12345</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human_size</span>)          <span class="ruby-comment"># =&gt; 12.1 KB</span>
<span class="ruby-value">1234567</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human_size</span>)        <span class="ruby-comment"># =&gt; 1.18 MB</span>
<span class="ruby-value">1234567890</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human_size</span>)     <span class="ruby-comment"># =&gt; 1.15 GB</span>
<span class="ruby-value">1234567890123</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human_size</span>)  <span class="ruby-comment"># =&gt; 1.12 TB</span>
</pre>

<p>Produce a string representation of a number in human-readable words:</p>

<pre class="ruby"><span class="ruby-value">123</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human</span>)               <span class="ruby-comment"># =&gt; &quot;123&quot;</span>
<span class="ruby-value">1234</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human</span>)              <span class="ruby-comment"># =&gt; &quot;1.23 Thousand&quot;</span>
<span class="ruby-value">12345</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human</span>)             <span class="ruby-comment"># =&gt; &quot;12.3 Thousand&quot;</span>
<span class="ruby-value">1234567</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human</span>)           <span class="ruby-comment"># =&gt; &quot;1.23 Million&quot;</span>
<span class="ruby-value">1234567890</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human</span>)        <span class="ruby-comment"># =&gt; &quot;1.23 Billion&quot;</span>
<span class="ruby-value">1234567890123</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human</span>)     <span class="ruby-comment"># =&gt; &quot;1.23 Trillion&quot;</span>
<span class="ruby-value">1234567890123456</span>.<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">human</span>)  <span class="ruby-comment"># =&gt; &quot;1.23 Quadrillion&quot;</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/numeric/conversions.rb</code>.</p>

<h2 id="label-Extensions+to+Integer">Extensions to <code>Integer</code><span><a href="#label-Extensions+to+Integer">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-multiple_of-3F"><code>multiple_of?</code><span><a href="#label-multiple_of-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>multiple_of?</code> tests whether an integer is multiple
of the argument:</p>

<pre class="ruby"><span class="ruby-value">2</span>.<span class="ruby-identifier">multiple_of?</span>(<span class="ruby-value">1</span>) <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-value">1</span>.<span class="ruby-identifier">multiple_of?</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/integer/multiple.rb</code>.</p>

<h3 id="label-ordinal"><code>ordinal</code><span><a href="#label-ordinal">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>ordinal</code> returns the ordinal suffix string
corresponding to the receiver integer:</p>

<pre class="ruby"><span class="ruby-value">1</span>.<span class="ruby-identifier">ordinal</span>    <span class="ruby-comment"># =&gt; &quot;st&quot;</span>
<span class="ruby-value">2</span>.<span class="ruby-identifier">ordinal</span>    <span class="ruby-comment"># =&gt; &quot;nd&quot;</span>
<span class="ruby-value">53</span>.<span class="ruby-identifier">ordinal</span>   <span class="ruby-comment"># =&gt; &quot;rd&quot;</span>
<span class="ruby-value">2009</span>.<span class="ruby-identifier">ordinal</span> <span class="ruby-comment"># =&gt; &quot;th&quot;</span>
<span class="ruby-value">-21</span>.<span class="ruby-identifier">ordinal</span>  <span class="ruby-comment"># =&gt; &quot;st&quot;</span>
<span class="ruby-value">-134</span>.<span class="ruby-identifier">ordinal</span> <span class="ruby-comment"># =&gt; &quot;th&quot;</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/integer/inflections.rb</code>.</p>

<h3 id="label-ordinalize"><code>ordinalize</code><span><a href="#label-ordinalize">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>ordinalize</code> returns the ordinal string corresponding
to the receiver integer. In comparison, note that the <code>ordinal</code>
method returns <strong>only</strong> the suffix string.</p>

<pre class="ruby"><span class="ruby-value">1</span>.<span class="ruby-identifier">ordinalize</span>    <span class="ruby-comment"># =&gt; &quot;1st&quot;</span>
<span class="ruby-value">2</span>.<span class="ruby-identifier">ordinalize</span>    <span class="ruby-comment"># =&gt; &quot;2nd&quot;</span>
<span class="ruby-value">53</span>.<span class="ruby-identifier">ordinalize</span>   <span class="ruby-comment"># =&gt; &quot;53rd&quot;</span>
<span class="ruby-value">2009</span>.<span class="ruby-identifier">ordinalize</span> <span class="ruby-comment"># =&gt; &quot;2009th&quot;</span>
<span class="ruby-value">-21</span>.<span class="ruby-identifier">ordinalize</span>  <span class="ruby-comment"># =&gt; &quot;-21st&quot;</span>
<span class="ruby-value">-134</span>.<span class="ruby-identifier">ordinalize</span> <span class="ruby-comment"># =&gt; &quot;-134th&quot;</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/integer/inflections.rb</code>.</p>

<h2 id="label-Extensions+to+BigDecimal">Extensions to <code>BigDecimal</code><span><a href="#label-Extensions+to+BigDecimal">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-to_s"><code>to_s</code><span><a href="#label-to_s">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>to_s</code> is aliased to <code>to_formatted_s</code>.
This provides a convenient way to display a BigDecimal value in
floating-point notation:</p>

<pre class="ruby"><span class="ruby-constant">BigDecimal</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">5.00</span>, <span class="ruby-value">6</span>).<span class="ruby-identifier">to_s</span>  <span class="ruby-comment"># =&gt; &quot;5.0&quot;</span>
</pre>

<h3 id="label-to_formatted_s"><code>to_formatted_s</code><span><a href="#label-to_formatted_s">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Te method <code>to_formatted_s</code> provides a default specifier of “F”.
This means that a simple call to <code>to_formatted_s</code> or
<code>to_s</code> will result in floating point representation instead of
engineering notation:</p>

<pre class="ruby"><span class="ruby-constant">BigDecimal</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">5.00</span>, <span class="ruby-value">6</span>).<span class="ruby-identifier">to_formatted_s</span>  <span class="ruby-comment"># =&gt; &quot;5.0&quot;</span>
</pre>

<p>and that symbol specifiers are also supported:</p>

<pre class="ruby"><span class="ruby-constant">BigDecimal</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">5.00</span>, <span class="ruby-value">6</span>).<span class="ruby-identifier">to_formatted_s</span>(:<span class="ruby-identifier">db</span>)  <span class="ruby-comment"># =&gt; &quot;5.0&quot;</span>
</pre>

<p>Engineering notation is still supported:</p>

<pre class="ruby"><span class="ruby-constant">BigDecimal</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">5.00</span>, <span class="ruby-value">6</span>).<span class="ruby-identifier">to_formatted_s</span>(<span class="ruby-string">&quot;e&quot;</span>)  <span class="ruby-comment"># =&gt; &quot;0.5E1&quot;</span>
</pre>

<h2 id="label-Extensions+to+Enumerable">Extensions to <code>Enumerable</code><span><a href="#label-Extensions+to+Enumerable">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-sum"><code>sum</code><span><a href="#label-sum">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>sum</code> adds the elements of an enumerable:</p>

<pre class="ruby">[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>].<span class="ruby-identifier">sum</span> <span class="ruby-comment"># =&gt; 6</span>
(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">100</span>).<span class="ruby-identifier">sum</span>  <span class="ruby-comment"># =&gt; 5050</span>
</pre>

<p>Addition only assumes the elements respond to <code>+</code>:</p>

<pre class="ruby">[[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>], [<span class="ruby-value">2</span>, <span class="ruby-value">3</span>], [<span class="ruby-value">3</span>, <span class="ruby-value">4</span>]].<span class="ruby-identifier">sum</span>    <span class="ruby-comment"># =&gt; [1, 2, 2, 3, 3, 4]</span>
<span class="ruby-node">%w(foo bar baz)</span>.<span class="ruby-identifier">sum</span>             <span class="ruby-comment"># =&gt; &quot;foobarbaz&quot;</span>
{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>}.<span class="ruby-identifier">sum</span> <span class="ruby-comment"># =&gt; [:b, 2, :c, 3, :a, 1]</span>
</pre>

<p>The sum of an empty collection is zero by default, but this is
customizable:</p>

<pre class="ruby">[].<span class="ruby-identifier">sum</span>    <span class="ruby-comment"># =&gt; 0</span>
[].<span class="ruby-identifier">sum</span>(<span class="ruby-value">1</span>) <span class="ruby-comment"># =&gt; 1</span>
</pre>

<p>If a block is given, <code>sum</code> becomes an iterator that yields the
elements of the collection and sums the returned values:</p>

<pre class="ruby">(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>).<span class="ruby-identifier">sum</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-identifier">n</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span> } <span class="ruby-comment"># =&gt; 30</span>
[<span class="ruby-value">2</span>, <span class="ruby-value">4</span>, <span class="ruby-value">6</span>, <span class="ruby-value">8</span>, <span class="ruby-value">10</span>].<span class="ruby-identifier">sum</span>    <span class="ruby-comment"># =&gt; 30</span>
</pre>

<p>The sum of an empty receiver can be customized in this form as well:</p>

<pre class="ruby">[].<span class="ruby-identifier">sum</span>(<span class="ruby-value">1</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-identifier">n</span><span class="ruby-operator">**</span><span class="ruby-value">3</span>} <span class="ruby-comment"># =&gt; 1</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3 id="label-index_by"><code>index_by</code><span><a href="#label-index_by">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>index_by</code> generates a hash with the elements of an
enumerable indexed by some key.</p>

<p>It iterates through the collection and passes each element to a block. The
element will be keyed by the value returned by the block:</p>

<pre class="ruby"><span class="ruby-identifier">invoices</span>.<span class="ruby-identifier">index_by</span>(<span class="ruby-operator">&amp;</span>:<span class="ruby-identifier">number</span>)
<span class="ruby-comment"># =&gt; {&#39;2009-032&#39; =&gt; &lt;Invoice ...&gt;, &#39;2009-008&#39; =&gt; &lt;Invoice ...&gt;, ...}</span>
</pre>

<p>WARNING. Keys should normally be unique. If the block returns the same
value for different elements no collection is built for that key. The last
item will win.</p>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3 id="label-many-3F"><code>many?</code><span><a href="#label-many-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>many?</code> is shorthand for <code>collection.size &gt;
1</code>:</p>

<pre>&lt;% if pages.many? %&gt;
  &lt;%= pagination_links %&gt;
&lt;% end %&gt;</pre>

<p>If an optional block is given, <code>many?</code> only takes into account
those elements that return true:</p>

<pre class="ruby"><span class="ruby-ivar">@see_more</span> = <span class="ruby-identifier">videos</span>.<span class="ruby-identifier">many?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">video</span><span class="ruby-operator">|</span> <span class="ruby-identifier">video</span>.<span class="ruby-identifier">category</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[:<span class="ruby-identifier">category</span>]}
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h3 id="label-exclude-3F"><code>exclude?</code><span><a href="#label-exclude-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The predicate <code>exclude?</code> tests whether a given object does
<strong>not</strong> belong to the collection. It is the negation of the
built-in <code>include?</code>:</p>

<pre class="ruby"><span class="ruby-identifier">to_visit</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">node</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">visited</span>.<span class="ruby-identifier">exclude?</span>(<span class="ruby-identifier">node</span>)
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/enumerable.rb</code>.</p>

<h2 id="label-Extensions+to+Array">Extensions to <code>Array</code><span><a href="#label-Extensions+to+Array">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Accessing">Accessing<span><a href="#label-Accessing">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Support augments the API of arrays to ease certain ways of accessing
them. For example, <code>to</code> returns the subarray of elements up to
the one at the passed index:</p>

<pre class="ruby"><span class="ruby-node">%w(a b c d)</span>.<span class="ruby-identifier">to</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; %w(a b c)</span>
[].<span class="ruby-identifier">to</span>(<span class="ruby-value">7</span>)          <span class="ruby-comment"># =&gt; []</span>
</pre>

<p>Similarly, <code>from</code> returns the tail from the element at the
passed index to the end. If the index is greater than the length of the
array, it returns an empty array.</p>

<pre class="ruby"><span class="ruby-node">%w(a b c d)</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">2</span>)  <span class="ruby-comment"># =&gt; %w(c d)</span>
<span class="ruby-node">%w(a b c d)</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; []</span>
[].<span class="ruby-identifier">from</span>(<span class="ruby-value">0</span>)           <span class="ruby-comment"># =&gt; []</span>
</pre>

<p>The methods <code>second</code>, <code>third</code>, <code>fourth</code>,
and <code>fifth</code> return the corresponding element (<code>first</code>
is built-in). Thanks to social wisdom and positive constructiveness all
around, <code>forty_two</code> is also available.</p>

<pre class="ruby"><span class="ruby-node">%w(a b c d)</span>.<span class="ruby-identifier">third</span> <span class="ruby-comment"># =&gt; c</span>
<span class="ruby-node">%w(a b c d)</span>.<span class="ruby-identifier">fifth</span> <span class="ruby-comment"># =&gt; nil</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/array/access.rb</code>.</p>

<h3 id="label-Adding+Elements">Adding Elements<span><a href="#label-Adding+Elements">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-prepend"><code>prepend</code><span><a href="#label-prepend">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>This method is an alias of <code>Array#unshift</code>.</p>

<pre class="ruby"><span class="ruby-node">%w(a b c d)</span>.<span class="ruby-identifier">prepend</span>(<span class="ruby-string">&#39;e&#39;</span>)  <span class="ruby-comment"># =&gt; %w(e a b c d)</span>
[].<span class="ruby-identifier">prepend</span>(<span class="ruby-value">10</span>)            <span class="ruby-comment"># =&gt; [10]</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/array/prepend_and_append.rb</code>.</p>

<h4 id="label-append"><code>append</code><span><a href="#label-append">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>This method is an alias of <code>Array#&lt;&lt;</code>.</p>

<pre class="ruby"><span class="ruby-node">%w(a b c d)</span>.<span class="ruby-identifier">append</span>(<span class="ruby-string">&#39;e&#39;</span>)  <span class="ruby-comment"># =&gt; %w(a b c d e)</span>
[].<span class="ruby-identifier">append</span>([<span class="ruby-value">1</span>,<span class="ruby-value">2</span>])         <span class="ruby-comment"># =&gt; [[1,2]]</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/array/prepend_and_append.rb</code>.</p>

<h3 id="label-Options+Extraction">Options Extraction<span><a href="#label-Options+Extraction">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>When the last argument in a method call is a hash, except perhaps for a
<code>&amp;block</code> argument, Ruby allows you to omit the brackets:</p>

<pre class="ruby"><span class="ruby-constant">User</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">email</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>[:<span class="ruby-identifier">email</span>])
</pre>

<p>That syntactic sugar is used a lot in Rails to avoid positional arguments
where there would be too many, offering instead interfaces that emulate
named parameters. In particular it is very idiomatic to use a trailing hash
for options.</p>

<p>If a method expects a variable number of arguments and uses <code>*</code>
in its declaration, however, such an options hash ends up being an item of
the array of arguments, where it loses its role.</p>

<p>In those cases, you may give an options hash a distinguished treatment with
<code>extract_options!</code>. This method checks the type of the last item
of an array. If it is a hash it pops it and returns it, otherwise it
returns an empty hash.</p>

<p>Let&#39;s see for example the definition of the <code>caches_action</code>
controller macro:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">caches_action</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">actions</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cache_configured?</span>
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">actions</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-operator">...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This method receives an arbitrary number of action names, and an optional
hash of options as last argument. With the call to
<code>extract_options!</code> you obtain the options hash and remove it
from <code>actions</code> in a simple and explicit way.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/array/extract_options.rb</code>.</p>

<h3 id="label-Conversions">Conversions<span><a href="#label-Conversions">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-to_sentence"><code>to_sentence</code><span><a href="#label-to_sentence">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>to_sentence</code> turns an array into a string containing
a sentence that enumerates its items:</p>

<pre class="ruby"><span class="ruby-node">%w()</span>.<span class="ruby-identifier">to_sentence</span>                <span class="ruby-comment"># =&gt; &quot;&quot;</span>
<span class="ruby-node">%w(Earth)</span>.<span class="ruby-identifier">to_sentence</span>           <span class="ruby-comment"># =&gt; &quot;Earth&quot;</span>
<span class="ruby-node">%w(Earth Wind)</span>.<span class="ruby-identifier">to_sentence</span>      <span class="ruby-comment"># =&gt; &quot;Earth and Wind&quot;</span>
<span class="ruby-node">%w(Earth Wind Fire)</span>.<span class="ruby-identifier">to_sentence</span> <span class="ruby-comment"># =&gt; &quot;Earth, Wind, and Fire&quot;</span>
</pre>

<p>This method accepts three options:</p>
<ul><li>
<p><code>:two_words_connector</code>: What is used for arrays of length 2.
Default is “ and ”.</p>
</li><li>
<p><code>:words_connector</code>: What is used to join the elements of arrays
with 3 or more elements, except for the last two. Default is “, ”.</p>
</li><li>
<p><code>:last_word_connector</code>: What is used to join the last items of
an array with 3 or more elements. Default is “, and ”.</p>
</li></ul>

<p>The defaults for these options can be localized, their keys are:</p>

<p>| Option | I18n key | | ———————- | ———————————– | |
<code>:two_words_connector</code> |
<code>support.array.two_words_connector</code> | |
<code>:words_connector</code> | <code>support.array.words_connector</code>
| | <code>:last_word_connector</code> |
<code>support.array.last_word_connector</code> |</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p>

<h4 id="label-to_formatted_s"><code>to_formatted_s</code><span><a href="#label-to_formatted_s">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>to_formatted_s</code> acts like <code>to_s</code> by
default.</p>

<p>If the array contains items that respond to <code>id</code>, however, the
symbol <code>:db</code> may be passed as argument. That&#39;s typically
used with collections of Active Record objects. Returned strings are:</p>

<pre class="ruby">[].<span class="ruby-identifier">to_formatted_s</span>(:<span class="ruby-identifier">db</span>)            <span class="ruby-comment"># =&gt; &quot;null&quot;</span>
[<span class="ruby-identifier">user</span>].<span class="ruby-identifier">to_formatted_s</span>(:<span class="ruby-identifier">db</span>)        <span class="ruby-comment"># =&gt; &quot;8456&quot;</span>
<span class="ruby-identifier">invoice</span>.<span class="ruby-identifier">lines</span>.<span class="ruby-identifier">to_formatted_s</span>(:<span class="ruby-identifier">db</span>) <span class="ruby-comment"># =&gt; &quot;23,567,556,12&quot;</span>
</pre>

<p>Integers in the example above are supposed to come from the respective
calls to <code>id</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p>

<h4 id="label-to_xml"><code>to_xml</code><span><a href="#label-to_xml">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>to_xml</code> returns a string containing an XML
representation of its receiver:</p>

<pre class="ruby"><span class="ruby-constant">Contributor</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">rank</span>).<span class="ruby-identifier">to_xml</span>
<span class="ruby-comment"># =&gt;</span>
<span class="ruby-comment"># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="ruby-comment"># &lt;contributors type=&quot;array&quot;&gt;</span>
<span class="ruby-comment">#   &lt;contributor&gt;</span>
<span class="ruby-comment">#     &lt;id type=&quot;integer&quot;&gt;4356&lt;/id&gt;</span>
<span class="ruby-comment">#     &lt;name&gt;Jeremy Kemper&lt;/name&gt;</span>
<span class="ruby-comment">#     &lt;rank type=&quot;integer&quot;&gt;1&lt;/rank&gt;</span>
<span class="ruby-comment">#     &lt;url-id&gt;jeremy-kemper&lt;/url-id&gt;</span>
<span class="ruby-comment">#   &lt;/contributor&gt;</span>
<span class="ruby-comment">#   &lt;contributor&gt;</span>
<span class="ruby-comment">#     &lt;id type=&quot;integer&quot;&gt;4404&lt;/id&gt;</span>
<span class="ruby-comment">#     &lt;name&gt;David Heinemeier Hansson&lt;/name&gt;</span>
<span class="ruby-comment">#     &lt;rank type=&quot;integer&quot;&gt;2&lt;/rank&gt;</span>
<span class="ruby-comment">#     &lt;url-id&gt;david-heinemeier-hansson&lt;/url-id&gt;</span>
<span class="ruby-comment">#   &lt;/contributor&gt;</span>
<span class="ruby-comment"># &lt;/contributors&gt;</span>
</pre>

<p>To do so it sends <code>to_xml</code> to every item in turn, and collects
the results under a root node. All items must respond to
<code>to_xml</code>, an exception is raised otherwise.</p>

<p>By default, the name of the root element is the underscorized and
dasherized plural of the name of the class of the first item, provided the
rest of elements belong to that type (checked with <code>is_a?</code>) and
they are not hashes. In the example above that&#39;s “contributors”.</p>

<p>If there&#39;s any element that does not belong to the type of the first
one the root node becomes “objects”:</p>

<pre class="ruby">[<span class="ruby-constant">Contributor</span>.<span class="ruby-identifier">first</span>, <span class="ruby-constant">Commit</span>.<span class="ruby-identifier">first</span>].<span class="ruby-identifier">to_xml</span>
<span class="ruby-comment"># =&gt;</span>
<span class="ruby-comment"># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="ruby-comment"># &lt;objects type=&quot;array&quot;&gt;</span>
<span class="ruby-comment">#   &lt;object&gt;</span>
<span class="ruby-comment">#     &lt;id type=&quot;integer&quot;&gt;4583&lt;/id&gt;</span>
<span class="ruby-comment">#     &lt;name&gt;Aaron Batalion&lt;/name&gt;</span>
<span class="ruby-comment">#     &lt;rank type=&quot;integer&quot;&gt;53&lt;/rank&gt;</span>
<span class="ruby-comment">#     &lt;url-id&gt;aaron-batalion&lt;/url-id&gt;</span>
<span class="ruby-comment">#   &lt;/object&gt;</span>
<span class="ruby-comment">#   &lt;object&gt;</span>
<span class="ruby-comment">#     &lt;author&gt;Joshua Peek&lt;/author&gt;</span>
<span class="ruby-comment">#     &lt;authored-timestamp type=&quot;datetime&quot;&gt;2009-09-02T16:44:36Z&lt;/authored-timestamp&gt;</span>
<span class="ruby-comment">#     &lt;branch&gt;origin/master&lt;/branch&gt;</span>
<span class="ruby-comment">#     &lt;committed-timestamp type=&quot;datetime&quot;&gt;2009-09-02T16:44:36Z&lt;/committed-timestamp&gt;</span>
<span class="ruby-comment">#     &lt;committer&gt;Joshua Peek&lt;/committer&gt;</span>
<span class="ruby-comment">#     &lt;git-show nil=&quot;true&quot;&gt;&lt;/git-show&gt;</span>
<span class="ruby-comment">#     &lt;id type=&quot;integer&quot;&gt;190316&lt;/id&gt;</span>
<span class="ruby-comment">#     &lt;imported-from-svn type=&quot;boolean&quot;&gt;false&lt;/imported-from-svn&gt;</span>
<span class="ruby-comment">#     &lt;message&gt;Kill AMo observing wrap_with_notifications since ARes was only using it&lt;/message&gt;</span>
<span class="ruby-comment">#     &lt;sha1&gt;723a47bfb3708f968821bc969a9a3fc873a3ed58&lt;/sha1&gt;</span>
<span class="ruby-comment">#   &lt;/object&gt;</span>
<span class="ruby-comment"># &lt;/objects&gt;</span>
</pre>

<p>If the receiver is an array of hashes the root element is by default also
“objects”:</p>

<pre class="ruby">[{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}, {<span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>}].<span class="ruby-identifier">to_xml</span>
<span class="ruby-comment"># =&gt;</span>
<span class="ruby-comment"># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="ruby-comment"># &lt;objects type=&quot;array&quot;&gt;</span>
<span class="ruby-comment">#   &lt;object&gt;</span>
<span class="ruby-comment">#     &lt;b type=&quot;integer&quot;&gt;2&lt;/b&gt;</span>
<span class="ruby-comment">#     &lt;a type=&quot;integer&quot;&gt;1&lt;/a&gt;</span>
<span class="ruby-comment">#   &lt;/object&gt;</span>
<span class="ruby-comment">#   &lt;object&gt;</span>
<span class="ruby-comment">#     &lt;c type=&quot;integer&quot;&gt;3&lt;/c&gt;</span>
<span class="ruby-comment">#   &lt;/object&gt;</span>
<span class="ruby-comment"># &lt;/objects&gt;</span>
</pre>

<p>WARNING. If the collection is empty the root element is by default
“nil-classes”. That&#39;s a gotcha, for example the root element of the
list of contributors above would not be “contributors” if the collection
was empty, but “nil-classes”. You may use the <code>:root</code> option to
ensure a consistent root element.</p>

<p>The name of children nodes is by default the name of the root node
singularized. In the examples above we&#39;ve seen “contributor” and
“object”. The option <code>:children</code> allows you to set these node
names.</p>

<p>The default XML builder is a fresh instance of
<code>Builder::XmlMarkup</code>. You can configure your own builder via the
<code>:builder</code> option. The method also accepts options like
<code>:dasherize</code> and friends, they are forwarded to the builder:</p>

<pre class="ruby"><span class="ruby-constant">Contributor</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">rank</span>).<span class="ruby-identifier">to_xml</span>(<span class="ruby-identifier">skip_types</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
<span class="ruby-comment"># =&gt;</span>
<span class="ruby-comment"># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="ruby-comment"># &lt;contributors&gt;</span>
<span class="ruby-comment">#   &lt;contributor&gt;</span>
<span class="ruby-comment">#     &lt;id&gt;4356&lt;/id&gt;</span>
<span class="ruby-comment">#     &lt;name&gt;Jeremy Kemper&lt;/name&gt;</span>
<span class="ruby-comment">#     &lt;rank&gt;1&lt;/rank&gt;</span>
<span class="ruby-comment">#     &lt;url-id&gt;jeremy-kemper&lt;/url-id&gt;</span>
<span class="ruby-comment">#   &lt;/contributor&gt;</span>
<span class="ruby-comment">#   &lt;contributor&gt;</span>
<span class="ruby-comment">#     &lt;id&gt;4404&lt;/id&gt;</span>
<span class="ruby-comment">#     &lt;name&gt;David Heinemeier Hansson&lt;/name&gt;</span>
<span class="ruby-comment">#     &lt;rank&gt;2&lt;/rank&gt;</span>
<span class="ruby-comment">#     &lt;url-id&gt;david-heinemeier-hansson&lt;/url-id&gt;</span>
<span class="ruby-comment">#   &lt;/contributor&gt;</span>
<span class="ruby-comment"># &lt;/contributors&gt;</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p>

<h3 id="label-Wrapping">Wrapping<span><a href="#label-Wrapping">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>Array.wrap</code> wraps its argument in an array unless it
is already an array (or array-like).</p>

<p>Specifically:</p>
<ul><li>
<p>If the argument is <code>nil</code> an empty list is returned.</p>
</li><li>
<p>Otherwise, if the argument responds to <code>to_ary</code> it is invoked,
and if the value of <code>to_ary</code> is not <code>nil</code>, it is
returned.</p>
</li><li>
<p>Otherwise, an array with the argument as its single element is returned.</p>
</li></ul>

<pre class="ruby"><span class="ruby-constant">Array</span>.<span class="ruby-identifier">wrap</span>(<span class="ruby-keyword">nil</span>)       <span class="ruby-comment"># =&gt; []</span>
<span class="ruby-constant">Array</span>.<span class="ruby-identifier">wrap</span>([<span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>]) <span class="ruby-comment"># =&gt; [1, 2, 3]</span>
<span class="ruby-constant">Array</span>.<span class="ruby-identifier">wrap</span>(<span class="ruby-value">0</span>)         <span class="ruby-comment"># =&gt; [0]</span>
</pre>

<p>This method is similar in purpose to <code>Kernel#Array</code>, but there
are some differences:</p>
<ul><li>
<p>If the argument responds to <code>to_ary</code> the method is invoked.
<code>Kernel#Array</code> moves on to try <code>to_a</code> if the returned
value is <code>nil</code>, but <code>Array.wrap</code> returns
<code>nil</code> right away.</p>
</li><li>
<p>If the returned value from <code>to_ary</code> is neither <code>nil</code>
nor an <code>Array</code> object, <code>Kernel#Array</code> raises an
exception, while <code>Array.wrap</code> does not, it just returns the
value.</p>
</li><li>
<p>It does not call <code>to_a</code> on the argument, though special-cases
<code>nil</code> to return an empty array.</p>
</li></ul>

<p>The last point is particularly worth comparing for some enumerables:</p>

<pre class="ruby"><span class="ruby-constant">Array</span>.<span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">foo</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">bar</span>) <span class="ruby-comment"># =&gt; [{:foo=&gt;:bar}]</span>
<span class="ruby-constant">Array</span>(<span class="ruby-identifier">foo</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">bar</span>)      <span class="ruby-comment"># =&gt; [[:foo, :bar]]</span>
</pre>

<p>There&#39;s also a related idiom that uses the splat operator:</p>

<pre class="ruby">[<span class="ruby-operator">*</span><span class="ruby-identifier">object</span>]
</pre>

<p>which in Ruby 1.8 returns <code>[nil]</code> for <code>nil</code>, and
calls to <code>Array(object)</code> otherwise. (Please if you know the
exact behavior in 1.9 contact fxn.)</p>

<p>Thus, in this case the behavior is different for <code>nil</code>, and the
differences with <code>Kernel#Array</code> explained above apply to the
rest of <code>object</code>s.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/wrap.rb</code>.</p>

<h3 id="label-Duplicating">Duplicating<span><a href="#label-Duplicating">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>Array.deep_dup</code> duplicates itself and all objects
inside recursively with Active Support method <code>Object#deep_dup</code>.
It works like <code>Array#map</code> with sending <code>deep_dup</code>
method to each object inside.</p>

<pre class="ruby"><span class="ruby-identifier">array</span> = [<span class="ruby-value">1</span>, [<span class="ruby-value">2</span>, <span class="ruby-value">3</span>]]
<span class="ruby-identifier">dup</span> = <span class="ruby-identifier">array</span>.<span class="ruby-identifier">deep_dup</span>
<span class="ruby-identifier">dup</span>[<span class="ruby-value">1</span>][<span class="ruby-value">2</span>] = <span class="ruby-value">4</span>
<span class="ruby-identifier">array</span>[<span class="ruby-value">1</span>][<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>   <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p>

<h3 id="label-Grouping">Grouping<span><a href="#label-Grouping">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-in_groups_of-28number-2C+fill_with+-3D+nil-29"><code>in_groups_of(number, fill_with = nil)</code><span><a href="#label-in_groups_of-28number-2C+fill_with+-3D+nil-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>in_groups_of</code> splits an array into consecutive
groups of a certain size. It returns an array with the groups:</p>

<pre class="ruby">[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>].<span class="ruby-identifier">in_groups_of</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; [[1, 2], [3, nil]]</span>
</pre>

<p>or yields them in turn if a block is passed:</p>

<pre>&lt;% sample.in_groups_of(3) do |a, b, c| %&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;%= a %&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%= b %&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%= c %&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;% end %&gt;</pre>

<p>The first example shows <code>in_groups_of</code> fills the last group with
as many <code>nil</code> elements as needed to have the requested size. You
can change this padding value using the second optional argument:</p>

<pre class="ruby">[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>].<span class="ruby-identifier">in_groups_of</span>(<span class="ruby-value">2</span>, <span class="ruby-value">0</span>) <span class="ruby-comment"># =&gt; [[1, 2], [3, 0]]</span>
</pre>

<p>And you can tell the method not to fill the last group passing
<code>false</code>:</p>

<pre class="ruby">[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>].<span class="ruby-identifier">in_groups_of</span>(<span class="ruby-value">2</span>, <span class="ruby-keyword">false</span>) <span class="ruby-comment"># =&gt; [[1, 2], [3]]</span>
</pre>

<p>As a consequence <code>false</code> can&#39;t be a used as a padding value.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p>

<h4 id="label-in_groups-28number-2C+fill_with+-3D+nil-29"><code>in_groups(number, fill_with = nil)</code><span><a href="#label-in_groups-28number-2C+fill_with+-3D+nil-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>in_groups</code> splits an array into a certain number of
groups. The method returns an array with the groups:</p>

<pre class="ruby"><span class="ruby-node">%w(1 2 3 4 5 6 7)</span>.<span class="ruby-identifier">in_groups</span>(<span class="ruby-value">3</span>)
<span class="ruby-comment"># =&gt; [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], [&quot;4&quot;, &quot;5&quot;, nil], [&quot;6&quot;, &quot;7&quot;, nil]]</span>
</pre>

<p>or yields them in turn if a block is passed:</p>

<pre class="ruby"><span class="ruby-node">%w(1 2 3 4 5 6 7)</span>.<span class="ruby-identifier">in_groups</span>(<span class="ruby-value">3</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">group</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">group</span>}
[<span class="ruby-string">&quot;1&quot;</span>, <span class="ruby-string">&quot;2&quot;</span>, <span class="ruby-string">&quot;3&quot;</span>]
[<span class="ruby-string">&quot;4&quot;</span>, <span class="ruby-string">&quot;5&quot;</span>, <span class="ruby-keyword">nil</span>]
[<span class="ruby-string">&quot;6&quot;</span>, <span class="ruby-string">&quot;7&quot;</span>, <span class="ruby-keyword">nil</span>]
</pre>

<p>The examples above show that <code>in_groups</code> fills some groups with
a trailing <code>nil</code> element as needed. A group can get at most one
of these extra elements, the rightmost one if any. And the groups that have
them are always the last ones.</p>

<p>You can change this padding value using the second optional argument:</p>

<pre class="ruby"><span class="ruby-node">%w(1 2 3 4 5 6 7)</span>.<span class="ruby-identifier">in_groups</span>(<span class="ruby-value">3</span>, <span class="ruby-string">&quot;0&quot;</span>)
<span class="ruby-comment"># =&gt; [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], [&quot;4&quot;, &quot;5&quot;, &quot;0&quot;], [&quot;6&quot;, &quot;7&quot;, &quot;0&quot;]]</span>
</pre>

<p>And you can tell the method not to fill the smaller groups passing
<code>false</code>:</p>

<pre class="ruby"><span class="ruby-node">%w(1 2 3 4 5 6 7)</span>.<span class="ruby-identifier">in_groups</span>(<span class="ruby-value">3</span>, <span class="ruby-keyword">false</span>)
<span class="ruby-comment"># =&gt; [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], [&quot;4&quot;, &quot;5&quot;], [&quot;6&quot;, &quot;7&quot;]]</span>
</pre>

<p>As a consequence <code>false</code> can&#39;t be a used as a padding value.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p>

<h4 id="label-split-28value+-3D+nil-29"><code>split(value = nil)</code><span><a href="#label-split-28value+-3D+nil-29">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>split</code> divides an array by a separator and returns
the resulting chunks.</p>

<p>If a block is passed the separators are those elements of the array for
which the block returns true:</p>

<pre class="ruby">(<span class="ruby-value">-5</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>).<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">split</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">multiple_of?</span>(<span class="ruby-value">4</span>) }
<span class="ruby-comment"># =&gt; [[-5], [-3, -2, -1], [1, 2, 3], [5]]</span>
</pre>

<p>Otherwise, the value received as argument, which defaults to
<code>nil</code>, is the separator:</p>

<pre class="ruby">[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>, <span class="ruby-value">-5</span>, <span class="ruby-value">1</span>, <span class="ruby-value">1</span>, <span class="ruby-string">&quot;foo&quot;</span>, <span class="ruby-string">&quot;bar&quot;</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; [[0], [-5], [], [&quot;foo&quot;, &quot;bar&quot;]]</span>
</pre>

<p>TIP: Observe in the previous example that consecutive separators result in
empty arrays.</p>

<p>NOTE: Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p>

<h2 id="label-Extensions+to+Hash">Extensions to <code>Hash</code><span><a href="#label-Extensions+to+Hash">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Conversions">Conversions<span><a href="#label-Conversions">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-to_xml"><code>to_xml</code><span><a href="#label-to_xml">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>to_xml</code> returns a string containing an XML
representation of its receiver:</p>

<pre class="ruby">{<span class="ruby-string">&quot;foo&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-string">&quot;bar&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">2</span>}.<span class="ruby-identifier">to_xml</span>
<span class="ruby-comment"># =&gt;</span>
<span class="ruby-comment"># &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="ruby-comment"># &lt;hash&gt;</span>
<span class="ruby-comment">#   &lt;foo type=&quot;integer&quot;&gt;1&lt;/foo&gt;</span>
<span class="ruby-comment">#   &lt;bar type=&quot;integer&quot;&gt;2&lt;/bar&gt;</span>
<span class="ruby-comment"># &lt;/hash&gt;</span>
</pre>

<p>To do so, the method loops over the pairs and builds nodes that depend on
the <em>values</em>. Given a pair <code>key</code>, <code>value</code>:</p>
<ul><li>
<p>If <code>value</code> is a hash there&#39;s a recursive call with
<code>key</code> as <code>:root</code>.</p>
</li><li>
<p>If <code>value</code> is an array there&#39;s a recursive call with
<code>key</code> as <code>:root</code>, and <code>key</code> singularized
as <code>:children</code>.</p>
</li><li>
<p>If <code>value</code> is a callable object it must expect one or two
arguments. Depending on the arity, the callable is invoked with the
<code>options</code> hash as first argument with <code>key</code> as
<code>:root</code>, and <code>key</code> singularized as second argument.
Its return value becomes a new node.</p>
</li><li>
<p>If <code>value</code> responds to <code>to_xml</code> the method is invoked
with <code>key</code> as <code>:root</code>.</p>
</li><li>
<p>Otherwise, a node with <code>key</code> as tag is created with a string
representation of <code>value</code> as text node. If <code>value</code> is
<code>nil</code> an attribute “nil” set to “true” is added. Unless the
option <code>:skip_types</code> exists and is true, an attribute “type” is
added as well according to the following mapping:</p>
</li></ul>

<pre class="ruby"><span class="ruby-constant">XML_TYPE_NAMES</span> = {
  <span class="ruby-string">&quot;Symbol&quot;</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;symbol&quot;</span>,
  <span class="ruby-string">&quot;Fixnum&quot;</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;integer&quot;</span>,
  <span class="ruby-string">&quot;Bignum&quot;</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;integer&quot;</span>,
  <span class="ruby-string">&quot;BigDecimal&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;decimal&quot;</span>,
  <span class="ruby-string">&quot;Float&quot;</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;float&quot;</span>,
  <span class="ruby-string">&quot;TrueClass&quot;</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;boolean&quot;</span>,
  <span class="ruby-string">&quot;FalseClass&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;boolean&quot;</span>,
  <span class="ruby-string">&quot;Date&quot;</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;date&quot;</span>,
  <span class="ruby-string">&quot;DateTime&quot;</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;datetime&quot;</span>,
  <span class="ruby-string">&quot;Time&quot;</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;datetime&quot;</span>
}
</pre>

<p>By default the root node is “hash”, but that&#39;s configurable via the
<code>:root</code> option.</p>

<p>The default XML builder is a fresh instance of
<code>Builder::XmlMarkup</code>. You can configure your own builder with
the <code>:builder</code> option. The method also accepts options like
<code>:dasherize</code> and friends, they are forwarded to the builder.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/conversions.rb</code>.</p>

<h3 id="label-Merging">Merging<span><a href="#label-Merging">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Ruby has a built-in method <code>Hash#merge</code> that merges two hashes:</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
<span class="ruby-comment"># =&gt; {:a=&gt;0, :b=&gt;1, :c=&gt;2}</span>
</pre>

<p>Active Support defines a few more ways of merging hashes that may be
convenient.</p>

<h4 id="label-reverse_merge+and+reverse_merge-21"><code>reverse_merge</code> and <code>reverse_merge!</code><span><a href="#label-reverse_merge+and+reverse_merge-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>In case of collision the key in the hash of the argument wins in
<code>merge</code>. You can support option hashes with default values in a
compact way with this idiom:</p>

<pre class="ruby"><span class="ruby-identifier">options</span> = {<span class="ruby-identifier">length</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>, <span class="ruby-identifier">omission</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;...&quot;</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
</pre>

<p>Active Support defines <code>reverse_merge</code> in case you prefer this
alternative notation:</p>

<pre class="ruby"><span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reverse_merge</span>(<span class="ruby-identifier">length</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>, <span class="ruby-identifier">omission</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;...&quot;</span>)
</pre>

<p>And a bang version <code>reverse_merge!</code> that performs the merge in
place:</p>

<pre class="ruby"><span class="ruby-identifier">options</span>.<span class="ruby-identifier">reverse_merge!</span>(<span class="ruby-identifier">length</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>, <span class="ruby-identifier">omission</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;...&quot;</span>)
</pre>

<p>WARNING. Take into account that <code>reverse_merge!</code> may change the
hash in the caller, which may or may not be a good idea.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/hash/reverse_merge.rb</code>.</p>

<h4 id="label-reverse_update"><code>reverse_update</code><span><a href="#label-reverse_update">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>reverse_update</code> is an alias for
<code>reverse_merge!</code>, explained above.</p>

<p>WARNING. Note that <code>reverse_update</code> has no bang.</p>

<p>NOTE: Defined in
<code>active_support/core_ext/hash/reverse_merge.rb</code>.</p>

<h4 id="label-deep_merge+and+deep_merge-21"><code>deep_merge</code> and <code>deep_merge!</code><span><a href="#label-deep_merge+and+deep_merge-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>As you can see in the previous example if a key is found in both hashes the
value in the one in the argument wins.</p>

<p>Active Support defines <code>Hash#deep_merge</code>. In a deep merge, if a
key is found in both hashes and their values are hashes in turn, then their
<em>merge</em> becomes the value in the resulting hash:</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}}.<span class="ruby-identifier">deep_merge</span>(<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>})
<span class="ruby-comment"># =&gt; {:a=&gt;{:b=&gt;1, :c=&gt;2}}</span>
</pre>

<p>The method <code>deep_merge!</code> performs a deep merge in place.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/deep_merge.rb</code>.</p>

<h3 id="label-Deep+duplicating">Deep duplicating<span><a href="#label-Deep+duplicating">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>Hash.deep_dup</code> duplicates itself and all keys and
values inside recursively with Active Support method
<code>Object#deep_dup</code>. It works like
<code>Enumerator#each_with_object</code> with sending <code>deep_dup</code>
method to each pair inside.</p>

<pre class="ruby"><span class="ruby-identifier">hash</span> = { <span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">d</span><span class="ruby-operator">:</span> [<span class="ruby-value">3</span>, <span class="ruby-value">4</span>] } }

<span class="ruby-identifier">dup</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">deep_dup</span>
<span class="ruby-identifier">dup</span>[:<span class="ruby-identifier">b</span>][:<span class="ruby-identifier">e</span>] = <span class="ruby-value">5</span>
<span class="ruby-identifier">dup</span>[:<span class="ruby-identifier">b</span>][:<span class="ruby-identifier">d</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">5</span>

<span class="ruby-identifier">hash</span>[:<span class="ruby-identifier">b</span>][:<span class="ruby-identifier">e</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>      <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">hash</span>[:<span class="ruby-identifier">b</span>][:<span class="ruby-identifier">d</span>] <span class="ruby-operator">==</span> [<span class="ruby-value">3</span>, <span class="ruby-value">4</span>]   <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p>

<h3 id="label-Working+with+Keys">Working with Keys<span><a href="#label-Working+with+Keys">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-except+and+except-21"><code>except</code> and <code>except!</code><span><a href="#label-except+and+except-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>except</code> returns a hash with the keys in the argument
list removed, if present:</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}.<span class="ruby-identifier">except</span>(:<span class="ruby-identifier">a</span>) <span class="ruby-comment"># =&gt; {:b=&gt;2}</span>
</pre>

<p>If the receiver responds to <code>convert_key</code>, the method is called
on each of the arguments. This allows <code>except</code> to play nice with
hashes with indifferent access for instance:</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}.<span class="ruby-identifier">with_indifferent_access</span>.<span class="ruby-identifier">except</span>(:<span class="ruby-identifier">a</span>)  <span class="ruby-comment"># =&gt; {}</span>
{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}.<span class="ruby-identifier">with_indifferent_access</span>.<span class="ruby-identifier">except</span>(<span class="ruby-string">&quot;a&quot;</span>) <span class="ruby-comment"># =&gt; {}</span>
</pre>

<p>There&#39;s also the bang variant <code>except!</code> that removes keys in
the very receiver.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/except.rb</code>.</p>

<h4 id="label-transform_keys+and+transform_keys-21"><code>transform_keys</code> and <code>transform_keys!</code><span><a href="#label-transform_keys+and+transform_keys-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>transform_keys</code> accepts a block and returns a hash
that has applied the block operations to each of the keys in the receiver:</p>

<pre class="ruby">{<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">a</span>}.<span class="ruby-identifier">transform_keys</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span> }
<span class="ruby-comment"># =&gt; {&quot;&quot; =&gt; nil, &quot;A&quot; =&gt; :a, &quot;1&quot; =&gt; 1}</span>
</pre>

<p>In case of key collision, one of the values will be chosen. The chosen
value may not always be the same given the same hash:</p>

<pre class="ruby">{<span class="ruby-string">&quot;a&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}.<span class="ruby-identifier">transform_keys</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span> }
<span class="ruby-comment"># The result could either be</span>
<span class="ruby-comment"># =&gt; {&quot;A&quot;=&gt;2}</span>
<span class="ruby-comment"># or</span>
<span class="ruby-comment"># =&gt; {&quot;A&quot;=&gt;1}</span>
</pre>

<p>This method may be useful for example to build specialized conversions. For
instance <code>stringify_keys</code> and <code>symbolize_keys</code> use
<code>transform_keys</code> to perform their key conversions:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">stringify_keys</span>
  <span class="ruby-identifier">transform_keys</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> }
<span class="ruby-keyword">end</span>
<span class="ruby-operator">...</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">symbolize_keys</span>
  <span class="ruby-identifier">transform_keys</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-keyword">rescue</span> <span class="ruby-identifier">key</span> }
<span class="ruby-keyword">end</span>
</pre>

<p>There&#39;s also the bang variant <code>transform_keys!</code> that applies
the block operations to keys in the very receiver.</p>

<p>Besides that, one can use <code>deep_transform_keys</code> and
<code>deep_transform_keys!</code> to perform the block operation on all the
keys in the given hash and all the hashes nested into it. An example of the
result is:</p>

<pre class="ruby">{<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">nested</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>, <span class="ruby-value">5</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>}}.<span class="ruby-identifier">deep_transform_keys</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span> }
<span class="ruby-comment"># =&gt; {&quot;&quot;=&gt;nil, &quot;1&quot;=&gt;1, &quot;NESTED&quot;=&gt;{&quot;A&quot;=&gt;3, &quot;5&quot;=&gt;5}}</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h4 id="label-stringify_keys+and+stringify_keys-21"><code>stringify_keys</code> and <code>stringify_keys!</code><span><a href="#label-stringify_keys+and+stringify_keys-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>stringify_keys</code> returns a hash that has a
stringified version of the keys in the receiver. It does so by sending
<code>to_s</code> to them:</p>

<pre class="ruby">{<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">a</span>}.<span class="ruby-identifier">stringify_keys</span>
<span class="ruby-comment"># =&gt; {&quot;&quot; =&gt; nil, &quot;a&quot; =&gt; :a, &quot;1&quot; =&gt; 1}</span>
</pre>

<p>In case of key collision, one of the values will be chosen. The chosen
value may not always be the same given the same hash:</p>

<pre class="ruby">{<span class="ruby-string">&quot;a&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}.<span class="ruby-identifier">stringify_keys</span>
<span class="ruby-comment"># The result could either be</span>
<span class="ruby-comment"># =&gt; {&quot;a&quot;=&gt;2}</span>
<span class="ruby-comment"># or</span>
<span class="ruby-comment"># =&gt; {&quot;a&quot;=&gt;1}</span>
</pre>

<p>This method may be useful for example to easily accept both symbols and
strings as options. For instance
<code>ActionView::Helpers::FormHelper</code> defines:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">to_check_box_tag</span>(<span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">checked_value</span> = <span class="ruby-string">&quot;1&quot;</span>, <span class="ruby-identifier">unchecked_value</span> = <span class="ruby-string">&quot;0&quot;</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">stringify_keys</span>
  <span class="ruby-identifier">options</span>[<span class="ruby-string">&quot;type&quot;</span>] = <span class="ruby-string">&quot;checkbox&quot;</span>
  <span class="ruby-operator">...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The second line can safely access the “type” key, and let the user to pass
either <code>:type</code> or “type”.</p>

<p>There&#39;s also the bang variant <code>stringify_keys!</code> that
stringifies keys in the very receiver.</p>

<p>Besides that, one can use <code>deep_stringify_keys</code> and
<code>deep_stringify_keys!</code> to stringify all the keys in the given
hash and all the hashes nested into it. An example of the result is:</p>

<pre class="ruby">{<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">nested</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>, <span class="ruby-value">5</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>}}.<span class="ruby-identifier">deep_stringify_keys</span>
<span class="ruby-comment"># =&gt; {&quot;&quot;=&gt;nil, &quot;1&quot;=&gt;1, &quot;nested&quot;=&gt;{&quot;a&quot;=&gt;3, &quot;5&quot;=&gt;5}}</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h4 id="label-symbolize_keys+and+symbolize_keys-21"><code>symbolize_keys</code> and <code>symbolize_keys!</code><span><a href="#label-symbolize_keys+and+symbolize_keys-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>symbolize_keys</code> returns a hash that has a symbolized
version of the keys in the receiver, where possible. It does so by sending
<code>to_sym</code> to them:</p>

<pre class="ruby">{<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-string">&quot;a&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;a&quot;</span>}.<span class="ruby-identifier">symbolize_keys</span>
<span class="ruby-comment"># =&gt; {1=&gt;1, nil=&gt;nil, :a=&gt;&quot;a&quot;}</span>
</pre>

<p>WARNING. Note in the previous example only one key was symbolized.</p>

<p>In case of key collision, one of the values will be chosen. The chosen
value may not always be the same given the same hash:</p>

<pre class="ruby">{<span class="ruby-string">&quot;a&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}.<span class="ruby-identifier">symbolize_keys</span>
<span class="ruby-comment"># The result could either be</span>
<span class="ruby-comment"># =&gt; {:a=&gt;2}</span>
<span class="ruby-comment"># or</span>
<span class="ruby-comment"># =&gt; {:a=&gt;1}</span>
</pre>

<p>This method may be useful for example to easily accept both symbols and
strings as options. For instance <code>ActionController::UrlRewriter</code>
defines</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">rewrite_path</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">symbolize_keys</span>
  <span class="ruby-identifier">options</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">options</span>[:<span class="ruby-identifier">params</span>].<span class="ruby-identifier">symbolize_keys</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[:<span class="ruby-identifier">params</span>]
  <span class="ruby-operator">...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The second line can safely access the <code>:params</code> key, and let the
user to pass either <code>:params</code> or “params”.</p>

<p>There&#39;s also the bang variant <code>symbolize_keys!</code> that
symbolizes keys in the very receiver.</p>

<p>Besides that, one can use <code>deep_symbolize_keys</code> and
<code>deep_symbolize_keys!</code> to symbolize all the keys in the given
hash and all the hashes nested into it. An example of the result is:</p>

<pre class="ruby">{<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, <span class="ruby-string">&quot;nested&quot;</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-string">&quot;a&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">3</span>, <span class="ruby-value">5</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>}}.<span class="ruby-identifier">deep_symbolize_keys</span>
<span class="ruby-comment"># =&gt; {nil=&gt;nil, 1=&gt;1, nested:{a:3, 5=&gt;5}}</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h4 id="label-to_options+and+to_options-21"><code>to_options</code> and <code>to_options!</code><span><a href="#label-to_options+and+to_options-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The methods <code>to_options</code> and <code>to_options!</code> are
respectively aliases of <code>symbolize_keys</code> and
<code>symbolize_keys!</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h4 id="label-assert_valid_keys"><code>assert_valid_keys</code><span><a href="#label-assert_valid_keys">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>assert_valid_keys</code> receives an arbitrary number of
arguments, and checks whether the receiver has any key outside that white
list. If it does <code>ArgumentError</code> is raised.</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}.<span class="ruby-identifier">assert_valid_keys</span>(:<span class="ruby-identifier">a</span>)  <span class="ruby-comment"># passes</span>
{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}.<span class="ruby-identifier">assert_valid_keys</span>(<span class="ruby-string">&quot;a&quot;</span>) <span class="ruby-comment"># ArgumentError</span>
</pre>

<p>Active Record does not accept unknown options when building associations,
for example. It implements that control via <code>assert_valid_keys</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p>

<h3 id="label-Working+with+Values">Working with Values<span><a href="#label-Working+with+Values">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-transform_values+-26-26+transform_values-21"><code>transform_values</code> &amp;&amp; <code>transform_values!</code><span><a href="#label-transform_values+-26-26+transform_values-21">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>transform_values</code> accepts a block and returns a hash
that has applied the block operations to each of the values in the
receiver.</p>

<pre class="ruby">{ <span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>, :<span class="ruby-identifier">x</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">a</span> }.<span class="ruby-identifier">transform_values</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span> }
<span class="ruby-comment"># =&gt; {nil=&gt;&quot;&quot;, 1=&gt;&quot;1&quot;, :x=&gt;&quot;A&quot;}</span>
</pre>

<p>There&#39;s also the bang variant <code>transform_values!</code> that
applies the block operations to values in the very receiver.</p>

<p>NOTE: Defined in
<code>active_support/core_text/hash/transform_values.rb</code>.</p>

<h3 id="label-Slicing">Slicing<span><a href="#label-Slicing">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Ruby has built-in support for taking slices out of strings and arrays.
Active Support extends slicing to hashes:</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>}.<span class="ruby-identifier">slice</span>(:<span class="ruby-identifier">a</span>, :<span class="ruby-identifier">c</span>)
<span class="ruby-comment"># =&gt; {:c=&gt;3, :a=&gt;1}</span>

{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-value">3</span>}.<span class="ruby-identifier">slice</span>(:<span class="ruby-identifier">b</span>, :<span class="ruby-constant">X</span>)
<span class="ruby-comment"># =&gt; {:b=&gt;2} # non-existing keys are ignored</span>
</pre>

<p>If the receiver responds to <code>convert_key</code> keys are normalized:</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}.<span class="ruby-identifier">with_indifferent_access</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-string">&quot;a&quot;</span>)
<span class="ruby-comment"># =&gt; {:a=&gt;1}</span>
</pre>

<p>NOTE. Slicing may come in handy for sanitizing option hashes with a white
list of keys.</p>

<p>There&#39;s also <code>slice!</code> which in addition to perform a slice
in place returns what&#39;s removed:</p>

<pre class="ruby"><span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}
<span class="ruby-identifier">rest</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">slice!</span>(:<span class="ruby-identifier">a</span>) <span class="ruby-comment"># =&gt; {:b=&gt;2}</span>
<span class="ruby-identifier">hash</span>                   <span class="ruby-comment"># =&gt; {:a=&gt;1}</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/slice.rb</code>.</p>

<h3 id="label-Extracting">Extracting<span><a href="#label-Extracting">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>extract!</code> removes and returns the key/value pairs
matching the given keys.</p>

<pre class="ruby"><span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}
<span class="ruby-identifier">rest</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">extract!</span>(:<span class="ruby-identifier">a</span>) <span class="ruby-comment"># =&gt; {:a=&gt;1}</span>
<span class="ruby-identifier">hash</span>                     <span class="ruby-comment"># =&gt; {:b=&gt;2}</span>
</pre>

<p>The method <code>extract!</code> returns the same subclass of Hash, that
the receiver is.</p>

<pre class="ruby"><span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>}.<span class="ruby-identifier">with_indifferent_access</span>
<span class="ruby-identifier">rest</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">extract!</span>(:<span class="ruby-identifier">a</span>).<span class="ruby-identifier">class</span>
<span class="ruby-comment"># =&gt; ActiveSupport::HashWithIndifferentAccess</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/slice.rb</code>.</p>

<h3 id="label-Indifferent+Access">Indifferent Access<span><a href="#label-Indifferent+Access">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>with_indifferent_access</code> returns an
<code>ActiveSupport::HashWithIndifferentAccess</code> out of its receiver:</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}.<span class="ruby-identifier">with_indifferent_access</span>[<span class="ruby-string">&quot;a&quot;</span>] <span class="ruby-comment"># =&gt; 1</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/hash/indifferent_access.rb</code>.</p>

<h3 id="label-Compacting">Compacting<span><a href="#label-Compacting">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The methods <code>compact</code> and <code>compact!</code> return a Hash
without items with <code>nil</code> value.</p>

<pre class="ruby">{<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">c</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>}.<span class="ruby-identifier">compact</span> <span class="ruby-comment"># =&gt; {a: 1, b: 2}</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/hash/compact.rb</code>.</p>

<h2 id="label-Extensions+to+Regexp">Extensions to <code>Regexp</code><span><a href="#label-Extensions+to+Regexp">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-multiline-3F"><code>multiline?</code><span><a href="#label-multiline-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>multiline?</code> says whether a regexp has the
<code>/m</code> flag set, that is, whether the dot matches newlines.</p>

<pre class="ruby"><span class="ruby-regexp">%r{.}</span>.<span class="ruby-identifier">multiline?</span>  <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-regexp">%r{.}m</span>.<span class="ruby-identifier">multiline?</span> <span class="ruby-comment"># =&gt; true</span>

<span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;.&#39;</span>).<span class="ruby-identifier">multiline?</span>                    <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;.&#39;</span>, <span class="ruby-constant">Regexp</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTILINE</span>).<span class="ruby-identifier">multiline?</span> <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>Rails uses this method in a single place, also in the routing code.
Multiline regexps are disallowed for route requirements and this flag eases
enforcing that constraint.</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">assign_route_options</span>(<span class="ruby-identifier">segments</span>, <span class="ruby-identifier">defaults</span>, <span class="ruby-identifier">requirements</span>)
  <span class="ruby-operator">...</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">requirement</span>.<span class="ruby-identifier">multiline?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Regexp multiline option not allowed in routing requirements: #{requirement.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-operator">...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/regexp.rb</code>.</p>

<h2 id="label-Extensions+to+Range">Extensions to <code>Range</code><span><a href="#label-Extensions+to+Range">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-to_s"><code>to_s</code><span><a href="#label-to_s">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Support extends the method <code>Range#to_s</code> so that it
understands an optional format argument. As of this writing the only
supported non-default format is <code>:db</code>:</p>

<pre class="ruby">(<span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span><span class="ruby-operator">..</span><span class="ruby-constant">Date</span>.<span class="ruby-identifier">tomorrow</span>).<span class="ruby-identifier">to_s</span>
<span class="ruby-comment"># =&gt; &quot;2009-10-25..2009-10-26&quot;</span>

(<span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span><span class="ruby-operator">..</span><span class="ruby-constant">Date</span>.<span class="ruby-identifier">tomorrow</span>).<span class="ruby-identifier">to_s</span>(:<span class="ruby-identifier">db</span>)
<span class="ruby-comment"># =&gt; &quot;BETWEEN &#39;2009-10-25&#39; AND &#39;2009-10-26&#39;&quot;</span>
</pre>

<p>As the example depicts, the <code>:db</code> format generates a
<code>BETWEEN</code> SQL clause. That is used by Active Record in its
support for range values in conditions.</p>

<p>NOTE: Defined in <code>active_support/core_ext/range/conversions.rb</code>.</p>

<h3 id="label-include-3F"><code>include?</code><span><a href="#label-include-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The methods <code>Range#include?</code> and <code>Range#===</code> say
whether some value falls between the ends of a given instance:</p>

<pre class="ruby">(<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">3</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-constant">Math</span><span class="ruby-operator">::</span><span class="ruby-constant">E</span>) <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>Active Support extends these methods so that the argument may be another
range in turn. In that case we test whether the ends of the argument range
belong to the receiver themselves:</p>

<pre class="ruby">(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">7</span>)  <span class="ruby-comment"># =&gt; true</span>
(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">7</span>)  <span class="ruby-comment"># =&gt; false</span>
(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">11</span>) <span class="ruby-comment"># =&gt; false</span>
(<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-value">9</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">9</span>)  <span class="ruby-comment"># =&gt; false</span>

(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>) <span class="ruby-operator">===</span> (<span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">7</span>)  <span class="ruby-comment"># =&gt; true</span>
(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>) <span class="ruby-operator">===</span> (<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">7</span>)  <span class="ruby-comment"># =&gt; false</span>
(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>) <span class="ruby-operator">===</span> (<span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">11</span>) <span class="ruby-comment"># =&gt; false</span>
(<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-value">9</span>) <span class="ruby-operator">===</span> (<span class="ruby-value">3</span><span class="ruby-operator">..</span><span class="ruby-value">9</span>)  <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>NOTE: Defined in
<code>active_support/core_ext/range/include_range.rb</code>.</p>

<h3 id="label-overlaps-3F"><code>overlaps?</code><span><a href="#label-overlaps-3F">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The method <code>Range#overlaps?</code> says whether any two given ranges
have non-void intersection:</p>

<pre class="ruby">(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>).<span class="ruby-identifier">overlaps?</span>(<span class="ruby-value">7</span><span class="ruby-operator">..</span><span class="ruby-value">11</span>)  <span class="ruby-comment"># =&gt; true</span>
(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>).<span class="ruby-identifier">overlaps?</span>(<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">7</span>)   <span class="ruby-comment"># =&gt; true</span>
(<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>).<span class="ruby-identifier">overlaps?</span>(<span class="ruby-value">11</span><span class="ruby-operator">..</span><span class="ruby-value">27</span>) <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/range/overlaps.rb</code>.</p>

<h2 id="label-Extensions+to+Proc">Extensions to <code>Proc</code><span><a href="#label-Extensions+to+Proc">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-bind"><code>bind</code><span><a href="#label-bind">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>As you surely know Ruby has an <code>UnboundMethod</code> class whose
instances are methods that belong to the limbo of methods without a self.
The method <code>Module#instance_method</code> returns an unbound method
for example:</p>

<pre class="ruby"><span class="ruby-constant">Hash</span>.<span class="ruby-identifier">instance_method</span>(:<span class="ruby-identifier">delete</span>) <span class="ruby-comment"># =&gt; #&lt;UnboundMethod: Hash#delete&gt;</span>
</pre>

<p>An unbound method is not callable as is, you need to bind it first to an
object with <code>bind</code>:</p>

<pre class="ruby"><span class="ruby-identifier">clear</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">instance_method</span>(:<span class="ruby-identifier">clear</span>)
<span class="ruby-identifier">clear</span>.<span class="ruby-identifier">bind</span>({<span class="ruby-identifier">a</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>}).<span class="ruby-identifier">call</span> <span class="ruby-comment"># =&gt; {}</span>
</pre>

<p>Active Support defines <code>Proc#bind</code> with an analogous purpose:</p>

<pre class="ruby"><span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">size</span> }.<span class="ruby-identifier">bind</span>([]).<span class="ruby-identifier">call</span> <span class="ruby-comment"># =&gt; 0</span>
</pre>

<p>As you see that&#39;s callable and bound to the argument, the return value
is indeed a <code>Method</code>.</p>

<p>NOTE: To do so <code>Proc#bind</code> actually creates a method under the
hood. If you ever see a method with a weird name like
<code>__bind_1256598120_237302</code> in a stack trace you know now where
it comes from.</p>

<p>Action Pack uses this trick in <code>rescue_from</code> for example, which
accepts the name of a method and also a proc as callbacks for a given
rescued exception. It has to call them in either case, so a bound method is
returned by <code>handler_for_rescue</code>, thus simplifying the code in
the caller:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">handler_for_rescue</span>(<span class="ruby-identifier">exception</span>)
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">rescuer</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">rescue_handlers</span>).<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">detect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">klass_name</span>, <span class="ruby-identifier">handler</span><span class="ruby-operator">|</span>
    <span class="ruby-operator">...</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">rescuer</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>
    <span class="ruby-identifier">method</span>(<span class="ruby-identifier">rescuer</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Proc</span>
    <span class="ruby-identifier">rescuer</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/proc.rb</code>.</p>

<h2 id="label-Extensions+to+Date">Extensions to <code>Date</code><span><a href="#label-Extensions+to+Date">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Calculations">Calculations<span><a href="#label-Calculations">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>NOTE: All the following methods are defined in
<code>active_support/core_ext/date/calculations.rb</code>.</p>

<p>INFO: The following calculation methods have edge cases in October 1582,
since days 5..14 just do not exist. This guide does not document their
behavior around those days for brevity, but it is enough to say that they
do what you would expect. That is, <code>Date.new(1582, 10,
4).tomorrow</code> returns <code>Date.new(1582, 10, 15)</code> and so on.
Please check <code>test/core_ext/date_ext_test.rb</code> in the Active
Support test suite for expected behavior.</p>

<h4 id="label-Date.current"><code>Date.current</code><span><a href="#label-Date.current">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Active Support defines <code>Date.current</code> to be today in the current
time zone. That&#39;s like <code>Date.today</code>, except that it honors
the user time zone, if defined. It also defines <code>Date.yesterday</code>
and <code>Date.tomorrow</code>, and the instance predicates
<code>past?</code>, <code>today?</code>, and <code>future?</code>, all of
them relative to <code>Date.current</code>.</p>

<p>When making Date comparisons using methods which honor the user time zone,
make sure to use <code>Date.current</code> and not <code>Date.today</code>.
There are cases where the user time zone might be in the future compared to
the system time zone, which <code>Date.today</code> uses by default. This
means <code>Date.today</code> may equal <code>Date.yesterday</code>.</p>

<h4 id="label-Named+dates">Named dates<span><a href="#label-Named+dates">&para;</a> <a href="#top">&uarr;</a></span></h4>

<h5 id="label-prev_year-2C+next_year"><code>prev_year</code>, <code>next_year</code><span><a href="#label-prev_year-2C+next_year">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>In Ruby 1.9 <code>prev_year</code> and <code>next_year</code> return a date
with the same day/month in the last or next year:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">8</span>) <span class="ruby-comment"># =&gt; Sat, 08 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">prev_year</span>              <span class="ruby-comment"># =&gt; Fri, 08 May 2009</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">next_year</span>              <span class="ruby-comment"># =&gt; Sun, 08 May 2011</span>
</pre>

<p>If date is the 29th of February of a leap year, you obtain the 28th:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">2</span>, <span class="ruby-value">29</span>) <span class="ruby-comment"># =&gt; Tue, 29 Feb 2000</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">prev_year</span>               <span class="ruby-comment"># =&gt; Sun, 28 Feb 1999</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">next_year</span>               <span class="ruby-comment"># =&gt; Wed, 28 Feb 2001</span>
</pre>

<p><code>prev_year</code> is aliased to <code>last_year</code>.</p>

<h5 id="label-prev_month-2C+next_month"><code>prev_month</code>, <code>next_month</code><span><a href="#label-prev_month-2C+next_month">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>In Ruby 1.9 <code>prev_month</code> and <code>next_month</code> return the
date with the same day in the last or next month:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">8</span>) <span class="ruby-comment"># =&gt; Sat, 08 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">prev_month</span>             <span class="ruby-comment"># =&gt; Thu, 08 Apr 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">next_month</span>             <span class="ruby-comment"># =&gt; Tue, 08 Jun 2010</span>
</pre>

<p>If such a day does not exist, the last day of the corresponding month is
returned:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">5</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">prev_month</span> <span class="ruby-comment"># =&gt; Sun, 30 Apr 2000</span>
<span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">3</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">prev_month</span> <span class="ruby-comment"># =&gt; Tue, 29 Feb 2000</span>
<span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">5</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">next_month</span> <span class="ruby-comment"># =&gt; Fri, 30 Jun 2000</span>
<span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">1</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">next_month</span> <span class="ruby-comment"># =&gt; Tue, 29 Feb 2000</span>
</pre>

<p><code>prev_month</code> is aliased to <code>last_month</code>.</p>

<h5 id="label-prev_quarter-2C+next_quarter"><code>prev_quarter</code>, <code>next_quarter</code><span><a href="#label-prev_quarter-2C+next_quarter">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Same as <code>prev_month</code> and <code>next_month</code>. It returns the
date with the same day in the previous or next quarter:</p>

<pre class="ruby"><span class="ruby-identifier">t</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">8</span>) <span class="ruby-comment"># =&gt; Sat, 08 May 2010</span>
<span class="ruby-identifier">t</span>.<span class="ruby-identifier">prev_quarter</span>             <span class="ruby-comment"># =&gt; Mon, 08 Feb 2010</span>
<span class="ruby-identifier">t</span>.<span class="ruby-identifier">next_quarter</span>             <span class="ruby-comment"># =&gt; Sun, 08 Aug 2010</span>
</pre>

<p>If such a day does not exist, the last day of the corresponding month is
returned:</p>

<pre class="ruby"><span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">7</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">prev_quarter</span>  <span class="ruby-comment"># =&gt; Sun, 30 Apr 2000</span>
<span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">5</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">prev_quarter</span>  <span class="ruby-comment"># =&gt; Tue, 29 Feb 2000</span>
<span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">10</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">prev_quarter</span> <span class="ruby-comment"># =&gt; Mon, 30 Oct 2000</span>
<span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2000</span>, <span class="ruby-value">11</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">next_quarter</span> <span class="ruby-comment"># =&gt; Wed, 28 Feb 2001</span>
</pre>

<p><code>prev_quarter</code> is aliased to <code>last_quarter</code>.</p>

<h5 id="label-beginning_of_week-2C+end_of_week"><code>beginning_of_week</code>, <code>end_of_week</code><span><a href="#label-beginning_of_week-2C+end_of_week">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The methods <code>beginning_of_week</code> and <code>end_of_week</code>
return the dates for the beginning and end of the week, respectively. Weeks
are assumed to start on Monday, but that can be changed passing an
argument, setting thread local <code>Date.beginning_of_week</code> or
<code>config.beginning_of_week</code>.</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">8</span>)     <span class="ruby-comment"># =&gt; Sat, 08 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">beginning_of_week</span>          <span class="ruby-comment"># =&gt; Mon, 03 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">beginning_of_week</span>(:<span class="ruby-identifier">sunday</span>) <span class="ruby-comment"># =&gt; Sun, 02 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">end_of_week</span>                <span class="ruby-comment"># =&gt; Sun, 09 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">end_of_week</span>(:<span class="ruby-identifier">sunday</span>)       <span class="ruby-comment"># =&gt; Sat, 08 May 2010</span>
</pre>

<p><code>beginning_of_week</code> is aliased to
<code>at_beginning_of_week</code> and <code>end_of_week</code> is aliased
to <code>at_end_of_week</code>.</p>

<h5 id="label-monday-2C+sunday"><code>monday</code>, <code>sunday</code><span><a href="#label-monday-2C+sunday">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The methods <code>monday</code> and <code>sunday</code> return the dates
for the previous Monday and next Sunday, respectively.</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">8</span>)     <span class="ruby-comment"># =&gt; Sat, 08 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">monday</span>                     <span class="ruby-comment"># =&gt; Mon, 03 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">sunday</span>                     <span class="ruby-comment"># =&gt; Sun, 09 May 2010</span>

<span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2012</span>, <span class="ruby-value">9</span>, <span class="ruby-value">10</span>)    <span class="ruby-comment"># =&gt; Mon, 10 Sep 2012</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">monday</span>                     <span class="ruby-comment"># =&gt; Mon, 10 Sep 2012</span>

<span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2012</span>, <span class="ruby-value">9</span>, <span class="ruby-value">16</span>)    <span class="ruby-comment"># =&gt; Sun, 16 Sep 2012</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">sunday</span>                     <span class="ruby-comment"># =&gt; Sun, 16 Sep 2012</span>
</pre>

<h5 id="label-prev_week-2C+next_week"><code>prev_week</code>, <code>next_week</code><span><a href="#label-prev_week-2C+next_week">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>next_week</code> receives a symbol with a day name in
English (default is the thread local <code>Date.beginning_of_week</code>,
or <code>config.beginning_of_week</code>, or <code>:monday</code>) and it
returns the date corresponding to that day.</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">9</span>) <span class="ruby-comment"># =&gt; Sun, 09 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">next_week</span>              <span class="ruby-comment"># =&gt; Mon, 10 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">next_week</span>(:<span class="ruby-identifier">saturday</span>)   <span class="ruby-comment"># =&gt; Sat, 15 May 2010</span>
</pre>

<p>The method <code>prev_week</code> is analogous:</p>

<pre class="ruby"><span class="ruby-identifier">d</span>.<span class="ruby-identifier">prev_week</span>              <span class="ruby-comment"># =&gt; Mon, 26 Apr 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">prev_week</span>(:<span class="ruby-identifier">saturday</span>)   <span class="ruby-comment"># =&gt; Sat, 01 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">prev_week</span>(:<span class="ruby-identifier">friday</span>)     <span class="ruby-comment"># =&gt; Fri, 30 Apr 2010</span>
</pre>

<p><code>prev_week</code> is aliased to <code>last_week</code>.</p>

<p>Both <code>next_week</code> and <code>prev_week</code> work as expected
when <code>Date.beginning_of_week</code> or
<code>config.beginning_of_week</code> are set.</p>

<h5 id="label-beginning_of_month-2C+end_of_month"><code>beginning_of_month</code>, <code>end_of_month</code><span><a href="#label-beginning_of_month-2C+end_of_month">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The methods <code>beginning_of_month</code> and <code>end_of_month</code>
return the dates for the beginning and end of the month:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">9</span>) <span class="ruby-comment"># =&gt; Sun, 09 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">beginning_of_month</span>     <span class="ruby-comment"># =&gt; Sat, 01 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">end_of_month</span>           <span class="ruby-comment"># =&gt; Mon, 31 May 2010</span>
</pre>

<p><code>beginning_of_month</code> is aliased to
<code>at_beginning_of_month</code>, and <code>end_of_month</code> is
aliased to <code>at_end_of_month</code>.</p>

<h5 id="label-beginning_of_quarter-2C+end_of_quarter"><code>beginning_of_quarter</code>, <code>end_of_quarter</code><span><a href="#label-beginning_of_quarter-2C+end_of_quarter">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The methods <code>beginning_of_quarter</code> and
<code>end_of_quarter</code> return the dates for the beginning and end of
the quarter of the receiver&#39;s calendar year:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">9</span>) <span class="ruby-comment"># =&gt; Sun, 09 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">beginning_of_quarter</span>   <span class="ruby-comment"># =&gt; Thu, 01 Apr 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">end_of_quarter</span>         <span class="ruby-comment"># =&gt; Wed, 30 Jun 2010</span>
</pre>

<p><code>beginning_of_quarter</code> is aliased to
<code>at_beginning_of_quarter</code>, and <code>end_of_quarter</code> is
aliased to <code>at_end_of_quarter</code>.</p>

<h5 id="label-beginning_of_year-2C+end_of_year"><code>beginning_of_year</code>, <code>end_of_year</code><span><a href="#label-beginning_of_year-2C+end_of_year">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The methods <code>beginning_of_year</code> and <code>end_of_year</code>
return the dates for the beginning and end of the year:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">9</span>) <span class="ruby-comment"># =&gt; Sun, 09 May 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">beginning_of_year</span>      <span class="ruby-comment"># =&gt; Fri, 01 Jan 2010</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">end_of_year</span>            <span class="ruby-comment"># =&gt; Fri, 31 Dec 2010</span>
</pre>

<p><code>beginning_of_year</code> is aliased to
<code>at_beginning_of_year</code>, and <code>end_of_year</code> is aliased
to <code>at_end_of_year</code>.</p>

<h4 id="label-Other+Date+Computations">Other Date Computations<span><a href="#label-Other+Date+Computations">&para;</a> <a href="#top">&uarr;</a></span></h4>

<h5 id="label-years_ago-2C+years_since"><code>years_ago</code>, <code>years_since</code><span><a href="#label-years_ago-2C+years_since">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>years_ago</code> receives a number of years and returns
the same date those many years ago:</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">years_ago</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; Wed, 07 Jun 2000</span>
</pre>

<p><code>years_since</code> moves forward in time:</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">years_since</span>(<span class="ruby-value">10</span>) <span class="ruby-comment"># =&gt; Sun, 07 Jun 2020</span>
</pre>

<p>If such a day does not exist, the last day of the corresponding month is
returned:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2012</span>, <span class="ruby-value">2</span>, <span class="ruby-value">29</span>).<span class="ruby-identifier">years_ago</span>(<span class="ruby-value">3</span>)     <span class="ruby-comment"># =&gt; Sat, 28 Feb 2009</span>
<span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2012</span>, <span class="ruby-value">2</span>, <span class="ruby-value">29</span>).<span class="ruby-identifier">years_since</span>(<span class="ruby-value">3</span>)   <span class="ruby-comment"># =&gt; Sat, 28 Feb 2015</span>
</pre>

<h5 id="label-months_ago-2C+months_since"><code>months_ago</code>, <code>months_since</code><span><a href="#label-months_ago-2C+months_since">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The methods <code>months_ago</code> and <code>months_since</code> work
analogously for months:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">4</span>, <span class="ruby-value">30</span>).<span class="ruby-identifier">months_ago</span>(<span class="ruby-value">2</span>)   <span class="ruby-comment"># =&gt; Sun, 28 Feb 2010</span>
<span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">4</span>, <span class="ruby-value">30</span>).<span class="ruby-identifier">months_since</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; Wed, 30 Jun 2010</span>
</pre>

<p>If such a day does not exist, the last day of the corresponding month is
returned:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">4</span>, <span class="ruby-value">30</span>).<span class="ruby-identifier">months_ago</span>(<span class="ruby-value">2</span>)    <span class="ruby-comment"># =&gt; Sun, 28 Feb 2010</span>
<span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2009</span>, <span class="ruby-value">12</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">months_since</span>(<span class="ruby-value">2</span>) <span class="ruby-comment"># =&gt; Sun, 28 Feb 2010</span>
</pre>

<h5 id="label-weeks_ago"><code>weeks_ago</code><span><a href="#label-weeks_ago">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>weeks_ago</code> works analogously for weeks:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">24</span>).<span class="ruby-identifier">weeks_ago</span>(<span class="ruby-value">1</span>)    <span class="ruby-comment"># =&gt; Mon, 17 May 2010</span>
<span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">5</span>, <span class="ruby-value">24</span>).<span class="ruby-identifier">weeks_ago</span>(<span class="ruby-value">2</span>)    <span class="ruby-comment"># =&gt; Mon, 10 May 2010</span>
</pre>

<h5 id="label-advance"><code>advance</code><span><a href="#label-advance">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The most generic way to jump to other days is <code>advance</code>. This
method receives a hash with keys <code>:years</code>, <code>:months</code>,
<code>:weeks</code>, <code>:days</code>, and returns a date advanced as
much as the present keys indicate:</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">6</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">years</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">weeks</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)  <span class="ruby-comment"># =&gt; Mon, 20 Jun 2011</span>
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">months</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">days</span><span class="ruby-operator">:</span> <span class="ruby-value">-2</span>) <span class="ruby-comment"># =&gt; Wed, 04 Aug 2010</span>
</pre>

<p>Note in the previous example that increments may be negative.</p>

<p>To perform the computation the method first increments years, then months,
then weeks, and finally days. This order is important towards the end of
months. Say for example we are at the end of February of 2010, and we want
to move one month and one day forward.</p>

<p>The method <code>advance</code> advances first one month, and then one day,
the result is:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">2</span>, <span class="ruby-value">28</span>).<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">months</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">days</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; Sun, 29 Mar 2010</span>
</pre>

<p>While if it did it the other way around the result would be different:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">2</span>, <span class="ruby-value">28</span>).<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">days</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">months</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; Thu, 01 Apr 2010</span>
</pre>

<h4 id="label-Changing+Components">Changing Components<span><a href="#label-Changing+Components">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>change</code> allows you to get a new date which is the
same as the receiver except for the given year, month, or day:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">12</span>, <span class="ruby-value">23</span>).<span class="ruby-identifier">change</span>(<span class="ruby-identifier">year</span><span class="ruby-operator">:</span> <span class="ruby-value">2011</span>, <span class="ruby-identifier">month</span><span class="ruby-operator">:</span> <span class="ruby-value">11</span>)
<span class="ruby-comment"># =&gt; Wed, 23 Nov 2011</span>
</pre>

<p>This method is not tolerant to non-existing dates, if the change is invalid
<code>ArgumentError</code> is raised:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">1</span>, <span class="ruby-value">31</span>).<span class="ruby-identifier">change</span>(<span class="ruby-identifier">month</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
<span class="ruby-comment"># =&gt; ArgumentError: invalid date</span>
</pre>

<h4 id="label-Durations">Durations<span><a href="#label-Durations">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Durations can be added to and subtracted from dates:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Mon, 09 Aug 2010</span>
<span class="ruby-identifier">d</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">year</span>
<span class="ruby-comment"># =&gt; Tue, 09 Aug 2011</span>
<span class="ruby-identifier">d</span> <span class="ruby-operator">-</span> <span class="ruby-value">3</span>.<span class="ruby-identifier">hours</span>
<span class="ruby-comment"># =&gt; Sun, 08 Aug 2010 21:00:00 UTC +00:00</span>
</pre>

<p>They translate to calls to <code>since</code> or <code>advance</code>. For
example here we get the correct jump in the calendar reform:</p>

<pre class="ruby"><span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1582</span>, <span class="ruby-value">10</span>, <span class="ruby-value">4</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">day</span>
<span class="ruby-comment"># =&gt; Fri, 15 Oct 1582</span>
</pre>

<h4 id="label-Timestamps">Timestamps<span><a href="#label-Timestamps">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>INFO: The following methods return a <code>Time</code> object if possible,
otherwise a <code>DateTime</code>. If set, they honor the user time zone.</p>

<h5 id="label-beginning_of_day-2C+end_of_day"><code>beginning_of_day</code>, <code>end_of_day</code><span><a href="#label-beginning_of_day-2C+end_of_day">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>beginning_of_day</code> returns a timestamp at the
beginning of the day (00:00:00):</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">beginning_of_day</span> <span class="ruby-comment"># =&gt; Mon Jun 07 00:00:00 +0200 2010</span>
</pre>

<p>The method <code>end_of_day</code> returns a timestamp at the end of the
day (23:59:59):</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">end_of_day</span> <span class="ruby-comment"># =&gt; Mon Jun 07 23:59:59 +0200 2010</span>
</pre>

<p><code>beginning_of_day</code> is aliased to
<code>at_beginning_of_day</code>, <code>midnight</code>,
<code>at_midnight</code>.</p>

<h5 id="label-beginning_of_hour-2C+end_of_hour"><code>beginning_of_hour</code>, <code>end_of_hour</code><span><a href="#label-beginning_of_hour-2C+end_of_hour">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>beginning_of_hour</code> returns a timestamp at the
beginning of the hour (hh:00:00):</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>, <span class="ruby-value">19</span>, <span class="ruby-value">55</span>, <span class="ruby-value">25</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">beginning_of_hour</span> <span class="ruby-comment"># =&gt; Mon Jun 07 19:00:00 +0200 2010</span>
</pre>

<p>The method <code>end_of_hour</code> returns a timestamp at the end of the
hour (hh:59:59):</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>, <span class="ruby-value">19</span>, <span class="ruby-value">55</span>, <span class="ruby-value">25</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">end_of_hour</span> <span class="ruby-comment"># =&gt; Mon Jun 07 19:59:59 +0200 2010</span>
</pre>

<p><code>beginning_of_hour</code> is aliased to
<code>at_beginning_of_hour</code>.</p>

<h5 id="label-beginning_of_minute-2C+end_of_minute"><code>beginning_of_minute</code>, <code>end_of_minute</code><span><a href="#label-beginning_of_minute-2C+end_of_minute">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>beginning_of_minute</code> returns a timestamp at the
beginning of the minute (hh:mm:00):</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>, <span class="ruby-value">19</span>, <span class="ruby-value">55</span>, <span class="ruby-value">25</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">beginning_of_minute</span> <span class="ruby-comment"># =&gt; Mon Jun 07 19:55:00 +0200 2010</span>
</pre>

<p>The method <code>end_of_minute</code> returns a timestamp at the end of the
minute (hh:mm:59):</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">6</span>, <span class="ruby-value">7</span>, <span class="ruby-value">19</span>, <span class="ruby-value">55</span>, <span class="ruby-value">25</span>)
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">end_of_minute</span> <span class="ruby-comment"># =&gt; Mon Jun 07 19:55:59 +0200 2010</span>
</pre>

<p><code>beginning_of_minute</code> is aliased to
<code>at_beginning_of_minute</code>.</p>

<p>INFO: <code>beginning_of_hour</code>, <code>end_of_hour</code>,
<code>beginning_of_minute</code> and <code>end_of_minute</code> are
implemented for <code>Time</code> and <code>DateTime</code> but
<strong>not</strong> <code>Date</code> as it does not make sense to request
the beginning or end of an hour or minute on a <code>Date</code> instance.</p>

<h5 id="label-ago-2C+since"><code>ago</code>, <code>since</code><span><a href="#label-ago-2C+since">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>ago</code> receives a number of seconds as argument and
returns a timestamp those many seconds ago from midnight:</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">current</span> <span class="ruby-comment"># =&gt; Fri, 11 Jun 2010</span>
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">ago</span>(<span class="ruby-value">1</span>)         <span class="ruby-comment"># =&gt; Thu, 10 Jun 2010 23:59:59 EDT -04:00</span>
</pre>

<p>Similarly, <code>since</code> moves forward:</p>

<pre class="ruby"><span class="ruby-identifier">date</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">current</span> <span class="ruby-comment"># =&gt; Fri, 11 Jun 2010</span>
<span class="ruby-identifier">date</span>.<span class="ruby-identifier">since</span>(<span class="ruby-value">1</span>)       <span class="ruby-comment"># =&gt; Fri, 11 Jun 2010 00:00:01 EDT -04:00</span>
</pre>

<h4 id="label-Other+Time+Computations">Other Time Computations<span><a href="#label-Other+Time+Computations">&para;</a> <a href="#top">&uarr;</a></span></h4>

<h3 id="label-Conversions">Conversions<span><a href="#label-Conversions">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h2 id="label-Extensions+to+DateTime">Extensions to <code>DateTime</code><span><a href="#label-Extensions+to+DateTime">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>WARNING: <code>DateTime</code> is not aware of DST rules and so some of
these methods have edge cases when a DST change is going on. For example
<code>seconds_since_midnight</code> might not return the real amount in
such a day.</p>

<h3 id="label-Calculations">Calculations<span><a href="#label-Calculations">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>NOTE: All the following methods are defined in
<code>active_support/core_ext/date_time/calculations.rb</code>.</p>

<p>The class <code>DateTime</code> is a subclass of <code>Date</code> so by
loading <code>active_support/core_ext/date/calculations.rb</code> you
inherit these methods and their aliases, except that they will always
return datetimes:</p>

<pre class="ruby"><span class="ruby-identifier">yesterday</span>
<span class="ruby-identifier">tomorrow</span>
<span class="ruby-identifier">beginning_of_week</span> (<span class="ruby-identifier">at_beginning_of_week</span>)
<span class="ruby-identifier">end_of_week</span> (<span class="ruby-identifier">at_end_of_week</span>)
<span class="ruby-identifier">monday</span>
<span class="ruby-identifier">sunday</span>
<span class="ruby-identifier">weeks_ago</span>
<span class="ruby-identifier">prev_week</span> (<span class="ruby-identifier">last_week</span>)
<span class="ruby-identifier">next_week</span>
<span class="ruby-identifier">months_ago</span>
<span class="ruby-identifier">months_since</span>
<span class="ruby-identifier">beginning_of_month</span> (<span class="ruby-identifier">at_beginning_of_month</span>)
<span class="ruby-identifier">end_of_month</span> (<span class="ruby-identifier">at_end_of_month</span>)
<span class="ruby-identifier">prev_month</span> (<span class="ruby-identifier">last_month</span>)
<span class="ruby-identifier">next_month</span>
<span class="ruby-identifier">beginning_of_quarter</span> (<span class="ruby-identifier">at_beginning_of_quarter</span>)
<span class="ruby-identifier">end_of_quarter</span> (<span class="ruby-identifier">at_end_of_quarter</span>)
<span class="ruby-identifier">beginning_of_year</span> (<span class="ruby-identifier">at_beginning_of_year</span>)
<span class="ruby-identifier">end_of_year</span> (<span class="ruby-identifier">at_end_of_year</span>)
<span class="ruby-identifier">years_ago</span>
<span class="ruby-identifier">years_since</span>
<span class="ruby-identifier">prev_year</span> (<span class="ruby-identifier">last_year</span>)
<span class="ruby-identifier">next_year</span>
</pre>

<p>The following methods are reimplemented so you do <strong>not</strong> need
to load <code>active_support/core_ext/date/calculations.rb</code> for these
ones:</p>

<pre class="ruby"><span class="ruby-identifier">beginning_of_day</span> (<span class="ruby-identifier">midnight</span>, <span class="ruby-identifier">at_midnight</span>, <span class="ruby-identifier">at_beginning_of_day</span>)
<span class="ruby-identifier">end_of_day</span>
<span class="ruby-identifier">ago</span>
<span class="ruby-identifier">since</span> (<span class="ruby-keyword">in</span>)
</pre>

<p>On the other hand, <code>advance</code> and <code>change</code> are also
defined and support more options, they are documented below.</p>

<p>The following methods are only implemented in
<code>active_support/core_ext/date_time/calculations.rb</code> as they only
make sense when used with a <code>DateTime</code> instance:</p>

<pre class="ruby"><span class="ruby-identifier">beginning_of_hour</span> (<span class="ruby-identifier">at_beginning_of_hour</span>)
<span class="ruby-identifier">end_of_hour</span>
</pre>

<h4 id="label-Named+Datetimes">Named Datetimes<span><a href="#label-Named+Datetimes">&para;</a> <a href="#top">&uarr;</a></span></h4>

<h5 id="label-DateTime.current"><code>DateTime.current</code><span><a href="#label-DateTime.current">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Active Support defines <code>DateTime.current</code> to be like
<code>Time.now.to_datetime</code>, except that it honors the user time
zone, if defined. It also defines <code>DateTime.yesterday</code> and
<code>DateTime.tomorrow</code>, and the instance predicates
<code>past?</code>, and <code>future?</code> relative to
<code>DateTime.current</code>.</p>

<h4 id="label-Other+Extensions">Other Extensions<span><a href="#label-Other+Extensions">&para;</a> <a href="#top">&uarr;</a></span></h4>

<h5 id="label-seconds_since_midnight"><code>seconds_since_midnight</code><span><a href="#label-seconds_since_midnight">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>seconds_since_midnight</code> returns the number of
seconds since midnight:</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">current</span>     <span class="ruby-comment"># =&gt; Mon, 07 Jun 2010 20:26:36 +0000</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">seconds_since_midnight</span> <span class="ruby-comment"># =&gt; 73596</span>
</pre>

<h5 id="label-utc"><code>utc</code><span><a href="#label-utc">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The method <code>utc</code> gives you the same datetime in the receiver
expressed in UTC.</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">current</span> <span class="ruby-comment"># =&gt; Mon, 07 Jun 2010 19:27:52 -0400</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc</span>                <span class="ruby-comment"># =&gt; Mon, 07 Jun 2010 23:27:52 +0000</span>
</pre>

<p>This method is also aliased as <code>getutc</code>.</p>

<h5 id="label-utc-3F"><code>utc?</code><span><a href="#label-utc-3F">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The predicate <code>utc?</code> says whether the receiver has UTC as its
time zone:</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">now</span> <span class="ruby-comment"># =&gt; Mon, 07 Jun 2010 19:30:47 -0400</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc?</span>           <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc</span>.<span class="ruby-identifier">utc?</span>       <span class="ruby-comment"># =&gt; true</span>
</pre>

<h5 id="label-advance"><code>advance</code><span><a href="#label-advance">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>The most generic way to jump to another datetime is <code>advance</code>.
This method receives a hash with keys <code>:years</code>,
<code>:months</code>, <code>:weeks</code>, <code>:days</code>,
<code>:hours</code>, <code>:minutes</code>, and <code>:seconds</code>, and
returns a datetime advanced as much as the present keys indicate.</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Thu, 05 Aug 2010 11:33:31 +0000</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">years</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">months</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">days</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">hours</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">minutes</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">seconds</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; Tue, 06 Sep 2011 12:34:32 +0000</span>
</pre>

<p>This method first computes the destination date passing
<code>:years</code>, <code>:months</code>, <code>:weeks</code>, and
<code>:days</code> to <code>Date#advance</code> documented above. After
that, it adjusts the time calling <code>since</code> with the number of
seconds to advance. This order is relevant, a different ordering would give
different datetimes in some edge-cases. The example in
<code>Date#advance</code> applies, and we can extend it to show order
relevance related to the time bits.</p>

<p>If we first move the date bits (that have also a relative order of
processing, as documented before), and then the time bits we get for
example the following computation:</p>

<pre class="ruby"><span class="ruby-identifier">d</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">2</span>, <span class="ruby-value">28</span>, <span class="ruby-value">23</span>, <span class="ruby-value">59</span>, <span class="ruby-value">59</span>)
<span class="ruby-comment"># =&gt; Sun, 28 Feb 2010 23:59:59 +0000</span>
<span class="ruby-identifier">d</span>.<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">months</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">seconds</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; Mon, 29 Mar 2010 00:00:00 +0000</span>
</pre>

<p>but if we computed them the other way around, the result would be
different:</p>

<pre class="ruby"><span class="ruby-identifier">d</span>.<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">seconds</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">months</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; Thu, 01 Apr 2010 00:00:00 +0000</span>
</pre>

<p>WARNING: Since <code>DateTime</code> is not DST-aware you can end up in a
non-existing point in time with no warning or error telling you so.</p>

<h4 id="label-Changing+Components">Changing Components<span><a href="#label-Changing+Components">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>change</code> allows you to get a new datetime which is
the same as the receiver except for the given options, which may include
<code>:year</code>, <code>:month</code>, <code>:day</code>,
<code>:hour</code>, <code>:min</code>, <code>:sec</code>,
<code>:offset</code>, <code>:start</code>:</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Tue, 08 Jun 2010 01:56:22 +0000</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">change</span>(<span class="ruby-identifier">year</span><span class="ruby-operator">:</span> <span class="ruby-value">2011</span>, <span class="ruby-identifier">offset</span><span class="ruby-operator">:</span> <span class="ruby-constant">Rational</span>(<span class="ruby-value">-6</span>, <span class="ruby-value">24</span>))
<span class="ruby-comment"># =&gt; Wed, 08 Jun 2011 01:56:22 -0600</span>
</pre>

<p>If hours are zeroed, then minutes and seconds are too (unless they have
given values):</p>

<pre class="ruby"><span class="ruby-identifier">now</span>.<span class="ruby-identifier">change</span>(<span class="ruby-identifier">hour</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
<span class="ruby-comment"># =&gt; Tue, 08 Jun 2010 00:00:00 +0000</span>
</pre>

<p>Similarly, if minutes are zeroed, then seconds are too (unless it has given
a value):</p>

<pre class="ruby"><span class="ruby-identifier">now</span>.<span class="ruby-identifier">change</span>(<span class="ruby-identifier">min</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
<span class="ruby-comment"># =&gt; Tue, 08 Jun 2010 01:00:00 +0000</span>
</pre>

<p>This method is not tolerant to non-existing dates, if the change is invalid
<code>ArgumentError</code> is raised:</p>

<pre class="ruby"><span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">change</span>(<span class="ruby-identifier">month</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>, <span class="ruby-identifier">day</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>)
<span class="ruby-comment"># =&gt; ArgumentError: invalid date</span>
</pre>

<h4 id="label-Durations">Durations<span><a href="#label-Durations">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Durations can be added to and subtracted from datetimes:</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Mon, 09 Aug 2010 23:15:17 +0000</span>
<span class="ruby-identifier">now</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">year</span>
<span class="ruby-comment"># =&gt; Tue, 09 Aug 2011 23:15:17 +0000</span>
<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">week</span>
<span class="ruby-comment"># =&gt; Mon, 02 Aug 2010 23:15:17 +0000</span>
</pre>

<p>They translate to calls to <code>since</code> or <code>advance</code>. For
example here we get the correct jump in the calendar reform:</p>

<pre class="ruby"><span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1582</span>, <span class="ruby-value">10</span>, <span class="ruby-value">4</span>, <span class="ruby-value">23</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">hour</span>
<span class="ruby-comment"># =&gt; Fri, 15 Oct 1582 00:00:00 +0000</span>
</pre>

<h2 id="label-Extensions+to+Time">Extensions to <code>Time</code><span><a href="#label-Extensions+to+Time">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Calculations">Calculations<span><a href="#label-Calculations">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>NOTE: All the following methods are defined in
<code>active_support/core_ext/time/calculations.rb</code>.</p>

<p>Active Support adds to <code>Time</code> many of the methods available for
<code>DateTime</code>:</p>

<pre class="ruby"><span class="ruby-identifier">past?</span>
<span class="ruby-identifier">today?</span>
<span class="ruby-identifier">future?</span>
<span class="ruby-identifier">yesterday</span>
<span class="ruby-identifier">tomorrow</span>
<span class="ruby-identifier">seconds_since_midnight</span>
<span class="ruby-identifier">change</span>
<span class="ruby-identifier">advance</span>
<span class="ruby-identifier">ago</span>
<span class="ruby-identifier">since</span> (<span class="ruby-keyword">in</span>)
<span class="ruby-identifier">beginning_of_day</span> (<span class="ruby-identifier">midnight</span>, <span class="ruby-identifier">at_midnight</span>, <span class="ruby-identifier">at_beginning_of_day</span>)
<span class="ruby-identifier">end_of_day</span>
<span class="ruby-identifier">beginning_of_hour</span> (<span class="ruby-identifier">at_beginning_of_hour</span>)
<span class="ruby-identifier">end_of_hour</span>
<span class="ruby-identifier">beginning_of_week</span> (<span class="ruby-identifier">at_beginning_of_week</span>)
<span class="ruby-identifier">end_of_week</span> (<span class="ruby-identifier">at_end_of_week</span>)
<span class="ruby-identifier">monday</span>
<span class="ruby-identifier">sunday</span>
<span class="ruby-identifier">weeks_ago</span>
<span class="ruby-identifier">prev_week</span> (<span class="ruby-identifier">last_week</span>)
<span class="ruby-identifier">next_week</span>
<span class="ruby-identifier">months_ago</span>
<span class="ruby-identifier">months_since</span>
<span class="ruby-identifier">beginning_of_month</span> (<span class="ruby-identifier">at_beginning_of_month</span>)
<span class="ruby-identifier">end_of_month</span> (<span class="ruby-identifier">at_end_of_month</span>)
<span class="ruby-identifier">prev_month</span> (<span class="ruby-identifier">last_month</span>)
<span class="ruby-identifier">next_month</span>
<span class="ruby-identifier">beginning_of_quarter</span> (<span class="ruby-identifier">at_beginning_of_quarter</span>)
<span class="ruby-identifier">end_of_quarter</span> (<span class="ruby-identifier">at_end_of_quarter</span>)
<span class="ruby-identifier">beginning_of_year</span> (<span class="ruby-identifier">at_beginning_of_year</span>)
<span class="ruby-identifier">end_of_year</span> (<span class="ruby-identifier">at_end_of_year</span>)
<span class="ruby-identifier">years_ago</span>
<span class="ruby-identifier">years_since</span>
<span class="ruby-identifier">prev_year</span> (<span class="ruby-identifier">last_year</span>)
<span class="ruby-identifier">next_year</span>
</pre>

<p>They are analogous. Please refer to their documentation above and take into
account the following differences:</p>
<ul><li>
<p><code>change</code> accepts an additional <code>:usec</code> option.</p>
</li><li>
<p><code>Time</code> understands DST, so you get correct DST calculations as
in</p>
</li></ul>

<pre class="ruby"><span class="ruby-constant">Time</span>.<span class="ruby-identifier">zone_default</span>
<span class="ruby-comment"># =&gt; #&lt;ActiveSupport::TimeZone:0x7f73654d4f38 @utc_offset=nil, @name=&quot;Madrid&quot;, ...&gt;</span>

<span class="ruby-comment"># In Barcelona, 2010/03/28 02:00 +0100 becomes 2010/03/28 03:00 +0200 due to DST.</span>
<span class="ruby-identifier">t</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-value">2010</span>, <span class="ruby-value">3</span>, <span class="ruby-value">28</span>, <span class="ruby-value">1</span>, <span class="ruby-value">59</span>, <span class="ruby-value">59</span>)
<span class="ruby-comment"># =&gt; Sun Mar 28 01:59:59 +0100 2010</span>
<span class="ruby-identifier">t</span>.<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">seconds</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-comment"># =&gt; Sun Mar 28 03:00:00 +0200 2010</span>
</pre>
<ul><li>
<p>If <code>since</code> or <code>ago</code> jump to a time that can&#39;t be
expressed with <code>Time</code> a <code>DateTime</code> object is returned
instead.</p>
</li></ul>

<h4 id="label-Time.current"><code>Time.current</code><span><a href="#label-Time.current">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Active Support defines <code>Time.current</code> to be today in the current
time zone. That&#39;s like <code>Time.now</code>, except that it honors the
user time zone, if defined. It also defines the instance predicates
<code>past?</code>, <code>today?</code>, and <code>future?</code>, all of
them relative to <code>Time.current</code>.</p>

<p>When making Time comparisons using methods which honor the user time zone,
make sure to use <code>Time.current</code> instead of
<code>Time.now</code>. There are cases where the user time zone might be in
the future compared to the system time zone, which <code>Time.now</code>
uses by default. This means <code>Time.now.to_date</code> may equal
<code>Date.yesterday</code>.</p>

<h4 id="label-all_day-2C+all_week-2C+all_month-2C+all_quarter+and+all_year"><code>all_day</code>, <code>all_week</code>, <code>all_month</code>, <code>all_quarter</code> and <code>all_year</code><span><a href="#label-all_day-2C+all_week-2C+all_month-2C+all_quarter+and+all_year">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The method <code>all_day</code> returns a range representing the whole day
of the current time.</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">all_day</span>
<span class="ruby-comment"># =&gt; Mon, 09 Aug 2010 00:00:00 UTC +00:00..Mon, 09 Aug 2010 23:59:59 UTC +00:00</span>
</pre>

<p>Analogously, <code>all_week</code>, <code>all_month</code>,
<code>all_quarter</code> and <code>all_year</code> all serve the purpose of
generating time ranges.</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">all_week</span>
<span class="ruby-comment"># =&gt; Mon, 09 Aug 2010 00:00:00 UTC +00:00..Sun, 15 Aug 2010 23:59:59 UTC +00:00</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">all_week</span>(:<span class="ruby-identifier">sunday</span>)
<span class="ruby-comment"># =&gt; Sun, 16 Sep 2012 00:00:00 UTC +00:00..Sat, 22 Sep 2012 23:59:59 UTC +00:00</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">all_month</span>
<span class="ruby-comment"># =&gt; Sat, 01 Aug 2010 00:00:00 UTC +00:00..Tue, 31 Aug 2010 23:59:59 UTC +00:00</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">all_quarter</span>
<span class="ruby-comment"># =&gt; Thu, 01 Jul 2010 00:00:00 UTC +00:00..Thu, 30 Sep 2010 23:59:59 UTC +00:00</span>
<span class="ruby-identifier">now</span>.<span class="ruby-identifier">all_year</span>
<span class="ruby-comment"># =&gt; Fri, 01 Jan 2010 00:00:00 UTC +00:00..Fri, 31 Dec 2010 23:59:59 UTC +00:00</span>
</pre>

<h3 id="label-Time+Constructors">Time Constructors<span><a href="#label-Time+Constructors">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Support defines <code>Time.current</code> to be
<code>Time.zone.now</code> if there&#39;s a user time zone defined, with
fallback to <code>Time.now</code>:</p>

<pre class="ruby"><span class="ruby-constant">Time</span>.<span class="ruby-identifier">zone_default</span>
<span class="ruby-comment"># =&gt; #&lt;ActiveSupport::TimeZone:0x7f73654d4f38 @utc_offset=nil, @name=&quot;Madrid&quot;, ...&gt;</span>
<span class="ruby-constant">Time</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Fri, 06 Aug 2010 17:11:58 CEST +02:00</span>
</pre>

<p>Analogously to <code>DateTime</code>, the predicates <code>past?</code>,
and <code>future?</code> are relative to <code>Time.current</code>.</p>

<p>If the time to be constructed lies beyond the range supported by
<code>Time</code> in the runtime platform, usecs are discarded and a
<code>DateTime</code> object is returned instead.</p>

<h4 id="label-Durations">Durations<span><a href="#label-Durations">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Durations can be added to and subtracted from time objects:</p>

<pre class="ruby"><span class="ruby-identifier">now</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">current</span>
<span class="ruby-comment"># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00</span>
<span class="ruby-identifier">now</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">year</span>
<span class="ruby-comment">#  =&gt; Tue, 09 Aug 2011 23:21:11 UTC +00:00</span>
<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">week</span>
<span class="ruby-comment"># =&gt; Mon, 02 Aug 2010 23:21:11 UTC +00:00</span>
</pre>

<p>They translate to calls to <code>since</code> or <code>advance</code>. For
example here we get the correct jump in the calendar reform:</p>

<pre class="ruby"><span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">1582</span>, <span class="ruby-value">10</span>, <span class="ruby-value">3</span>) <span class="ruby-operator">+</span> <span class="ruby-value">5</span>.<span class="ruby-identifier">days</span>
<span class="ruby-comment"># =&gt; Mon Oct 18 00:00:00 UTC 1582</span>
</pre>

<h2 id="label-Extensions+to+File">Extensions to <code>File</code><span><a href="#label-Extensions+to+File">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-atomic_write"><code>atomic_write</code><span><a href="#label-atomic_write">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>With the class method <code>File.atomic_write</code> you can write to a
file in a way that will prevent any reader from seeing half-written
content.</p>

<p>The name of the file is passed as an argument, and the method yields a file
handle opened for writing. Once the block is done <code>atomic_write</code>
closes the file handle and completes its job.</p>

<p>For example, Action Pack uses this method to write asset cache files like
<code>all.css</code>:</p>

<pre class="ruby"><span class="ruby-constant">File</span>.<span class="ruby-identifier">atomic_write</span>(<span class="ruby-identifier">joined_asset_path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cache</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">cache</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">join_asset_file_contents</span>(<span class="ruby-identifier">asset_paths</span>))
<span class="ruby-keyword">end</span>
</pre>

<p>To accomplish this <code>atomic_write</code> creates a temporary file.
That&#39;s the file the code in the block actually writes to. On
completion, the temporary file is renamed, which is an atomic operation on
POSIX systems. If the target file exists <code>atomic_write</code>
overwrites it and keeps owners and permissions. However there are a few
cases where <code>atomic_write</code> cannot change the file ownership or
permissions, this error is caught and skipped over trusting in the
user/filesystem to ensure the file is accessible to the processes that need
it.</p>

<p>NOTE. Due to the chmod operation <code>atomic_write</code> performs, if the
target file has an ACL set on it this ACL will be recalculated/modified.</p>

<p>WARNING. Note you can&#39;t append with <code>atomic_write</code>.</p>

<p>The auxiliary file is written in a standard directory for temporary files,
but you can pass a directory of your choice as second argument.</p>

<p>NOTE: Defined in <code>active_support/core_ext/file/atomic.rb</code>.</p>

<h2 id="label-Extensions+to+Marshal">Extensions to <code>Marshal</code><span><a href="#label-Extensions+to+Marshal">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-load"><code>load</code><span><a href="#label-load">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Support adds constant autoloading support to <code>load</code>.</p>

<p>For example, the file cache store deserializes this way:</p>

<pre class="ruby"><span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file_name</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">f</span>) }
</pre>

<p>If the cached data refers to a constant that is unknown at that point, the
autoloading mechanism is triggered and if it succeeds the deserialization
is retried transparently.</p>

<p>WARNING. If the argument is an <code>IO</code> it needs to respond to
<code>rewind</code> to be able to retry. Regular files respond to
<code>rewind</code>.</p>

<p>NOTE: Defined in <code>active_support/core_ext/marshal.rb</code>.</p>

<h2 id="label-Extensions+to+Logger">Extensions to <code>Logger</code><span><a href="#label-Extensions+to+Logger">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-around_-5Blevel-5D"><code>around_[level]</code><span><a href="#label-around_-5Blevel-5D">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Takes two arguments, a <code>before_message</code> and
<code>after_message</code> and calls the current level method on the
<code>Logger</code> instance, passing in the <code>before_message</code>,
then the specified message, then the <code>after_message</code>:</p>

<pre class="ruby"><span class="ruby-identifier">logger</span> = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;log/development.log&quot;</span>)
<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">around_info</span>(<span class="ruby-string">&quot;before&quot;</span>, <span class="ruby-string">&quot;after&quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">logger</span><span class="ruby-operator">|</span> <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">info</span>(<span class="ruby-string">&quot;during&quot;</span>) }
</pre>

<h3 id="label-silence"><code>silence</code><span><a href="#label-silence">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Silences every log level lesser to the specified one for the duration of
the given block. Log level orders are: debug, info, error and fatal.</p>

<pre class="ruby"><span class="ruby-identifier">logger</span> = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;log/development.log&quot;</span>)
<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">silence</span>(<span class="ruby-constant">Logger</span><span class="ruby-operator">::</span><span class="ruby-constant">INFO</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-string">&quot;In space, no one can hear you scream.&quot;</span>)
  <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">info</span>(<span class="ruby-string">&quot;Scream all you want, small mailman!&quot;</span>)
<span class="ruby-keyword">end</span>
</pre>

<h3 id="label-datetime_format-3D"><code>datetime_format=</code><span><a href="#label-datetime_format-3D">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Modifies the datetime format output by the formatter class associated with
this logger. If the formatter class does not have a
<code>datetime_format</code> method then this is ignored.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Logger</span><span class="ruby-operator">::</span><span class="ruby-constant">FormatWithTime</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Logger</span><span class="ruby-operator">::</span><span class="ruby-constant">Formatter</span>
  <span class="ruby-identifier">cattr_accessor</span>(:<span class="ruby-identifier">datetime_format</span>) { <span class="ruby-string">&quot;%Y%m%d%H%m%S&quot;</span> }

  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">severity</span>, <span class="ruby-identifier">timestamp</span>, <span class="ruby-identifier">progname</span>, <span class="ruby-identifier">msg</span>)
    <span class="ruby-node">&quot;#{timestamp.strftime(datetime_format)} -- #{String === msg ? msg : msg.inspect}\n&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">logger</span> = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;log/development.log&quot;</span>)
<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">formatter</span> = <span class="ruby-constant">Logger</span><span class="ruby-operator">::</span><span class="ruby-constant">FormatWithTime</span>
<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">info</span>(<span class="ruby-string">&quot;&lt;- is the current time&quot;</span>)
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/logger.rb</code>.</p>

<h2 id="label-Extensions+to+NameError">Extensions to <code>NameError</code><span><a href="#label-Extensions+to+NameError">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Active Support adds <code>missing_name?</code> to <code>NameError</code>,
which tests whether the exception was raised because of the name passed as
argument.</p>

<p>The name may be given as a symbol or string. A symbol is tested against the
bare constant name, a string is against the fully-qualified constant name.</p>

<p>TIP: A symbol can represent a fully-qualified constant name as in
<code>:&quot;ActiveRecord::Base&quot;</code>, so the behavior for symbols
is defined for convenience, not because it has to be that way technically.</p>

<p>For example, when an action of <code>ArticlesController</code> is called
Rails tries optimistically to use <code>ArticlesHelper</code>. It is OK
that the helper module does not exist, so if an exception for that constant
name is raised it should be silenced. But it could be the case that
<code>articles_helper.rb</code> raises a <code>NameError</code> due to an
actual unknown constant. That should be reraised. The method
<code>missing_name?</code> provides a way to distinguish both cases:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">default_helper_module!</span>
  <span class="ruby-identifier">module_name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/Controller$/</span>, <span class="ruby-string">&#39;&#39;</span>)
  <span class="ruby-identifier">module_path</span> = <span class="ruby-identifier">module_name</span>.<span class="ruby-identifier">underscore</span>
  <span class="ruby-identifier">helper</span> <span class="ruby-identifier">module_path</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">MissingSourceFile</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">is_missing?</span> <span class="ruby-node">&quot;helpers/#{module_path}_helper&quot;</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">missing_name?</span> <span class="ruby-node">&quot;#{module_name}Helper&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/name_error.rb</code>.</p>

<h2 id="label-Extensions+to+LoadError">Extensions to <code>LoadError</code><span><a href="#label-Extensions+to+LoadError">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Active Support adds <code>is_missing?</code> to <code>LoadError</code>, and
also assigns that class to the constant <code>MissingSourceFile</code> for
backwards compatibility.</p>

<p>Given a path name <code>is_missing?</code> tests whether the exception was
raised due to that particular file (except perhaps for the “.rb”
extension).</p>

<p>For example, when an action of <code>ArticlesController</code> is called
Rails tries to load <code>articles_helper.rb</code>, but that file may not
exist. That&#39;s fine, the helper module is not mandatory so Rails
silences a load error. But it could be the case that the helper module does
exist and in turn requires another library that is missing. In that case
Rails must reraise the exception. The method <code>is_missing?</code>
provides a way to distinguish both cases:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">default_helper_module!</span>
  <span class="ruby-identifier">module_name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/Controller$/</span>, <span class="ruby-string">&#39;&#39;</span>)
  <span class="ruby-identifier">module_path</span> = <span class="ruby-identifier">module_name</span>.<span class="ruby-identifier">underscore</span>
  <span class="ruby-identifier">helper</span> <span class="ruby-identifier">module_path</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">MissingSourceFile</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">is_missing?</span> <span class="ruby-node">&quot;helpers/#{module_path}_helper&quot;</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">missing_name?</span> <span class="ruby-node">&quot;#{module_name}Helper&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>NOTE: Defined in <code>active_support/core_ext/load_error.rb</code>.</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

