<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>getting_started - rails-4.2.1 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-Getting+Started+with+Rails">Getting Started with Rails</a>
    <li><a href="#label-Guide+Assumptions">Guide Assumptions</a>
    <li><a href="#label-What+is+Rails-3F">What is Rails?</a>
    <li><a href="#label-Creating+a+New+Rails+Project">Creating a New Rails Project</a>
    <li><a href="#label-Installing+Rails">Installing Rails</a>
    <li><a href="#label-Creating+the+Blog+Application">Creating the Blog Application</a>
    <li><a href="#label-Hello-2C+Rails-21">Hello, Rails!</a>
    <li><a href="#label-Starting+up+the+Web+Server">Starting up the Web Server</a>
    <li><a href="#label-Say+-22Hello-22-2C+Rails">Say “Hello”, Rails</a>
    <li><a href="#label-Setting+the+Application+Home+Page">Setting the Application Home Page</a>
    <li><a href="#label-Getting+Up+and+Running">Getting Up and Running</a>
    <li><a href="#label-Laying+down+the+ground+work">Laying down the ground work</a>
    <li><a href="#label-The+first+form">The first form</a>
    <li><a href="#label-Creating+articles">Creating articles</a>
    <li><a href="#label-Creating+the+Article+model">Creating the Article model</a>
    <li><a href="#label-Running+a+Migration">Running a Migration</a>
    <li><a href="#label-Saving+data+in+the+controller">Saving data in the controller</a>
    <li><a href="#label-Showing+Articles">Showing Articles</a>
    <li><a href="#label-Listing+all+articles">Listing all articles</a>
    <li><a href="#label-Adding+links">Adding links</a>
    <li><a href="#label-Adding+Some+Validation">Adding Some Validation</a>
    <li><a href="#label-Updating+Articles">Updating Articles</a>
    <li><a href="#label-Using+partials+to+clean+up+duplication+in+views">Using partials to clean up duplication in views</a>
    <li><a href="#label-Deleting+Articles">Deleting Articles</a>
    <li><a href="#label-Adding+a+Second+Model">Adding a Second Model</a>
    <li><a href="#label-Generating+a+Model">Generating a Model</a>
    <li><a href="#label-Associating+Models">Associating Models</a>
    <li><a href="#label-Adding+a+Route+for+Comments">Adding a Route for Comments</a>
    <li><a href="#label-Generating+a+Controller">Generating a Controller</a>
    <li><a href="#label-Refactoring">Refactoring</a>
    <li><a href="#label-Rendering+Partial+Collections">Rendering Partial Collections</a>
    <li><a href="#label-Rendering+a+Partial+Form">Rendering a Partial Form</a>
    <li><a href="#label-Deleting+Comments">Deleting Comments</a>
    <li><a href="#label-Deleting+Associated+Objects">Deleting Associated Objects</a>
    <li><a href="#label-Security">Security</a>
    <li><a href="#label-Basic+Authentication">Basic Authentication</a>
    <li><a href="#label-Other+Security+Considerations">Other Security Considerations</a>
    <li><a href="#label-What-27s+Next-3F">What&#39;s Next?</a>
    <li><a href="#label-Configuration+Gotchas">Configuration Gotchas</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../README_md.html">README</a>
  
    <li><a href="../../guides/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="../../guides/Rakefile.html">Rakefile</a>
  
    <li><a href="../../guides/assets/images/icons/README.html">README</a>
  
    <li><a href="../../guides/assets/javascripts/guides_js.html">guides.js</a>
  
    <li><a href="../../guides/assets/javascripts/jquery_min_js.html">jquery.min.js</a>
  
    <li><a href="../../guides/assets/javascripts/responsive-tables_js.html">responsive-tables.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushAS3_js.html">shBrushAS3.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushAppleScript_js.html">shBrushAppleScript.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushBash_js.html">shBrushBash.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushCSharp_js.html">shBrushCSharp.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushColdFusion_js.html">shBrushColdFusion.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushCpp_js.html">shBrushCpp.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushCss_js.html">shBrushCss.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushDelphi_js.html">shBrushDelphi.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushDiff_js.html">shBrushDiff.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushErlang_js.html">shBrushErlang.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushGroovy_js.html">shBrushGroovy.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushJScript_js.html">shBrushJScript.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushJava_js.html">shBrushJava.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushJavaFX_js.html">shBrushJavaFX.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPerl_js.html">shBrushPerl.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPhp_js.html">shBrushPhp.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPlain_js.html">shBrushPlain.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPowerShell_js.html">shBrushPowerShell.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushPython_js.html">shBrushPython.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushRuby_js.html">shBrushRuby.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushSass_js.html">shBrushSass.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushScala_js.html">shBrushScala.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushSql_js.html">shBrushSql.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushVb_js.html">shBrushVb.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shBrushXml_js.html">shBrushXml.js</a>
  
    <li><a href="../../guides/assets/javascripts/syntaxhighlighter/shCore_js.html">shCore.js</a>
  
    <li><a href="../../guides/assets/stylesheets/fixes_css.html">fixes.css</a>
  
    <li><a href="../../guides/assets/stylesheets/kindle_css.html">kindle.css</a>
  
    <li><a href="../../guides/assets/stylesheets/main_css.html">main.css</a>
  
    <li><a href="../../guides/assets/stylesheets/print_css.html">print.css</a>
  
    <li><a href="../../guides/assets/stylesheets/reset_css.html">reset.css</a>
  
    <li><a href="../../guides/assets/stylesheets/responsive-tables_css.html">responsive-tables.css</a>
  
    <li><a href="../../guides/assets/stylesheets/style_css.html">style.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCore_css.html">shCore.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreDefault_css.html">shCoreDefault.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreDjango_css.html">shCoreDjango.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreEclipse_css.html">shCoreEclipse.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreEmacs_css.html">shCoreEmacs.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreFadeToGrey_css.html">shCoreFadeToGrey.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreMDUltra_css.html">shCoreMDUltra.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreMidnight_css.html">shCoreMidnight.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shCoreRDark_css.html">shCoreRDark.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeDefault_css.html">shThemeDefault.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeDjango_css.html">shThemeDjango.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeEclipse_css.html">shThemeEclipse.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeEmacs_css.html">shThemeEmacs.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeFadeToGrey_css.html">shThemeFadeToGrey.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeMDUltra_css.html">shThemeMDUltra.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeMidnight_css.html">shThemeMidnight.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeRDark_css.html">shThemeRDark.css</a>
  
    <li><a href="../../guides/assets/stylesheets/syntaxhighlighter/shThemeRailsGuides_css.html">shThemeRailsGuides.css</a>
  
    <li><a href="../../guides/source/2_2_release_notes_md.html">2_2_release_notes</a>
  
    <li><a href="../../guides/source/2_3_release_notes_md.html">2_3_release_notes</a>
  
    <li><a href="../../guides/source/3_0_release_notes_md.html">3_0_release_notes</a>
  
    <li><a href="../../guides/source/3_1_release_notes_md.html">3_1_release_notes</a>
  
    <li><a href="../../guides/source/3_2_release_notes_md.html">3_2_release_notes</a>
  
    <li><a href="../../guides/source/4_0_release_notes_md.html">4_0_release_notes</a>
  
    <li><a href="../../guides/source/4_1_release_notes_md.html">4_1_release_notes</a>
  
    <li><a href="../../guides/source/4_2_release_notes_md.html">4_2_release_notes</a>
  
    <li><a href="../../guides/source/action_controller_overview_md.html">action_controller_overview</a>
  
    <li><a href="../../guides/source/action_mailer_basics_md.html">action_mailer_basics</a>
  
    <li><a href="../../guides/source/action_view_overview_md.html">action_view_overview</a>
  
    <li><a href="../../guides/source/active_job_basics_md.html">active_job_basics</a>
  
    <li><a href="../../guides/source/active_model_basics_md.html">active_model_basics</a>
  
    <li><a href="../../guides/source/active_record_basics_md.html">active_record_basics</a>
  
    <li><a href="../../guides/source/active_record_callbacks_md.html">active_record_callbacks</a>
  
    <li><a href="../../guides/source/active_record_migrations_md.html">active_record_migrations</a>
  
    <li><a href="../../guides/source/active_record_postgresql_md.html">active_record_postgresql</a>
  
    <li><a href="../../guides/source/active_record_querying_md.html">active_record_querying</a>
  
    <li><a href="../../guides/source/active_record_validations_md.html">active_record_validations</a>
  
    <li><a href="../../guides/source/active_support_core_extensions_md.html">active_support_core_extensions</a>
  
    <li><a href="../../guides/source/active_support_instrumentation_md.html">active_support_instrumentation</a>
  
    <li><a href="../../guides/source/api_documentation_guidelines_md.html">api_documentation_guidelines</a>
  
    <li><a href="../../guides/source/asset_pipeline_md.html">asset_pipeline</a>
  
    <li><a href="../../guides/source/association_basics_md.html">association_basics</a>
  
    <li><a href="../../guides/source/autoloading_and_reloading_constants_md.html">autoloading_and_reloading_constants</a>
  
    <li><a href="../../guides/source/caching_with_rails_md.html">caching_with_rails</a>
  
    <li><a href="../../guides/source/command_line_md.html">command_line</a>
  
    <li><a href="../../guides/source/configuring_md.html">configuring</a>
  
    <li><a href="../../guides/source/contributing_to_ruby_on_rails_md.html">contributing_to_ruby_on_rails</a>
  
    <li><a href="../../guides/source/debugging_rails_applications_md.html">debugging_rails_applications</a>
  
    <li><a href="../../guides/source/development_dependencies_install_md.html">development_dependencies_install</a>
  
    <li><a href="../../guides/source/documents_yaml.html">documents.yaml</a>
  
    <li><a href="../../guides/source/engines_md.html">engines</a>
  
    <li><a href="../../guides/source/form_helpers_md.html">form_helpers</a>
  
    <li><a href="../../guides/source/generators_md.html">generators</a>
  
    <li><a href="../../guides/source/getting_started_md.html">getting_started</a>
  
    <li><a href="../../guides/source/i18n_md.html">i18n</a>
  
    <li><a href="../../guides/source/initialization_md.html">initialization</a>
  
    <li><a href="../../guides/source/layouts_and_rendering_md.html">layouts_and_rendering</a>
  
    <li><a href="../../guides/source/maintenance_policy_md.html">maintenance_policy</a>
  
    <li><a href="../../guides/source/nested_model_forms_md.html">nested_model_forms</a>
  
    <li><a href="../../guides/source/plugins_md.html">plugins</a>
  
    <li><a href="../../guides/source/rails_application_templates_md.html">rails_application_templates</a>
  
    <li><a href="../../guides/source/rails_on_rack_md.html">rails_on_rack</a>
  
    <li><a href="../../guides/source/routing_md.html">routing</a>
  
    <li><a href="../../guides/source/ruby_on_rails_guides_guidelines_md.html">ruby_on_rails_guides_guidelines</a>
  
    <li><a href="../../guides/source/security_md.html">security</a>
  
    <li><a href="../../guides/source/testing_md.html">testing</a>
  
    <li><a href="../../guides/source/upgrading_ruby_on_rails_md.html">upgrading_ruby_on_rails</a>
  
    <li><a href="../../guides/source/working_with_javascript_in_rails_md.html">working_with_javascript_in_rails</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page guides/source/getting_started.md">

<h1 id="label-Getting+Started+with+Rails">Getting Started with Rails<span><a href="#label-Getting+Started+with+Rails">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>This guide covers getting up and running with Ruby on Rails.</p>

<p>After reading this guide, you will know:</p>
<ul><li>
<p>How to install Rails, create a new Rails application, and connect your 
application to a database.</p>
</li><li>
<p>The general layout of a Rails application.</p>
</li><li>
<p>The basic principles of MVC (Model, View, Controller) and RESTful design.</p>
</li><li>
<p>How to quickly generate the starting pieces of a Rails application.</p>
</li></ul>
<hr>

<h2 id="label-Guide+Assumptions">Guide Assumptions<span><a href="#label-Guide+Assumptions">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>This guide is designed for beginners who want to get started with a Rails
application from scratch. It does not assume that you have any prior
experience with Rails. However, to get the most out of it, you need to have
some prerequisites installed:</p>
<ul><li>
<p>The <a href="https://www.ruby-lang.org/en/downloads">Ruby</a> language
version 1.9.3 or newer.</p>
</li><li>
<p>The <a href="https://rubygems.org">RubyGems</a> packaging system, which is
installed with Ruby  versions 1.9 and later. To learn more about RubyGems,
please read the <a href="http://guides.rubygems.org">RubyGems Guides</a>.</p>
</li><li>
<p>A working installation of the <a href="https://www.sqlite.org">SQLite3
Database</a>.</p>
</li></ul>

<p>Rails is a web application framework running on the Ruby programming
language. If you have no prior experience with Ruby, you will find a very
steep learning curve diving straight into Rails. There are several curated
lists of online resources for learning Ruby:</p>
<ul><li>
<p><a href="https://www.ruby-lang.org/en/documentation/">Official Ruby
Programming Language website</a></p>
</li><li>
<p><a
href="http://resrc.io/list/10/list-of-free-programming-books/#ruby">reSRC’s
List of Free Programming Books</a></p>
</li></ul>

<p>Be aware that some resources, while still excellent, cover versions of Ruby
as old as 1.6, and commonly 1.8, and will not include some syntax that you
will see in day-to-day development with Rails.</p>

<h2 id="label-What+is+Rails-3F">What is Rails?<span><a href="#label-What+is+Rails-3F">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Rails is a web application development framework written in the Ruby
language. It is designed to make programming web applications easier by
making assumptions about what every developer needs to get started. It
allows you to write less code while accomplishing more than many other
languages and frameworks. Experienced Rails developers also report that it
makes web application development more fun.</p>

<p>Rails is opinionated software. It makes the assumption that there is the
“best” way to do things, and it&#39;s designed to encourage that way - and
in some cases to discourage alternatives. If you learn “The Rails Way”
you&#39;ll probably discover a tremendous increase in productivity. If you
persist in bringing old habits from other languages to your Rails
development, and trying to use patterns you learned elsewhere, you may have
a less happy experience.</p>

<p>The Rails philosophy includes two major guiding principles:</p>
<ul><li>
<p><strong>Don&#39;t Repeat Yourself:</strong> DRY is a principle of software
development which  states that “Every piece of knowledge must have a
single, unambiguous, authoritative  representation within a system.” By not
writing the same information over and over  again, our code is more
maintainable, more extensible, and less buggy.</p>
</li><li>
<p><strong>Convention Over Configuration:</strong> Rails has opinions about
the best way to do many  things in a web application, and defaults to this
set of conventions, rather than  require that you specify every minutiae
through endless configuration files.</p>
</li></ul>

<h2 id="label-Creating+a+New+Rails+Project">Creating a New Rails Project<span><a href="#label-Creating+a+New+Rails+Project">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The best way to use this guide is to follow each step as it happens, no
code or step needed to make this example application has been left out, so
you can literally follow along step by step.</p>

<p>By following along with this guide, you&#39;ll create a Rails project
called <code>blog</code>, a (very) simple weblog. Before you can start
building the application, you need to make sure that you have Rails itself
installed.</p>

<p>TIP: The examples below use <code>$</code> to represent your terminal
prompt in a UNIX-like OS, though it may have been customized to appear
differently. If you are using Windows, your prompt will look something like
<code>c:\source_code&gt;</code></p>

<h3 id="label-Installing+Rails">Installing Rails<span><a href="#label-Installing+Rails">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Open up a command line prompt. On Mac OS X open Terminal.app, on Windows
choose “Run” from your Start menu and type &#39;cmd.exe&#39;. Any commands
prefaced with a dollar sign <code>$</code> should be run in the command
line. Verify that you have a current version of Ruby installed:</p>

<p>TIP: A number of tools exist to help you quickly install Ruby and Ruby on
Rails on your system. Windows users can use <a
href="http://railsinstaller.org">Rails Installer</a>, while Mac OS X users
can use <a href="https://github.com/tokaido/tokaidoapp">Tokaido</a>.</p>

<pre>$ ruby -v
ruby 2.0.0p353</pre>

<p>If you don&#39;t have Ruby installed have a look at <a
href="https://www.ruby-lang.org/en/installation/">ruby-lang.org</a> for
possible ways to install Ruby on your platform.</p>

<p>Many popular UNIX-like OSes ship with an acceptable version of SQLite3.
Windows users and others can find installation instructions at the <a
href="https://www.sqlite.org">SQLite3 website</a>. Verify that it is
correctly installed and in your PATH:</p>

<pre>$ sqlite3 --version</pre>

<p>The program should report its version.</p>

<p>To install Rails, use the <code>gem install</code> command provided by
RubyGems:</p>

<pre>$ gem install rails</pre>

<p>To verify that you have everything installed correctly, you should be able
to run the following:</p>

<pre>$ rails --version</pre>

<p>If it says something like “Rails 4.2.0”, you are ready to continue.</p>

<h3 id="label-Creating+the+Blog+Application">Creating the Blog Application<span><a href="#label-Creating+the+Blog+Application">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Rails comes with a number of scripts called generators that are designed to
make your development life easier by creating everything that&#39;s
necessary to start working on a particular task. One of these is the new
application generator, which will provide you with the foundation of a
fresh Rails application so that you don&#39;t have to write it yourself.</p>

<p>To use this generator, open a terminal, navigate to a directory where you
have rights to create files, and type:</p>

<pre>$ rails new blog</pre>

<p>This will create a Rails application called Blog in a <code>blog</code>
directory and install the gem dependencies that are already mentioned in
<code>Gemfile</code> using <code>bundle install</code>.</p>

<p>TIP: You can see all of the command line options that the Rails application
builder accepts by running <code>rails new -h</code>.</p>

<p>After you create the blog application, switch to its folder:</p>

<pre>$ cd blog</pre>

<p>The <code>blog</code> directory has a number of auto-generated files and
folders that make up the structure of a Rails application. Most of the work
in this tutorial will happen in the <code>app</code> folder, but here&#39;s
a basic rundown on the function of each of the files and folders that Rails
created by default:</p>

<p>| File/Folder | Purpose | | ———– | ——- | |app/|Contains the controllers,
models, views, helpers, mailers and assets for your application. You&#39;ll
focus on this folder for the remainder of this guide.| |bin/|Contains the
rails script that starts your app and can contain other scripts you use to
setup, deploy or run your application.| |config/|Configure your
application&#39;s routes, database, and more. This is covered in more
detail in <a href="configuring.html">Configuring Rails Applications</a>.|
|config.ru|Rack configuration for Rack based servers used to start the
application.| |db/|Contains your current database schema, as well as the
database migrations.| |Gemfile<br>Gemfile.lock|These files allow you to
specify what gem dependencies are needed for your Rails application. These
files are used by the Bundler gem. For more information about Bundler, see
the <a href="http://bundler.io">Bundler website</a>.| |lib/|Extended
modules for your application.| |log/|Application log files.| |public/|The
only folder seen by the world as-is. Contains static files and compiled
assets.| |Rakefile|This file locates and loads tasks that can be run from
the command line. The task definitions are defined throughout the
components of Rails. Rather than changing <a
href="../Rakefile.html">Rakefile</a>, you should add your own tasks by
adding files to the lib/tasks directory of your application.|
|README.rdoc|This is a brief instruction manual for your application. You
should edit this file to tell others what your application does, how to set
it up, and so on.| |test/|Unit tests, fixtures, and other test apparatus.
These are covered in <a href="testing.html">Testing Rails
Applications</a>.| |tmp/|Temporary files (like cache, pid, and session
files).| |vendor/|A place for all third-party code. In a typical Rails
application this includes vendored gems.|</p>

<h2 id="label-Hello-2C+Rails-21">Hello, Rails!<span><a href="#label-Hello-2C+Rails-21">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>To begin with, let&#39;s get some text up on screen quickly. To do this,
you need to get your Rails application server running.</p>

<h3 id="label-Starting+up+the+Web+Server">Starting up the Web Server<span><a href="#label-Starting+up+the+Web+Server">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>You actually have a functional Rails application already. To see it, you
need to start a web server on your development machine. You can do this by
running the following in the <code>blog</code> directory:</p>

<pre>$ bin/rails server</pre>

<p>TIP: If you are using Windows, you have to pass the scripts under the
<code>bin</code> folder directly to the Ruby interpreter e.g. <code>ruby
bin\rails server</code>.</p>

<p>TIP: Compiling CoffeeScript and JavaScript asset compression requires you
have a JavaScript runtime available on your system, in the absence of a
runtime you will see an <code>execjs</code> error during asset compilation.
Usually Mac OS X and Windows come with a JavaScript runtime installed.
Rails adds the <code>therubyracer</code> gem to the generated
<code>Gemfile</code> in a commented line for new apps and you can uncomment
if you need it. <code>therubyrhino</code> is the recommended runtime for
JRuby users and is added by default to the <code>Gemfile</code> in apps
generated under JRuby. You can investigate all the supported runtimes at <a
href="https://github.com/rails/execjs#readme">ExecJS</a>.</p>

<p>This will fire up WEBrick, a web server distributed with Ruby by default.
To see your application in action, open a browser window and navigate to <a
href="http://localhost:3000">localhost:3000</a>. You should see the Rails
default information page:</p>

<p><img src="images/getting_started/rails_welcome.png"></p>

<p>TIP: To stop the web server, hit Ctrl+C in the terminal window where
it&#39;s running. To verify the server has stopped you should see your
command prompt cursor again. For most UNIX-like systems including Mac OS X
this will be a dollar sign <code>$</code>. In development mode, Rails does
not generally require you to restart the server; changes you make in files
will be automatically picked up by the server.</p>

<p>The “Welcome aboard” page is the <em>smoke test</em> for a new Rails
application: it makes sure that you have your software configured correctly
enough to serve a page. You can also click on the <em>About your
application&#39;s environment</em> link to see a summary of your
application&#39;s environment.</p>

<h3 id="label-Say+-22Hello-22-2C+Rails">Say “Hello”, Rails<span><a href="#label-Say+-22Hello-22-2C+Rails">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>To get Rails saying “Hello”, you need to create at minimum a
<em>controller</em> and a <em>view</em>.</p>

<p>A controller&#39;s purpose is to receive specific requests for the
application. <em>Routing</em> decides which controller receives which
requests. Often, there is more than one route to each controller, and
different routes can be served by different <em>actions</em>. Each
action&#39;s purpose is to collect information to provide it to a view.</p>

<p>A view&#39;s purpose is to display this information in a human readable
format. An important distinction to make is that it is the
<em>controller</em>, not the view, where information is collected. The view
should just display that information. By default, view templates are
written in a language called eRuby (Embedded Ruby) which is processed by
the request cycle in Rails before being sent to the user.</p>

<p>To create a new controller, you will need to run the “controller” generator
and tell it you want a controller called “welcome” with an action called
“index”, just like this:</p>

<pre>$ bin/rails generate controller welcome index</pre>

<p>Rails will create several files and a route for you.</p>

<pre class="ruby"><span class="ruby-identifier">create</span>  <span class="ruby-identifier">app</span><span class="ruby-operator">/</span><span class="ruby-identifier">controllers</span><span class="ruby-operator">/</span><span class="ruby-identifier">welcome_controller</span>.<span class="ruby-identifier">rb</span>
 <span class="ruby-identifier">route</span>  <span class="ruby-identifier">get</span> <span class="ruby-string">&#39;welcome/index&#39;</span>
<span class="ruby-identifier">invoke</span>  <span class="ruby-identifier">erb</span>
<span class="ruby-identifier">create</span>    <span class="ruby-identifier">app</span><span class="ruby-operator">/</span><span class="ruby-identifier">views</span><span class="ruby-operator">/</span><span class="ruby-identifier">welcome</span>
<span class="ruby-identifier">create</span>    <span class="ruby-identifier">app</span><span class="ruby-operator">/</span><span class="ruby-identifier">views</span><span class="ruby-operator">/</span><span class="ruby-identifier">welcome</span><span class="ruby-operator">/</span><span class="ruby-identifier">index</span>.<span class="ruby-identifier">html</span>.<span class="ruby-identifier">erb</span>
<span class="ruby-identifier">invoke</span>  <span class="ruby-identifier">test_unit</span>
<span class="ruby-identifier">create</span>    <span class="ruby-identifier">test</span><span class="ruby-operator">/</span><span class="ruby-identifier">controllers</span><span class="ruby-operator">/</span><span class="ruby-identifier">welcome_controller_test</span>.<span class="ruby-identifier">rb</span>
<span class="ruby-identifier">invoke</span>  <span class="ruby-identifier">helper</span>
<span class="ruby-identifier">create</span>    <span class="ruby-identifier">app</span><span class="ruby-operator">/</span><span class="ruby-identifier">helpers</span><span class="ruby-operator">/</span><span class="ruby-identifier">welcome_helper</span>.<span class="ruby-identifier">rb</span>
<span class="ruby-identifier">invoke</span>  <span class="ruby-identifier">assets</span>
<span class="ruby-identifier">invoke</span>    <span class="ruby-identifier">coffee</span>
<span class="ruby-identifier">create</span>      <span class="ruby-identifier">app</span><span class="ruby-operator">/</span><span class="ruby-identifier">assets</span><span class="ruby-operator">/</span><span class="ruby-identifier">javascripts</span><span class="ruby-operator">/</span><span class="ruby-identifier">welcome</span>.<span class="ruby-identifier">js</span>.<span class="ruby-identifier">coffee</span>
<span class="ruby-identifier">invoke</span>    <span class="ruby-identifier">scss</span>
<span class="ruby-identifier">create</span>      <span class="ruby-identifier">app</span><span class="ruby-operator">/</span><span class="ruby-identifier">assets</span><span class="ruby-operator">/</span><span class="ruby-identifier">stylesheets</span><span class="ruby-operator">/</span><span class="ruby-identifier">welcome</span>.<span class="ruby-identifier">css</span>.<span class="ruby-identifier">scss</span>
</pre>

<p>Most important of these are of course the controller, located at
<code>app/controllers/welcome_controller.rb</code> and the view, located at
<code>app/views/welcome/index.html.erb</code>.</p>

<p>Open the <code>app/views/welcome/index.html.erb</code> file in your text
editor. Delete all of the existing code in the file, and replace it with
the following single line of code:</p>

<pre>&lt;h1&gt;Hello, Rails!&lt;/h1&gt;</pre>

<h3 id="label-Setting+the+Application+Home+Page">Setting the Application Home Page<span><a href="#label-Setting+the+Application+Home+Page">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Now that we have made the controller and view, we need to tell Rails when
we want “Hello, Rails!” to show up. In our case, we want it to show up when
we navigate to the root URL of our site, <a
href="http://localhost:3000">localhost:3000</a>. At the moment, “Welcome
aboard” is occupying that spot.</p>

<p>Next, you have to tell Rails where your actual home page is located.</p>

<p>Open the file <code>config/routes.rb</code> in your editor.</p>

<pre class="ruby"><span class="ruby-constant">Rails</span>.<span class="ruby-identifier">application</span>.<span class="ruby-identifier">routes</span>.<span class="ruby-identifier">draw</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">get</span> <span class="ruby-string">&#39;welcome/index&#39;</span>

  <span class="ruby-comment"># The priority is based upon order of creation:</span>
  <span class="ruby-comment"># first created -&gt; highest priority.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># You can have the root of your site routed with &quot;root&quot;</span>
  <span class="ruby-comment"># root &#39;welcome#index&#39;</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># ...</span>
</pre>

<p>This is your application&#39;s <em>routing file</em> which holds entries in
a special DSL (domain-specific language) that tells Rails how to connect
incoming requests to controllers and actions. This file contains many
sample routes on commented lines, and one of them actually shows you how to
connect the root of your site to a specific controller and action. Find the
line beginning with <code>root</code> and uncomment it. It should look
something like the following:</p>

<pre class="ruby"><span class="ruby-identifier">root</span> <span class="ruby-string">&#39;welcome#index&#39;</span>
</pre>

<p><code>root &#39;welcome#index&#39;</code> tells Rails to map requests to
the root of the application to the welcome controller&#39;s index action
and <code>get &#39;welcome/index&#39;</code> tells Rails to map requests to
<a
href="http://localhost:3000/welcome/index">localhost:3000/welcome/index</a>
to the welcome controller&#39;s index action. This was created earlier when
you ran the controller generator (<code>rails generate controller welcome
index</code>).</p>

<p>Launch the web server again if you stopped it to generate the controller
(<code>rails server</code>) and navigate to <a
href="http://localhost:3000">localhost:3000</a> in your browser. You&#39;ll
see the “Hello, Rails!” message you put into
<code>app/views/welcome/index.html.erb</code>, indicating that this new
route is indeed going to <code>WelcomeController</code>&#39;s
<code>index</code> action and is rendering the view correctly.</p>

<p>TIP: For more information about routing, refer to <a
href="routing.html">Rails Routing from the Outside In</a>.</p>

<h2 id="label-Getting+Up+and+Running">Getting Up and Running<span><a href="#label-Getting+Up+and+Running">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Now that you&#39;ve seen how to create a controller, an action and a view,
let&#39;s create something with a bit more substance.</p>

<p>In the Blog application, you will now create a new <em>resource</em>. A
resource is the term used for a collection of similar objects, such as
articles, people or animals. You can create, read, update and destroy items
for a resource and these operations are referred to as <em>CRUD</em>
operations.</p>

<p>Rails provides a <code>resources</code> method which can be used to declare
a standard REST resource. You need to add the <em>article resource</em> to
the <code>config/routes.rb</code> as follows:</p>

<pre class="ruby"><span class="ruby-constant">Rails</span>.<span class="ruby-identifier">application</span>.<span class="ruby-identifier">routes</span>.<span class="ruby-identifier">draw</span> <span class="ruby-keyword">do</span>

  <span class="ruby-identifier">resources</span> :<span class="ruby-identifier">articles</span>

  <span class="ruby-identifier">root</span> <span class="ruby-string">&#39;welcome#index&#39;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>If you run <code>rake routes</code>, you&#39;ll see that it has defined
routes for all the standard RESTful actions. The meaning of the prefix
column (and other columns) will be seen later, but for now notice that
Rails has inferred the singular form <code>article</code> and makes
meaningful use of the distinction.</p>

<pre>$ bin/rake routes
      Prefix Verb   URI Pattern                  Controller#Action
    articles GET    /articles(.:format)          articles#index
             POST   /articles(.:format)          articles#create
 new_article GET    /articles/new(.:format)      articles#new
edit_article GET    /articles/:id/edit(.:format) articles#edit
     article GET    /articles/:id(.:format)      articles#show
             PATCH  /articles/:id(.:format)      articles#update
             PUT    /articles/:id(.:format)      articles#update
             DELETE /articles/:id(.:format)      articles#destroy
        root GET    /                            welcome#index</pre>

<p>In the next section, you will add the ability to create new articles in
your application and be able to view them. This is the “C” and the “R” from
CRUD: creation and reading. The form for doing this will look like this:</p>

<p><img src="images/getting_started/new_article.png"></p>

<p>It will look a little basic for now, but that&#39;s ok. We&#39;ll look at
improving the styling for it afterwards.</p>

<h3 id="label-Laying+down+the+ground+work">Laying down the ground work<span><a href="#label-Laying+down+the+ground+work">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Firstly, you need a place within the application to create a new article. A
great place for that would be at <code>/articles/new</code>. With the route
already defined, requests can now be made to <code>/articles/new</code> in
the application. Navigate to <a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>
and you&#39;ll see a routing error:</p>

<p><img src="images/getting_started/routing_error_no_controller.png"></p>

<p>This error occurs because the route needs to have a controller defined in
order to serve the request. The solution to this particular problem is
simple: create a controller called <code>ArticlesController</code>. You can
do this by running this command:</p>

<pre>$ bin/rails g controller articles</pre>

<p>If you open up the newly generated
<code>app/controllers/articles_controller.rb</code> you&#39;ll see a fairly
empty controller:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ArticlesController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
<span class="ruby-keyword">end</span>
</pre>

<p>A controller is simply a class that is defined to inherit from
<code>ApplicationController</code>. It&#39;s inside this class that
you&#39;ll define methods that will become the actions for this controller.
These actions will perform CRUD operations on the articles within our
system.</p>

<p>NOTE: There are <code>public</code>, <code>private</code> and
<code>protected</code> methods in Ruby, but only <code>public</code>
methods can be actions for controllers. For more details check out <a
href="http://www.ruby-doc.org/docs/ProgrammingRuby/">Programming Ruby</a>.</p>

<p>If you refresh <a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>
now, you&#39;ll get a new error:</p>

<p><img src="images/getting_started/unknown_action_new_for_articles.png"></p>

<p>This error indicates that Rails cannot find the <code>new</code> action
inside the <code>ArticlesController</code> that you just generated. This is
because when controllers are generated in Rails they are empty by default,
unless you tell it your wanted actions during the generation process.</p>

<p>To manually define an action inside a controller, all you need to do is to
define a new method inside the controller. Open
<code>app/controllers/articles_controller.rb</code> and inside the
<code>ArticlesController</code> class, define a <code>new</code> method so
that the controller now looks like this:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ArticlesController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>With the <code>new</code> method defined in
<code>ArticlesController</code>, if you refresh <a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>
you&#39;ll see another error:</p>

<p><img src="images/getting_started/template_is_missing_articles_new.png"></p>

<p>You&#39;re getting this error now because Rails expects plain actions like
this one to have views associated with them to display their information.
With no view available, Rails errors out.</p>

<p>In the above image, the bottom line has been truncated. Let&#39;s see what
the full thing looks like:</p>

<blockquote>
<p>Missing template articles/new, application/new with {<a
href=":en">locale:</a>, <a href=":html">formats:</a>, handlers:[:erb,
:builder, :coffee]}. Searched in: * “/path/to/blog/app/views”</p>
</blockquote>

<p>That&#39;s quite a lot of text! Let&#39;s quickly go through and understand
what each part of it does.</p>

<p>The first part identifies what template is missing. In this case, it&#39;s
the <code>articles/new</code> template. Rails will first look for this
template. If not found, then it will attempt to load a template called
<code>application/new</code>. It looks for one here because the
<code>ArticlesController</code> inherits from
<code>ApplicationController</code>.</p>

<p>The next part of the message contains a hash. The <code>:locale</code> key
in this hash simply indicates what spoken language template should be
retrieved. By default, this is the English - or “en” - template. The next
key, <code>:formats</code> specifies the format of template to be served in
response. The default format is <code>:html</code>, and so Rails is looking
for an HTML template. The final key, <code>:handlers</code>, is telling us
what <em>template handlers</em> could be used to render our template.
<code>:erb</code> is most commonly used for HTML templates,
<code>:builder</code> is used for XML templates, and <code>:coffee</code>
uses CoffeeScript to build JavaScript templates.</p>

<p>The final part of this message tells us where Rails has looked for the
templates. Templates within a basic Rails application like this are kept in
a single location, but in more complex applications it could be many
different paths.</p>

<p>The simplest template that would work in this case would be one located at
<code>app/views/articles/new.html.erb</code>. The extension of this file
name is key: the first extension is the <em>format</em> of the template,
and the second extension is the <em>handler</em> that will be used. Rails
is attempting to find a template called <code>articles/new</code> within
<code>app/views</code> for the application. The format for this template
can only be <code>html</code> and the handler must be one of
<code>erb</code>, <code>builder</code> or <code>coffee</code>. Because you
want to create a new HTML form, you will be using the <code>ERB</code>
language. Therefore the file should be called
<code>articles/new.html.erb</code> and needs to be located inside the
<code>app/views</code> directory of the application.</p>

<p>Go ahead now and create a new file at
<code>app/views/articles/new.html.erb</code> and write this content in it:</p>

<pre>&lt;h1&gt;New Article&lt;/h1&gt;</pre>

<p>When you refresh <a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>
you&#39;ll now see that the page has a title. The route, controller, action
and view are now working harmoniously! It&#39;s time to create the form for
a new article.</p>

<h3 id="label-The+first+form">The first form<span><a href="#label-The+first+form">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>To create a form within this template, you will use a <em>form
builder</em>. The primary form builder for Rails is provided by a helper
method called <code>form_for</code>. To use this method, add this code into
<code>app/views/articles/new.html.erb</code>:</p>

<pre>&lt;%= form_for :article do |f| %&gt;
  &lt;p&gt;
    &lt;%= f.label :title %&gt;&lt;br&gt;
    &lt;%= f.text_field :title %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.label :text %&gt;&lt;br&gt;
    &lt;%= f.text_area :text %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;
&lt;% end %&gt;</pre>

<p>If you refresh the page now, you&#39;ll see the exact same form as in the
example. Building forms in Rails is really just that easy!</p>

<p>When you call <code>form_for</code>, you pass it an identifying object for
this form. In this case, it&#39;s the symbol <code>:article</code>. This
tells the <code>form_for</code> helper what this form is for. Inside the
block for this method, the <code>FormBuilder</code> object - represented by
<code>f</code> - is used to build two labels and two text fields, one each
for the title and text of an article. Finally, a call to
<code>submit</code> on the <code>f</code> object will create a submit
button for the form.</p>

<p>There&#39;s one problem with this form though. If you inspect the HTML that
is generated, by viewing the source of the page, you will see that the
<code>action</code> attribute for the form is pointing at
<code>/articles/new</code>. This is a problem because this route goes to
the very page that you&#39;re on right at the moment, and that route should
only be used to display the form for a new article.</p>

<p>The form needs to use a different URL in order to go somewhere else. This
can be done quite simply with the <code>:url</code> option of
<code>form_for</code>. Typically in Rails, the action that is used for new
form submissions like this is called “create”, and so the form should be
pointed to that action.</p>

<p>Edit the <code>form_for</code> line inside
<code>app/views/articles/new.html.erb</code> to look like this:</p>

<pre>&lt;%= form_for :article, url: articles_path do |f| %&gt;</pre>

<p>In this example, the <code>articles_path</code> helper is passed to the
<code>:url</code> option. To see what Rails will do with this, we look back
at the output of <code>rake routes</code>:</p>

<pre>$ bin/rake routes
      Prefix Verb   URI Pattern                  Controller#Action
    articles GET    /articles(.:format)          articles#index
             POST   /articles(.:format)          articles#create
 new_article GET    /articles/new(.:format)      articles#new
edit_article GET    /articles/:id/edit(.:format) articles#edit
     article GET    /articles/:id(.:format)      articles#show
             PATCH  /articles/:id(.:format)      articles#update
             PUT    /articles/:id(.:format)      articles#update
             DELETE /articles/:id(.:format)      articles#destroy
        root GET    /                            welcome#index</pre>

<p>The <code>articles_path</code> helper tells Rails to point the form to the
URI Pattern associated with the <code>articles</code> prefix; and the form
will (by default) send a <code>POST</code> request to that route. This is
associated with the <code>create</code> action of the current controller,
the <code>ArticlesController</code>.</p>

<p>With the form and its associated route defined, you will be able to fill in
the form and then click the submit button to begin the process of creating
a new article, so go ahead and do that. When you submit the form, you
should see a familiar error:</p>

<p><img src="images/getting_started/unknown_action_create_for_articles.png"></p>

<p>You now need to create the <code>create</code> action within the
<code>ArticlesController</code> for this to work.</p>

<h3 id="label-Creating+articles">Creating articles<span><a href="#label-Creating+articles">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>To make the “Unknown action” go away, you can define a <code>create</code>
action within the <code>ArticlesController</code> class in
<code>app/controllers/articles_controller.rb</code>, underneath the
<code>new</code> action, as shown:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ArticlesController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>If you re-submit the form now, you&#39;ll see another familiar error: a
template is missing. That&#39;s ok, we can ignore that for now. What the
<code>create</code> action should be doing is saving our new article to the
database.</p>

<p>When a form is submitted, the fields of the form are sent to Rails as
<em>parameters</em>. These parameters can then be referenced inside the
controller actions, typically to perform a particular task. To see what
these parameters look like, change the <code>create</code> action to this:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-identifier">render</span> <span class="ruby-identifier">plain</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>[:<span class="ruby-identifier">article</span>].<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The <code>render</code> method here is taking a very simple hash with a key
of <code>plain</code> and value of <code>params[:article].inspect</code>.
The <code>params</code> method is the object which represents the
parameters (or fields) coming in from the form. The <code>params</code>
method returns an <code>ActiveSupport::HashWithIndifferentAccess</code>
object, which allows you to access the keys of the hash using either
strings or symbols. In this situation, the only parameters that matter are
the ones from the form.</p>

<p>TIP: Ensure you have a firm grasp of the <code>params</code> method, as
you&#39;ll use it fairly regularly. Let&#39;s consider an example URL:
<strong><a
href="http://www.example.com/?username=dhh&email=dhh@email.com">www.example.com/?username=dhh&email=dhh@email.com</a></strong>.
In this URL, <code>params[:username]</code> would equal “dhh” and
<code>params[:email]</code> would equal “dhh@email.com”.</p>

<p>If you re-submit the form one more time you&#39;ll now no longer get the
missing template error. Instead, you&#39;ll see something that looks like
the following:</p>

<pre class="ruby">{<span class="ruby-string">&quot;title&quot;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;First article!&quot;</span>, <span class="ruby-string">&quot;text&quot;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;This is my first article.&quot;</span>}
</pre>

<p>This action is now displaying the parameters for the article that are
coming in from the form. However, this isn&#39;t really all that helpful.
Yes, you can see the parameters but nothing in particular is being done
with them.</p>

<h3 id="label-Creating+the+Article+model">Creating the Article model<span><a href="#label-Creating+the+Article+model">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Models in Rails use a singular name, and their corresponding database
tables use a plural name. Rails provides a generator for creating models,
which most Rails developers tend to use when creating new models. To create
the new model, run this command in your terminal:</p>

<pre>$ bin/rails generate model Article title:string text:text</pre>

<p>With that command we told Rails that we want a <code>Article</code> model,
together with a <em>title</em> attribute of type string, and a
<em>text</em> attribute of type text. Those attributes are automatically
added to the <code>articles</code> table in the database and mapped to the
<code>Article</code> model.</p>

<p>Rails responded by creating a bunch of files. For now, we&#39;re only
interested in <code>app/models/article.rb</code> and
<code>db/migrate/20140120191729_create_articles.rb</code> (your name could
be a bit different). The latter is responsible for creating the database
structure, which is what we&#39;ll look at next.</p>

<p>TIP: Active Record is smart enough to automatically map column names to
model attributes, which means you don&#39;t have to declare attributes
inside Rails models, as that will be done automatically by Active Record.</p>

<h3 id="label-Running+a+Migration">Running a Migration<span><a href="#label-Running+a+Migration">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>As we&#39;ve just seen, <code>rails generate model</code> created a
<em>database migration</em> file inside the <code>db/migrate</code>
directory. Migrations are Ruby classes that are designed to make it simple
to create and modify database tables. Rails uses rake commands to run
migrations, and it&#39;s possible to undo a migration after it&#39;s been
applied to your database. Migration filenames include a timestamp to ensure
that they&#39;re processed in the order that they were created.</p>

<p>If you look in the
<code>db/migrate/20140120191729_create_articles.rb</code> file (remember,
yours will have a slightly different name), here&#39;s what you&#39;ll
find:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">CreateArticles</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">change</span>
    <span class="ruby-identifier">create_table</span> :<span class="ruby-identifier">articles</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">string</span> :<span class="ruby-identifier">title</span>
      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">text</span> :<span class="ruby-identifier">text</span>

      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">timestamps</span> <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The above migration creates a method named <code>change</code> which will
be called when you run this migration. The action defined in this method is
also reversible, which means Rails knows how to reverse the change made by
this migration, in case you want to reverse it later. When you run this
migration it will create an <code>articles</code> table with one string
column and a text column. It also creates two timestamp fields to allow
Rails to track article creation and update times.</p>

<p>TIP: For more information about migrations, refer to <a
href="migrations.html">Rails Database Migrations</a>.</p>

<p>At this point, you can use a rake command to run the migration:</p>

<pre>$ bin/rake db:migrate</pre>

<p>Rails will execute this migration command and tell you it created the
Articles table.</p>

<pre>==  CreateArticles: migrating ==================================================
-- create_table(:articles)
   -&gt; 0.0019s
==  CreateArticles: migrated (0.0020s) =========================================</pre>

<p>NOTE. Because you&#39;re working in the development environment by default,
this command will apply to the database defined in the
<code>development</code> section of your <code>config/database.yml</code>
file. If you would like to execute migrations in another environment, for
instance in production, you must explicitly pass it when invoking the
command: <code>rake db:migrate RAILS_ENV=production</code>.</p>

<h3 id="label-Saving+data+in+the+controller">Saving data in the controller<span><a href="#label-Saving+data+in+the+controller">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Back in <code>ArticlesController</code>, we need to change the
<code>create</code> action to use the new <code>Article</code> model to
save the data in the database. Open
<code>app/controllers/articles_controller.rb</code> and change the
<code>create</code> action to look like this:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">article</span>])

  <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Here&#39;s what&#39;s going on: every Rails model can be initialized with
its respective attributes, which are automatically mapped to the respective
database columns. In the first line we do just that (remember that
<code>params[:article]</code> contains the attributes we&#39;re interested
in). Then, <code>@article.save</code> is responsible for saving the model
in the database. Finally, we redirect the user to the <code>show</code>
action, which we&#39;ll define later.</p>

<p>TIP: You might be wondering why the <code>A</code> in
<code>Article.new</code> is capitalized above, whereas most other
references to articles in this guide have used lowercase. In this context,
we are referring to the class named <code>Article</code> that is defined in
<code>\models\article.rb</code>. Class names in Ruby must begin with a
capital letter.</p>

<p>TIP: As we&#39;ll see later, <code>@article.save</code> returns a boolean
indicating whether the article was saved or not.</p>

<p>If you now go to <a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>
you&#39;ll <em>almost</em> be able to create an article. Try it! You should
get an error that looks like this:</p>

<p><img src="images/getting_started/forbidden_attributes_for_new_article.png"></p>

<p>Rails has several security features that help you write secure
applications, and you&#39;re running into one of them now. This one is
called <a href="action_controller_overview.html#strong-parameters">strong
parameters</a>, which requires us to tell Rails exactly which parameters
are allowed into our controller actions.</p>

<p>Why do you have to bother? The ability to grab and automatically assign all
controller parameters to your model in one shot makes the programmer&#39;s
job easier, but this convenience also allows malicious use. What if a
request to the server was crafted to look like a new article form submit
but also included extra fields with values that violated your applications
integrity? They would be &#39;mass assigned&#39; into your model and then
into the database along with the good stuff - potentially breaking your
application or worse.</p>

<p>We have to whitelist our controller parameters to prevent wrongful mass
assignment. In this case, we want to both allow and require the
<code>title</code> and <code>text</code> parameters for valid use of
<code>create</code>. The syntax for this introduces <code>require</code>
and <code>permit</code>. The change will involve one line in the
<code>create</code> action:</p>

<pre class="ruby"><span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>.<span class="ruby-identifier">require</span>(:<span class="ruby-identifier">article</span>).<span class="ruby-identifier">permit</span>(:<span class="ruby-identifier">title</span>, :<span class="ruby-identifier">text</span>))
</pre>

<p>This is often factored out into its own method so it can be reused by
multiple actions in the same controller, for example <code>create</code>
and <code>update</code>. Above and beyond mass assignment issues, the
method is often made <code>private</code> to make sure it can&#39;t be
called outside its intended context. Here is the result:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">article_params</span>)

  <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">private</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">article_params</span>
    <span class="ruby-identifier">params</span>.<span class="ruby-identifier">require</span>(:<span class="ruby-identifier">article</span>).<span class="ruby-identifier">permit</span>(:<span class="ruby-identifier">title</span>, :<span class="ruby-identifier">text</span>)
  <span class="ruby-keyword">end</span>
</pre>

<p>TIP: For more information, refer to the reference above and <a
href="http://weblog.rubyonrails.org/2012/3/21/strong-parameters/">this blog
article about Strong Parameters</a>.</p>

<h3 id="label-Showing+Articles">Showing Articles<span><a href="#label-Showing+Articles">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you submit the form again now, Rails will complain about not finding the
<code>show</code> action. That&#39;s not very useful though, so let&#39;s
add the <code>show</code> action before proceeding.</p>

<p>As we have seen in the output of <code>rake routes</code>, the route for
<code>show</code> action is as follows:</p>

<pre>article GET    /articles/:id(.:format)      articles#show</pre>

<p>The special syntax <code>:id</code> tells rails that this route expects an
<code>:id</code> parameter, which in our case will be the id of the
article.</p>

<p>As we did before, we need to add the <code>show</code> action in
<code>app/controllers/articles_controller.rb</code> and its respective
view.</p>

<p>NOTE: A frequent practice is to place the standard CRUD actions in each
controller in the following order: <code>index</code>, <code>show</code>,
<code>new</code>, <code>edit</code>, <code>create</code>,
<code>update</code> and <code>destroy</code>. You may use any order you
choose, but keep in mind that these are public methods; as mentioned
earlier in this guide, they must be placed before any private or protected
method in the controller in order to work.</p>

<p>Given that, let&#39;s add the <code>show</code> action, as follows:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ArticlesController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">show</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># snipped for brevity</span>
</pre>

<p>A couple of things to note. We use <code>Article.find</code> to find the
article we&#39;re interested in, passing in <code>params[:id]</code> to get
the <code>:id</code> parameter from the request. We also use an instance
variable (prefixed with <code>@</code>) to hold a reference to the article
object. We do this because Rails will pass all instance variables to the
view.</p>

<p>Now, create a new file <code>app/views/articles/show.html.erb</code> with
the following content:</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Title:&lt;/strong&gt;
  &lt;%= @article.title %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Text:&lt;/strong&gt;
  &lt;%= @article.text %&gt;
&lt;/p&gt;</pre>

<p>With this change, you should finally be able to create new articles. Visit
<a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>
and give it a try!</p>

<p><img src="images/getting_started/show_action_for_articles.png"></p>

<h3 id="label-Listing+all+articles">Listing all articles<span><a href="#label-Listing+all+articles">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>We still need a way to list all our articles, so let&#39;s do that. The
route for this as per output of <code>rake routes</code> is:</p>

<pre>articles GET    /articles(.:format)          articles#index</pre>

<p>Add the corresponding <code>index</code> action for that route inside the
<code>ArticlesController</code> in the
<code>app/controllers/articles_controller.rb</code> file. When we write an
<code>index</code> action, the usual practice is to place it as the first
method in the controller. Let&#39;s do it:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ArticlesController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
    <span class="ruby-ivar">@articles</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">show</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># snipped for brevity</span>
</pre>

<p>And then finally, add the view for this action, located at
<code>app/views/articles/index.html.erb</code>:</p>

<pre>&lt;h1&gt;Listing articles&lt;/h1&gt;

&lt;table&gt;
  &lt;tr&gt;
    &lt;th&gt;Title&lt;/th&gt;
    &lt;th&gt;Text&lt;/th&gt;
  &lt;/tr&gt;

  &lt;% @articles.each do |article| %&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;%= article.title %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= article.text %&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;% end %&gt;
&lt;/table&gt;</pre>

<p>Now if you go to <a
href="http://localhost:3000/articles">localhost:3000/articles</a> you will
see a list of all the articles that you have created.</p>

<h3 id="label-Adding+links">Adding links<span><a href="#label-Adding+links">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>You can now create, show, and list articles. Now let&#39;s add some links
to navigate through pages.</p>

<p>Open <code>app/views/welcome/index.html.erb</code> and modify it as
follows:</p>

<pre>&lt;h1&gt;Hello, Rails!&lt;/h1&gt;
&lt;%= link_to &#39;My Blog&#39;, controller: &#39;articles&#39; %&gt;</pre>

<p>The <code>link_to</code> method is one of Rails&#39; built-in view helpers.
It creates a hyperlink based on text to display and where to go - in this
case, to the path for articles.</p>

<p>Let&#39;s add links to the other views as well, starting with adding this
“New Article” link to <code>app/views/articles/index.html.erb</code>,
placing it above the <code>&lt;table&gt;</code> tag:</p>

<pre>&lt;%= link_to &#39;New article&#39;, new_article_path %&gt;</pre>

<p>This link will allow you to bring up the form that lets you create a new
article.</p>

<p>Now, add another link in <code>app/views/articles/new.html.erb</code>,
underneath the form, to go back to the <code>index</code> action:</p>

<pre>&lt;%= form_for :article, url: articles_path do |f| %&gt;
  ...
&lt;% end %&gt;

&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>Finally, add a link to the <code>app/views/articles/show.html.erb</code>
template to go back to the <code>index</code> action as well, so that
people who are viewing a single article can go back and view the whole list
again:</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Title:&lt;/strong&gt;
  &lt;%= @article.title %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Text:&lt;/strong&gt;
  &lt;%= @article.text %&gt;
&lt;/p&gt;

&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>TIP: If you want to link to an action in the same controller, you don&#39;t
need to specify the <code>:controller</code> option, as Rails will use the
current controller by default.</p>

<p>TIP: In development mode (which is what you&#39;re working in by default),
Rails reloads your application with every browser request, so there&#39;s
no need to stop and restart the web server when a change is made.</p>

<h3 id="label-Adding+Some+Validation">Adding Some Validation<span><a href="#label-Adding+Some+Validation">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The model file, <code>app/models/article.rb</code> is about as simple as it
can get:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Article</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
<span class="ruby-keyword">end</span>
</pre>

<p>There isn&#39;t much to this file - but note that the <code>Article</code>
class inherits from <code>ActiveRecord::Base</code>. Active Record supplies
a great deal of functionality to your Rails models for free, including
basic database CRUD (Create, Read, Update, Destroy) operations, data
validation, as well as sophisticated search support and the ability to
relate multiple models to one another.</p>

<p>Rails includes methods to help you validate the data that you send to
models. Open the <code>app/models/article.rb</code> file and edit it:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Article</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">validates</span> :<span class="ruby-identifier">title</span>, <span class="ruby-identifier">presence</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
                    <span class="ruby-identifier">length</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">minimum</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span> }
<span class="ruby-keyword">end</span>
</pre>

<p>These changes will ensure that all articles have a title that is at least
five characters long. Rails can validate a variety of conditions in a
model, including the presence or uniqueness of columns, their format, and
the existence of associated objects. Validations are covered in detail in
<a href="active_record_validations.html">Active Record Validations</a>.</p>

<p>With the validation now in place, when you call <code>@article.save</code>
on an invalid article, it will return <code>false</code>. If you open
<code>app/controllers/articles_controller.rb</code> again, you&#39;ll
notice that we don&#39;t check the result of calling
<code>@article.save</code> inside the <code>create</code> action. If
<code>@article.save</code> fails in this situation, we need to show the
form back to the user. To do this, change the <code>new</code> and
<code>create</code> actions inside
<code>app/controllers/articles_controller.rb</code> to these:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">article_params</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">save</span>
    <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">render</span> <span class="ruby-string">&#39;new&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">private</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">article_params</span>
    <span class="ruby-identifier">params</span>.<span class="ruby-identifier">require</span>(:<span class="ruby-identifier">article</span>).<span class="ruby-identifier">permit</span>(:<span class="ruby-identifier">title</span>, :<span class="ruby-identifier">text</span>)
  <span class="ruby-keyword">end</span>
</pre>

<p>The <code>new</code> action is now creating a new instance variable called
<code>@article</code>, and you&#39;ll see why that is in just a few
moments.</p>

<p>Notice that inside the <code>create</code> action we use
<code>render</code> instead of <code>redirect_to</code> when
<code>save</code> returns <code>false</code>. The <code>render</code>
method is used so that the <code>@article</code> object is passed back to
the <code>new</code> template when it is rendered. This rendering is done
within the same request as the form submission, whereas the
<code>redirect_to</code> will tell the browser to issue another request.</p>

<p>If you reload <a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>
and try to save an article without a title, Rails will send you back to the
form, but that&#39;s not very useful. You need to tell the user that
something went wrong. To do that, you&#39;ll modify
<code>app/views/articles/new.html.erb</code> to check for error messages:</p>

<pre>&lt;%= form_for :article, url: articles_path do |f| %&gt;

  &lt;% if @article.errors.any? %&gt;
    &lt;div id=&quot;error_explanation&quot;&gt;
      &lt;h2&gt;
        &lt;%= pluralize(@article.errors.count, &quot;error&quot;) %&gt; prohibited
        this article from being saved:
      &lt;/h2&gt;
      &lt;ul&gt;
        &lt;% @article.errors.full_messages.each do |msg| %&gt;
          &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;% end %&gt;

  &lt;p&gt;
    &lt;%= f.label :title %&gt;&lt;br&gt;
    &lt;%= f.text_field :title %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.label :text %&gt;&lt;br&gt;
    &lt;%= f.text_area :text %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;

&lt;% end %&gt;

&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>A few things are going on. We check if there are any errors with
<code>@article.errors.any?</code>, and in that case we show a list of all
errors with <code>@article.errors.full_messages</code>.</p>

<p><code>pluralize</code> is a rails helper that takes a number and a string
as its arguments. If the number is greater than one, the string will be
automatically pluralized.</p>

<p>The reason why we added <code>@article = Article.new</code> in the
<code>ArticlesController</code> is that otherwise <code>@article</code>
would be <code>nil</code> in our view, and calling
<code>@article.errors.any?</code> would throw an error.</p>

<p>TIP: Rails automatically wraps fields that contain an error with a div with
class <code>field_with_errors</code>. You can define a css rule to make
them standout.</p>

<p>Now you&#39;ll get a nice error message when saving an article without
title when you attempt to do just that on the new article form <a
href="http://localhost:3000/articles/new">localhost:3000/articles/new</a>:</p>

<p><img src="images/getting_started/form_with_errors.png"></p>

<h3 id="label-Updating+Articles">Updating Articles<span><a href="#label-Updating+Articles">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>We&#39;ve covered the “CR” part of CRUD. Now let&#39;s focus on the “U”
part, updating articles.</p>

<p>The first step we&#39;ll take is adding an <code>edit</code> action to the
<code>ArticlesController</code>, generally between the <code>new</code> and
<code>create</code> actions, as shown:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">def</span> <span class="ruby-identifier">edit</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">article_params</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">save</span>
    <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">render</span> <span class="ruby-string">&#39;new&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The view will contain a form similar to the one we used when creating new
articles. Create a file called
<code>app/views/articles/edit.html.erb</code> and make it look as follows:</p>

<pre>&lt;h1&gt;Editing article&lt;/h1&gt;

&lt;%= form_for :article, url: article_path(@article), method: :patch do |f| %&gt;

  &lt;% if @article.errors.any? %&gt;
    &lt;div id=&quot;error_explanation&quot;&gt;
      &lt;h2&gt;
        &lt;%= pluralize(@article.errors.count, &quot;error&quot;) %&gt; prohibited
        this article from being saved:
      &lt;/h2&gt;
      &lt;ul&gt;
        &lt;% @article.errors.full_messages.each do |msg| %&gt;
          &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;% end %&gt;

  &lt;p&gt;
    &lt;%= f.label :title %&gt;&lt;br&gt;
    &lt;%= f.text_field :title %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.label :text %&gt;&lt;br&gt;
    &lt;%= f.text_area :text %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;

&lt;% end %&gt;

&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>This time we point the form to the <code>update</code> action, which is not
defined yet but will be very soon.</p>

<p>The <code>method: :patch</code> option tells Rails that we want this form
to be submitted via the <code>PATCH</code> HTTP method which is the HTTP
method you&#39;re expected to use to <strong>update</strong> resources
according to the REST protocol.</p>

<p>The first parameter of <code>form_for</code> can be an object, say,
<code>@article</code> which would cause the helper to fill in the form with
the fields of the object. Passing in a symbol (<code>:article</code>) with
the same name as the instance variable (<code>@article</code>) also
automagically leads to the same behavior. This is what is happening here.
More details can be found in <a
href="http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for">form_for
documentation</a>.</p>

<p>Next, we need to create the <code>update</code> action in
<code>app/controllers/articles_controller.rb</code>. Add it between the
<code>create</code> action and the <code>private</code> method:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">article_params</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">save</span>
    <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">render</span> <span class="ruby-string">&#39;new&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">article_params</span>)
    <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">render</span> <span class="ruby-string">&#39;edit&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">private</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">article_params</span>
    <span class="ruby-identifier">params</span>.<span class="ruby-identifier">require</span>(:<span class="ruby-identifier">article</span>).<span class="ruby-identifier">permit</span>(:<span class="ruby-identifier">title</span>, :<span class="ruby-identifier">text</span>)
  <span class="ruby-keyword">end</span>
</pre>

<p>The new method, <code>update</code>, is used when you want to update a
record that already exists, and it accepts a hash containing the attributes
that you want to update. As before, if there was an error updating the
article we want to show the form back to the user.</p>

<p>We reuse the <code>article_params</code> method that we defined earlier for
the create action.</p>

<p>TIP: You don&#39;t need to pass all attributes to <code>update</code>. For
example, if you&#39;d call <code>@article.update(title: &#39;A new
title&#39;)</code> Rails would only update the <code>title</code>
attribute, leaving all other attributes untouched.</p>

<p>Finally, we want to show a link to the <code>edit</code> action in the list
of all the articles, so let&#39;s add that now to
<code>app/views/articles/index.html.erb</code> to make it appear next to
the “Show” link:</p>

<pre>&lt;table&gt;
  &lt;tr&gt;
    &lt;th&gt;Title&lt;/th&gt;
    &lt;th&gt;Text&lt;/th&gt;
    &lt;th colspan=&quot;2&quot;&gt;&lt;/th&gt;
  &lt;/tr&gt;

  &lt;% @articles.each do |article| %&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;%= article.title %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= article.text %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= link_to &#39;Show&#39;, article_path(article) %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= link_to &#39;Edit&#39;, edit_article_path(article) %&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;% end %&gt;
&lt;/table&gt;</pre>

<p>And we&#39;ll also add one to the
<code>app/views/articles/show.html.erb</code> template as well, so that
there&#39;s also an “Edit” link on an article&#39;s page. Add this at the
bottom of the template:</p>

<pre>...

&lt;%= link_to &#39;Edit&#39;, edit_article_path(@article) %&gt; |
&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>And here&#39;s how our app looks so far:</p>

<p><img src="images/getting_started/index_action_with_edit_link.png"></p>

<h3 id="label-Using+partials+to+clean+up+duplication+in+views">Using partials to clean up duplication in views<span><a href="#label-Using+partials+to+clean+up+duplication+in+views">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Our <code>edit</code> page looks very similar to the <code>new</code> page;
in fact, they both share the same code for displaying the form. Let&#39;s
remove this duplication by using a view partial. By convention, partial
files are prefixed with an underscore.</p>

<p>TIP: You can read more about partials in the <a
href="layouts_and_rendering.html">Layouts and Rendering in Rails</a> guide.</p>

<p>Create a new file <code>app/views/articles/_form.html.erb</code> with the
following content:</p>

<pre>&lt;%= form_for @article do |f| %&gt;

  &lt;% if @article.errors.any? %&gt;
    &lt;div id=&quot;error_explanation&quot;&gt;
      &lt;h2&gt;
        &lt;%= pluralize(@article.errors.count, &quot;error&quot;) %&gt; prohibited
        this article from being saved:
      &lt;/h2&gt;
      &lt;ul&gt;
        &lt;% @article.errors.full_messages.each do |msg| %&gt;
          &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;% end %&gt;

  &lt;p&gt;
    &lt;%= f.label :title %&gt;&lt;br&gt;
    &lt;%= f.text_field :title %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.label :text %&gt;&lt;br&gt;
    &lt;%= f.text_area :text %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;

&lt;% end %&gt;</pre>

<p>Everything except for the <code>form_for</code> declaration remained the
same. The reason we can use this shorter, simpler <code>form_for</code>
declaration to stand in for either of the other forms is that
<code>@article</code> is a <em>resource</em> corresponding to a full set of
RESTful routes, and Rails is able to infer which URI and method to use. For
more information about this use of <code>form_for</code>, see <a
href="http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for-label-Resource-oriented+style">Resource-oriented
style</a>.</p>

<p>Now, let&#39;s update the <code>app/views/articles/new.html.erb</code> view
to use this new partial, rewriting it completely:</p>

<pre>&lt;h1&gt;New article&lt;/h1&gt;

&lt;%= render &#39;form&#39; %&gt;

&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>Then do the same for the <code>app/views/articles/edit.html.erb</code>
view:</p>

<pre>&lt;h1&gt;Edit article&lt;/h1&gt;

&lt;%= render &#39;form&#39; %&gt;

&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<h3 id="label-Deleting+Articles">Deleting Articles<span><a href="#label-Deleting+Articles">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>We&#39;re now ready to cover the “D” part of CRUD, deleting articles from
the database. Following the REST convention, the route for deleting
articles as per output of <code>rake routes</code> is:</p>

<pre class="ruby"><span class="ruby-constant">DELETE</span> <span class="ruby-regexp">/articles/</span><span class="ruby-operator">:</span><span class="ruby-identifier">id</span>(.:<span class="ruby-identifier">format</span>)      <span class="ruby-identifier">articles</span><span class="ruby-comment">#destroy</span>
</pre>

<p>The <code>delete</code> routing method should be used for routes that
destroy resources. If this was left as a typical <code>get</code> route, it
could be possible for people to craft malicious URLs like this:</p>

<pre>&lt;a href=&#39;http://example.com/articles/1/destroy&#39;&gt;look at this cat!&lt;/a&gt;</pre>

<p>We use the <code>delete</code> method for destroying resources, and this
route is mapped to the <code>destroy</code> action inside
<code>app/controllers/articles_controller.rb</code>, which doesn&#39;t
exist yet. The <code>destroy</code> method is generally the last CRUD
action in the controller, and like the other public CRUD actions, it must
be placed before any <code>private</code> or <code>protected</code>
methods. Let&#39;s add it:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy</span>
  <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
  <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">destroy</span>

  <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">articles_path</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The complete <code>ArticlesController</code> in the
<code>app/controllers/articles_controller.rb</code> file should now look
like this:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ArticlesController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
    <span class="ruby-ivar">@articles</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">show</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">edit</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">article_params</span>)

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">save</span>
      <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">render</span> <span class="ruby-string">&#39;new&#39;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">article_params</span>)
      <span class="ruby-identifier">redirect_to</span> <span class="ruby-ivar">@article</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">render</span> <span class="ruby-string">&#39;edit&#39;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
    <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">destroy</span>

    <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">articles_path</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">private</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">article_params</span>
      <span class="ruby-identifier">params</span>.<span class="ruby-identifier">require</span>(:<span class="ruby-identifier">article</span>).<span class="ruby-identifier">permit</span>(:<span class="ruby-identifier">title</span>, :<span class="ruby-identifier">text</span>)
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>You can call <code>destroy</code> on Active Record objects when you want to
delete them from the database. Note that we don&#39;t need to add a view
for this action since we&#39;re redirecting to the <code>index</code>
action.</p>

<p>Finally, add a &#39;Destroy&#39; link to your <code>index</code> action
template (<code>app/views/articles/index.html.erb</code>) to wrap
everything together.</p>

<pre>&lt;h1&gt;Listing Articles&lt;/h1&gt;
&lt;%= link_to &#39;New article&#39;, new_article_path %&gt;
&lt;table&gt;
  &lt;tr&gt;
    &lt;th&gt;Title&lt;/th&gt;
    &lt;th&gt;Text&lt;/th&gt;
    &lt;th colspan=&quot;3&quot;&gt;&lt;/th&gt;
  &lt;/tr&gt;

  &lt;% @articles.each do |article| %&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;%= article.title %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= article.text %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= link_to &#39;Show&#39;, article_path(article) %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= link_to &#39;Edit&#39;, edit_article_path(article) %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%= link_to &#39;Destroy&#39;, article_path(article),
              method: :delete,
              data: { confirm: &#39;Are you sure?&#39; } %&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;% end %&gt;
&lt;/table&gt;</pre>

<p>Here we&#39;re using <code>link_to</code> in a different way. We pass the
named route as the second argument, and then the options as another
argument. The <code>:method</code> and <code>:&#39;data-confirm&#39;</code>
options are used as HTML5 attributes so that when the link is clicked,
Rails will first show a confirm dialog to the user, and then submit the
link with method <code>delete</code>. This is done via the JavaScript file
<code>jquery_ujs</code> which is automatically included into your
application&#39;s layout
(<code>app/views/layouts/application.html.erb</code>) when you generated
the application. Without this file, the confirmation dialog box
wouldn&#39;t appear.</p>

<p><img src="images/getting_started/confirm_dialog.png"></p>

<p>Congratulations, you can now create, show, list, update and destroy
articles.</p>

<p>TIP: In general, Rails encourages using resources objects instead of
declaring routes manually. For more information about routing, see <a
href="routing.html">Rails Routing from the Outside In</a>.</p>

<h2 id="label-Adding+a+Second+Model">Adding a Second Model<span><a href="#label-Adding+a+Second+Model">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>It&#39;s time to add a second model to the application. The second model
will handle comments on articles.</p>

<h3 id="label-Generating+a+Model">Generating a Model<span><a href="#label-Generating+a+Model">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>We&#39;re going to see the same generator that we used before when creating
the <code>Article</code> model. This time we&#39;ll create a
<code>Comment</code> model to hold reference of article comments. Run this
command in your terminal:</p>

<pre>$ bin/rails generate model Comment commenter:string body:text article:references</pre>

<p>This command will generate four files:</p>

<p>| File | Purpose | | ——————————————– | —————————————————————————————————— |
| db/migrate/20140120201010_create_comments.rb | Migration to create the
comments table in your database (your name will include a different
timestamp) | | app/models/comment.rb | The <a
href="../../Comment.html">Comment</a> model | | test/models/comment_test.rb
| Testing harness for the comments model | | test/fixtures/comments.yml |
Sample comments for use in testing |</p>

<p>First, take a look at <code>app/models/comment.rb</code>:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">article</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This is very similar to the <code>Article</code> model that you saw
earlier. The difference is the line <code>belongs_to :article</code>, which
sets up an Active Record <em>association</em>. You&#39;ll learn a little
about associations in the next section of this guide.</p>

<p>In addition to the model, Rails has also made a migration to create the
corresponding database table:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">CreateComments</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">change</span>
    <span class="ruby-identifier">create_table</span> :<span class="ruby-identifier">comments</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">string</span> :<span class="ruby-identifier">commenter</span>
      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">text</span> :<span class="ruby-identifier">body</span>

      <span class="ruby-comment"># this line adds an integer column called `article_id`.</span>
      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">references</span> :<span class="ruby-identifier">article</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>

      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">timestamps</span> <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">add_foreign_key</span> :<span class="ruby-identifier">comments</span>, :<span class="ruby-identifier">articles</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The <code>t.references</code> line sets up a foreign key column for the
association between the two models. An index for this association is also
created on this column. Go ahead and run the migration:</p>

<pre>$ bin/rake db:migrate</pre>

<p>Rails is smart enough to only execute the migrations that have not already
been run against the current database, so in this case you will just see:</p>

<pre>==  CreateComments: migrating =================================================
-- create_table(:comments)
   -&gt; 0.0115s
-- add_foreign_key(:comments, :articles)
   -&gt; 0.0000s
==  CreateComments: migrated (0.0119s) ========================================</pre>

<h3 id="label-Associating+Models">Associating Models<span><a href="#label-Associating+Models">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Active Record associations let you easily declare the relationship between
two models. In the case of comments and articles, you could write out the
relationships this way:</p>
<ul><li>
<p>Each comment belongs to one article.</p>
</li><li>
<p>One article can have many comments.</p>
</li></ul>

<p>In fact, this is very close to the syntax that Rails uses to declare this
association. You&#39;ve already seen the line of code inside the
<code>Comment</code> model (app/models/comment.rb) that makes each comment
belong to an Article:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">article</span>
<span class="ruby-keyword">end</span>
</pre>

<p>You&#39;ll need to edit <code>app/models/article.rb</code> to add the other
side of the association:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Article</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">comments</span>
  <span class="ruby-identifier">validates</span> :<span class="ruby-identifier">title</span>, <span class="ruby-identifier">presence</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
                    <span class="ruby-identifier">length</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">minimum</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span> }
<span class="ruby-keyword">end</span>
</pre>

<p>These two declarations enable a good bit of automatic behavior. For
example, if you have an instance variable <code>@article</code> containing
an article, you can retrieve all the comments belonging to that article as
an array using <code>@article.comments</code>.</p>

<p>TIP: For more information on Active Record associations, see the <a
href="association_basics.html">Active Record Associations</a> guide.</p>

<h3 id="label-Adding+a+Route+for+Comments">Adding a Route for Comments<span><a href="#label-Adding+a+Route+for+Comments">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>As with the <code>welcome</code> controller, we will need to add a route so
that Rails knows where we would like to navigate to see
<code>comments</code>. Open up the <code>config/routes.rb</code> file
again, and edit it as follows:</p>

<pre class="ruby"><span class="ruby-identifier">resources</span> :<span class="ruby-identifier">articles</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">resources</span> :<span class="ruby-identifier">comments</span>
<span class="ruby-keyword">end</span>
</pre>

<p>This creates <code>comments</code> as a <em>nested resource</em> within
<code>articles</code>. This is another part of capturing the hierarchical
relationship that exists between articles and comments.</p>

<p>TIP: For more information on routing, see the <a href="routing.html">Rails
Routing</a> guide.</p>

<h3 id="label-Generating+a+Controller">Generating a Controller<span><a href="#label-Generating+a+Controller">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>With the model in hand, you can turn your attention to creating a matching
controller. Again, we&#39;ll use the same generator we used before:</p>

<pre>$ bin/rails generate controller Comments</pre>

<p>This creates five files and one empty directory:</p>

<p>| File/Directory | Purpose | | ——————————————– | —————————————- | |
app/controllers/comments_controller.rb | The Comments controller | |
app/views/comments/ | Views of the controller are stored here | |
test/controllers/comments_controller_test.rb | The test for the controller
| | app/helpers/comments_helper.rb | A view helper file | |
app/assets/javascripts/comment.js.coffee | CoffeeScript for the controller
| | app/assets/stylesheets/comment.css.scss | Cascading style sheet for the
controller |</p>

<p>Like with any blog, our readers will create their comments directly after
reading the article, and once they have added their comment, will be sent
back to the article show page to see their comment now listed. Due to this,
our <code>CommentsController</code> is there to provide a method to create
comments and delete spam comments when they arrive.</p>

<p>So first, we&#39;ll wire up the Article show template
(<code>app/views/articles/show.html.erb</code>) to let us make a new
comment:</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Title:&lt;/strong&gt;
  &lt;%= @article.title %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Text:&lt;/strong&gt;
  &lt;%= @article.text %&gt;
&lt;/p&gt;

&lt;h2&gt;Add a comment:&lt;/h2&gt;
&lt;%= form_for([@article, @article.comments.build]) do |f| %&gt;
  &lt;p&gt;
    &lt;%= f.label :commenter %&gt;&lt;br&gt;
    &lt;%= f.text_field :commenter %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.label :body %&gt;&lt;br&gt;
    &lt;%= f.text_area :body %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;
&lt;% end %&gt;

&lt;%= link_to &#39;Edit&#39;, edit_article_path(@article) %&gt; |
&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>This adds a form on the <code>Article</code> show page that creates a new
comment by calling the <code>CommentsController</code> <code>create</code>
action. The <code>form_for</code> call here uses an array, which will build
a nested route, such as <code>/articles/1/comments</code>.</p>

<p>Let&#39;s wire up the <code>create</code> in
<code>app/controllers/comments_controller.rb</code>:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">CommentsController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">article_id</span>])
    <span class="ruby-ivar">@comment</span> = <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">comment_params</span>)
    <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">article_path</span>(<span class="ruby-ivar">@article</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">private</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">comment_params</span>
      <span class="ruby-identifier">params</span>.<span class="ruby-identifier">require</span>(:<span class="ruby-identifier">comment</span>).<span class="ruby-identifier">permit</span>(:<span class="ruby-identifier">commenter</span>, :<span class="ruby-identifier">body</span>)
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>You&#39;ll see a bit more complexity here than you did in the controller
for articles. That&#39;s a side-effect of the nesting that you&#39;ve set
up. Each request for a comment has to keep track of the article to which
the comment is attached, thus the initial call to the <code>find</code>
method of the <code>Article</code> model to get the article in question.</p>

<p>In addition, the code takes advantage of some of the methods available for
an association. We use the <code>create</code> method on
<code>@article.comments</code> to create and save the comment. This will
automatically link the comment so that it belongs to that particular
article.</p>

<p>Once we have made the new comment, we send the user back to the original
article using the <code>article_path(@article)</code> helper. As we have
already seen, this calls the <code>show</code> action of the
<code>ArticlesController</code> which in turn renders the
<code>show.html.erb</code> template. This is where we want the comment to
show, so let&#39;s add that to the
<code>app/views/articles/show.html.erb</code>.</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Title:&lt;/strong&gt;
  &lt;%= @article.title %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Text:&lt;/strong&gt;
  &lt;%= @article.text %&gt;
&lt;/p&gt;

&lt;h2&gt;Comments&lt;/h2&gt;
&lt;% @article.comments.each do |comment| %&gt;
  &lt;p&gt;
    &lt;strong&gt;Commenter:&lt;/strong&gt;
    &lt;%= comment.commenter %&gt;
  &lt;/p&gt;

  &lt;p&gt;
    &lt;strong&gt;Comment:&lt;/strong&gt;
    &lt;%= comment.body %&gt;
  &lt;/p&gt;
&lt;% end %&gt;

&lt;h2&gt;Add a comment:&lt;/h2&gt;
&lt;%= form_for([@article, @article.comments.build]) do |f| %&gt;
  &lt;p&gt;
    &lt;%= f.label :commenter %&gt;&lt;br&gt;
    &lt;%= f.text_field :commenter %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.label :body %&gt;&lt;br&gt;
    &lt;%= f.text_area :body %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;
&lt;% end %&gt;

&lt;%= link_to &#39;Edit&#39;, edit_article_path(@article) %&gt; |
&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>Now you can add articles and comments to your blog and have them show up in
the right places.</p>

<p><img src="images/getting_started/article_with_comments.png"></p>

<h2 id="label-Refactoring">Refactoring<span><a href="#label-Refactoring">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Now that we have articles and comments working, take a look at the
<code>app/views/articles/show.html.erb</code> template. It is getting long
and awkward. We can use partials to clean it up.</p>

<h3 id="label-Rendering+Partial+Collections">Rendering Partial Collections<span><a href="#label-Rendering+Partial+Collections">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>First, we will make a comment partial to extract showing all the comments
for the article. Create the file
<code>app/views/comments/_comment.html.erb</code> and put the following
into it:</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Commenter:&lt;/strong&gt;
  &lt;%= comment.commenter %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Comment:&lt;/strong&gt;
  &lt;%= comment.body %&gt;
&lt;/p&gt;</pre>

<p>Then you can change <code>app/views/articles/show.html.erb</code> to look
like the following:</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Title:&lt;/strong&gt;
  &lt;%= @article.title %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Text:&lt;/strong&gt;
  &lt;%= @article.text %&gt;
&lt;/p&gt;

&lt;h2&gt;Comments&lt;/h2&gt;
&lt;%= render @article.comments %&gt;

&lt;h2&gt;Add a comment:&lt;/h2&gt;
&lt;%= form_for([@article, @article.comments.build]) do |f| %&gt;
  &lt;p&gt;
    &lt;%= f.label :commenter %&gt;&lt;br&gt;
    &lt;%= f.text_field :commenter %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.label :body %&gt;&lt;br&gt;
    &lt;%= f.text_area :body %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;
&lt;% end %&gt;

&lt;%= link_to &#39;Edit&#39;, edit_article_path(@article) %&gt; |
&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>This will now render the partial in
<code>app/views/comments/_comment.html.erb</code> once for each comment
that is in the <code>@article.comments</code> collection. As the
<code>render</code> method iterates over the <code>@article.comments</code>
collection, it assigns each comment to a local variable named the same as
the partial, in this case <code>comment</code> which is then available in
the partial for us to show.</p>

<h3 id="label-Rendering+a+Partial+Form">Rendering a Partial Form<span><a href="#label-Rendering+a+Partial+Form">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Let us also move that new comment section out to its own partial. Again,
you create a file <code>app/views/comments/_form.html.erb</code>
containing:</p>

<pre>&lt;%= form_for([@article, @article.comments.build]) do |f| %&gt;
  &lt;p&gt;
    &lt;%= f.label :commenter %&gt;&lt;br&gt;
    &lt;%= f.text_field :commenter %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.label :body %&gt;&lt;br&gt;
    &lt;%= f.text_area :body %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.submit %&gt;
  &lt;/p&gt;
&lt;% end %&gt;</pre>

<p>Then you make the <code>app/views/articles/show.html.erb</code> look like
the following:</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Title:&lt;/strong&gt;
  &lt;%= @article.title %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Text:&lt;/strong&gt;
  &lt;%= @article.text %&gt;
&lt;/p&gt;

&lt;h2&gt;Comments&lt;/h2&gt;
&lt;%= render @article.comments %&gt;

&lt;h2&gt;Add a comment:&lt;/h2&gt;
&lt;%= render &#39;comments/form&#39; %&gt;

&lt;%= link_to &#39;Edit&#39;, edit_article_path(@article) %&gt; |
&lt;%= link_to &#39;Back&#39;, articles_path %&gt;</pre>

<p>The second render just defines the partial template we want to render,
<code>comments/form</code>. Rails is smart enough to spot the forward slash
in that string and realize that you want to render the
<code>_form.html.erb</code> file in the <code>app/views/comments</code>
directory.</p>

<p>The <code>@article</code> object is available to any partials rendered in
the view because we defined it as an instance variable.</p>

<h2 id="label-Deleting+Comments">Deleting Comments<span><a href="#label-Deleting+Comments">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Another important feature of a blog is being able to delete spam comments.
To do this, we need to implement a link of some sort in the view and a
<code>destroy</code> action in the <code>CommentsController</code>.</p>

<p>So first, let&#39;s add the delete link in the
<code>app/views/comments/_comment.html.erb</code> partial:</p>

<pre>&lt;p&gt;
  &lt;strong&gt;Commenter:&lt;/strong&gt;
  &lt;%= comment.commenter %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;strong&gt;Comment:&lt;/strong&gt;
  &lt;%= comment.body %&gt;
&lt;/p&gt;

&lt;p&gt;
  &lt;%= link_to &#39;Destroy Comment&#39;, [comment.article, comment],
               method: :delete,
               data: { confirm: &#39;Are you sure?&#39; } %&gt;
&lt;/p&gt;</pre>

<p>Clicking this new “Destroy Comment” link will fire off a <code>DELETE
/articles/:article_id/comments/:id</code> to our
<code>CommentsController</code>, which can then use this to find the
comment we want to delete, so let&#39;s add a <code>destroy</code> action
to our controller (<code>app/controllers/comments_controller.rb</code>):</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">CommentsController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">article_id</span>])
    <span class="ruby-ivar">@comment</span> = <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">comment_params</span>)
    <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">article_path</span>(<span class="ruby-ivar">@article</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">article_id</span>])
    <span class="ruby-ivar">@comment</span> = <span class="ruby-ivar">@article</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">id</span>])
    <span class="ruby-ivar">@comment</span>.<span class="ruby-identifier">destroy</span>
    <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">article_path</span>(<span class="ruby-ivar">@article</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">private</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">comment_params</span>
      <span class="ruby-identifier">params</span>.<span class="ruby-identifier">require</span>(:<span class="ruby-identifier">comment</span>).<span class="ruby-identifier">permit</span>(:<span class="ruby-identifier">commenter</span>, :<span class="ruby-identifier">body</span>)
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The <code>destroy</code> action will find the article we are looking at,
locate the comment within the <code>@article.comments</code> collection,
and then remove it from the database and send us back to the show action
for the article.</p>

<h3 id="label-Deleting+Associated+Objects">Deleting Associated Objects<span><a href="#label-Deleting+Associated+Objects">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you delete an article, its associated comments will also need to be
deleted, otherwise they would simply occupy space in the database. Rails
allows you to use the <code>dependent</code> option of an association to
achieve this. Modify the Article model, <code>app/models/article.rb</code>,
as follows:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Article</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
  <span class="ruby-identifier">has_many</span> :<span class="ruby-identifier">comments</span>, <span class="ruby-identifier">dependent</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">destroy</span>
  <span class="ruby-identifier">validates</span> :<span class="ruby-identifier">title</span>, <span class="ruby-identifier">presence</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
                    <span class="ruby-identifier">length</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">minimum</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span> }
<span class="ruby-keyword">end</span>
</pre>

<h2 id="label-Security">Security<span><a href="#label-Security">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-Basic+Authentication">Basic Authentication<span><a href="#label-Basic+Authentication">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>If you were to publish your blog online, anyone would be able to add, edit
and delete articles or delete comments.</p>

<p>Rails provides a very simple HTTP authentication system that will work
nicely in this situation.</p>

<p>In the <code>ArticlesController</code> we need to have a way to block
access to the various actions if the person is not authenticated. Here we
can use the Rails <code>http_basic_authenticate_with</code> method, which
allows access to the requested action if that method allows it.</p>

<p>To use the authentication system, we specify it at the top of our
<code>ArticlesController</code> in
<code>app/controllers/articles_controller.rb</code>. In our case, we want
the user to be authenticated on every action except <code>index</code> and
<code>show</code>, so we write that:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">ArticlesController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>

  <span class="ruby-identifier">http_basic_authenticate_with</span> <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;dhh&quot;</span>, <span class="ruby-identifier">password</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;secret&quot;</span>, <span class="ruby-identifier">except</span><span class="ruby-operator">:</span> [:<span class="ruby-identifier">index</span>, :<span class="ruby-identifier">show</span>]

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
    <span class="ruby-ivar">@articles</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># snipped for brevity</span>
</pre>

<p>We also want to allow only authenticated users to delete comments, so in
the <code>CommentsController</code>
(<code>app/controllers/comments_controller.rb</code>) we write:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">CommentsController</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ApplicationController</span>

  <span class="ruby-identifier">http_basic_authenticate_with</span> <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;dhh&quot;</span>, <span class="ruby-identifier">password</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;secret&quot;</span>, <span class="ruby-identifier">only</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">destroy</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
    <span class="ruby-ivar">@article</span> = <span class="ruby-constant">Article</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[:<span class="ruby-identifier">article_id</span>])
    <span class="ruby-comment"># ...</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># snipped for brevity</span>
</pre>

<p>Now if you try to create a new article, you will be greeted with a basic
HTTP Authentication challenge:</p>

<p><img src="images/getting_started/challenge.png"></p>

<p>Other authentication methods are available for Rails applications. Two
popular authentication add-ons for Rails are the <a
href="https://github.com/plataformatec/devise">Devise</a> rails engine and
the <a href="https://github.com/binarylogic/authlogic">Authlogic</a> gem,
along with a number of others.</p>

<h3 id="label-Other+Security+Considerations">Other Security Considerations<span><a href="#label-Other+Security+Considerations">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Security, especially in web applications, is a broad and detailed area.
Security in your Rails application is covered in more depth in the <a
href="security.html">Ruby on Rails Security Guide</a>.</p>

<h2 id="label-What-27s+Next-3F">What&#39;s Next?<span><a href="#label-What-27s+Next-3F">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Now that you&#39;ve seen your first Rails application, you should feel free
to update it and experiment on your own. But you don&#39;t have to do
everything without help. As you need assistance getting up and running with
Rails, feel free to consult these support resources:</p>
<ul><li>
<p>The <a href="index.html">Ruby on Rails Guides</a></p>
</li><li>
<p>The <a href="http://railstutorial.org/book">Ruby on Rails Tutorial</a></p>
</li><li>
<p>The <a href="http://groups.google.com/group/rubyonrails-talk">Ruby on Rails
mailing list</a></p>
</li><li>
<p>The <a href="irc://irc.freenode.net/#rubyonrails">#rubyonrails</a> channel
on irc.freenode.net</p>
</li></ul>

<p>Rails also comes with built-in help that you can generate using the rake
command-line utility:</p>
<ul><li>
<p>Running <code>rake doc:guides</code> will put a full copy of the Rails
Guides in the  <code>doc/guides</code> folder of your application. Open
<code>doc/guides/index.html</code> in your  web browser to explore the
Guides.</p>
</li><li>
<p>Running <code>rake doc:rails</code> will put a full copy of the API
documentation for  Rails in the <code>doc/api</code> folder of your
application. Open <code>doc/api/index.html</code>  in your web browser to
explore the API documentation.</p>
</li></ul>

<p>TIP: To be able to generate the Rails Guides locally with the
<code>doc:guides</code> rake task you need to install the RedCloth and
Nokogiri gems. Add it to your <code>Gemfile</code> and run <code>bundle
install</code> and you&#39;re ready to go.</p>

<h2 id="label-Configuration+Gotchas">Configuration Gotchas<span><a href="#label-Configuration+Gotchas">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The easiest way to work with Rails is to store all external data as UTF-8.
If you don&#39;t, Ruby libraries and Rails will often be able to convert
your native data into UTF-8, but this doesn&#39;t always work reliably, so
you&#39;re better off ensuring that all external data is UTF-8.</p>

<p>If you have made a mistake in this area, the most common symptom is a black
diamond with a question mark inside appearing in the browser. Another
common symptom is characters like “Ã¼” appearing instead of “ü”. Rails
takes a number of internal steps to mitigate common causes of these
problems that can be automatically detected and corrected. However, if you
have external data that is not stored as UTF-8, it can occasionally result
in these kinds of issues that cannot be automatically detected by Rails and
corrected.</p>

<p>Two very common sources of data that are not UTF-8:</p>
<ul><li>
<p>Your text editor: Most text editors (such as TextMate), default to saving 
files as UTF-8. If your text editor does not, this can result in special 
characters that you enter in your templates (such as é) to appear as a
diamond  with a question mark inside in the browser. This also applies to
your i18n  translation files. Most editors that do not already default to
UTF-8 (such as  some versions of Dreamweaver) offer a way to change the
default to UTF-8. Do  so.</p>
</li><li>
<p>Your database: Rails defaults to converting data from your database into
UTF-8  at the boundary. However, if your database is not using UTF-8
internally, it  may not be able to store all characters that your users
enter. For instance,  if your database is using Latin-1 internally, and
your user enters a Russian,  Hebrew, or Japanese character, the data will
be lost forever once it enters  the database. If possible, use UTF-8 as the
internal storage of your database.</p>
</li></ul>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

