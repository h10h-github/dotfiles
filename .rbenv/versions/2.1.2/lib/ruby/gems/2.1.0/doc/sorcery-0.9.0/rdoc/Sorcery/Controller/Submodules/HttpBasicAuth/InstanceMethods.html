<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sorcery::Controller::Submodules::HttpBasicAuth::InstanceMethods - sorcery-0.9.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../../";
</script>

<script src="../../../../js/jquery.js"></script>
<script src="../../../../js/darkfish.js"></script>

<link href="../../../../css/fonts.css" rel="stylesheet">
<link href="../../../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-login_from_basic_auth">#login_from_basic_auth</a>
    
    <li ><a href="#method-i-realm_name_by_controller">#realm_name_by_controller</a>
    
    <li ><a href="#method-i-require_login_from_http_basic">#require_login_from_http_basic</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Sorcery::Controller::Submodules::HttpBasicAuth::InstanceMethods">
  <h1 id="module-Sorcery::Controller::Submodules::HttpBasicAuth::InstanceMethods" class="module">
    module Sorcery::Controller::Submodules::HttpBasicAuth::InstanceMethods
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Protected Instance Methods</h3>
       </header>

    
      <div id="method-i-login_from_basic_auth" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">login_from_basic_auth</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>given to main controller module as a login source callback</p>
          
          

          
          <div class="method-source-code" id="login_from_basic_auth-source">
            <pre><span class="ruby-comment"># File lib/sorcery/controller/submodules/http_basic_auth.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">login_from_basic_auth</span>
  <span class="ruby-identifier">authenticate_with_http_basic</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@current_user</span> = (<span class="ruby-identifier">user_class</span>.<span class="ruby-identifier">authenticate</span>(<span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:http_authentication_used</span>]) <span class="ruby-operator">||</span> <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">auto_login</span>(<span class="ruby-ivar">@current_user</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@current_user</span>
    <span class="ruby-ivar">@current_user</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-realm_name_by_controller" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">realm_name_by_controller</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets the realm name by searching the controller name in the hash given at
configuration time.</p>
          
          

          
          <div class="method-source-code" id="realm_name_by_controller-source">
            <pre><span class="ruby-comment"># File lib/sorcery/controller/submodules/http_basic_auth.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">realm_name_by_controller</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>)
    <span class="ruby-identifier">current_controller</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">current_controller</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">ActionController</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
      <span class="ruby-identifier">result</span> = <span class="ruby-constant">Config</span>.<span class="ruby-identifier">controller_to_realm_map</span>[<span class="ruby-identifier">current_controller</span>.<span class="ruby-identifier">controller_name</span>]
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>
      <span class="ruby-identifier">current_controller</span> = <span class="ruby-identifier">current_controller</span>.<span class="ruby-identifier">superclass</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Config</span>.<span class="ruby-identifier">controller_to_realm_map</span>[<span class="ruby-string">&quot;application&quot;</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-require_login_from_http_basic" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">require_login_from_http_basic</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>to be used as a before_filter. The method sets a session when requesting
the user&#39;s credentials. This is a trick to overcome the way HTTP
authentication works (explained below):</p>

<p>Once the user fills the credentials once, the browser will always send it
to the  server when visiting the website, until the browser is closed. This
causes wierd behaviour if the user logs out. The session is reset, yet the 
user is re-logged in by the before_filter calling
&#39;login_from_basic_auth&#39;. To overcome this, we set a session when
requesting the password, which logout will reset, and that&#39;s how we
know if we need to request for HTTP auth again.</p>
          
          

          
          <div class="method-source-code" id="require_login_from_http_basic-source">
            <pre><span class="ruby-comment"># File lib/sorcery/controller/submodules/http_basic_auth.rb, line 39</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">require_login_from_http_basic</span>
  (<span class="ruby-identifier">request_http_basic_authentication</span>(<span class="ruby-identifier">realm_name_by_controller</span>) <span class="ruby-keyword">and</span> (<span class="ruby-identifier">session</span>[<span class="ruby-value">:http_authentication_used</span>] = <span class="ruby-keyword">true</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span>) <span class="ruby-keyword">if</span> (<span class="ruby-identifier">request</span>.<span class="ruby-identifier">authorization</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:http_authentication_used</span>].<span class="ruby-identifier">nil?</span>)
  <span class="ruby-identifier">require_login</span>
  <span class="ruby-identifier">session</span>[<span class="ruby-value">:http_authentication_used</span>] = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logged_in?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

