<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Sorcery::CryptoProviders::AES256 - sorcery-0.9.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-aes">::aes</a>
    
    <li ><a href="#method-c-decrypt">::decrypt</a>
    
    <li ><a href="#method-c-encrypt">::encrypt</a>
    
    <li ><a href="#method-c-matches-3F">::matches?</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Sorcery::CryptoProviders::AES256">
  <h1 id="class-Sorcery::CryptoProviders::AES256" class="class">
    class Sorcery::CryptoProviders::AES256
  </h1>

  <section class="description">
    
<p>This encryption method is reversible if you have the supplied key.  So in
order to use this encryption method you must supply it with a key first. In
an initializer, or before your application initializes, you should do the
following:</p>

<pre class="ruby"><span class="ruby-constant">Sorcery</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigAES256</span>.<span class="ruby-identifier">key</span> = <span class="ruby-string">&quot;my 32 bytes long key&quot;</span>
</pre>

<p>My final comment is that this is a strong encryption method,  but its main
weakness is that its reversible. If you do not need to reverse the hash
then you should consider Sha512 or <a href="BCrypt.html">BCrypt</a>
instead.</p>

<p>Keep your key in a safe place, some even say the key should be stored on a
separate server. This won&#39;t hurt performance because the only time it
will try and access the key on the  separate server is during
initialization, which only happens once. The reasoning behind this is if
someone does compromise your server they  won&#39;t have the key also.
Basically, you don&#39;t want to store the key with the lock.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-c-key" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">key</span><span
            class="attribute-access-type">[W]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-decrypt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decrypt</span><span
            class="method-args">(crypted)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="decrypt-source">
            <pre><span class="ruby-comment"># File lib/sorcery/crypto_providers/aes256.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decrypt</span>(<span class="ruby-identifier">crypted</span>)
  <span class="ruby-identifier">aes</span>.<span class="ruby-identifier">decrypt</span>
  <span class="ruby-identifier">aes</span>.<span class="ruby-identifier">key</span> = <span class="ruby-ivar">@key</span>
  (<span class="ruby-identifier">aes</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">crypted</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&quot;m&quot;</span>).<span class="ruby-identifier">first</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">aes</span>.<span class="ruby-identifier">final</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-encrypt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">encrypt</span><span
            class="method-args">(*tokens)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="encrypt-source">
            <pre><span class="ruby-comment"># File lib/sorcery/crypto_providers/aes256.rb, line 24</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">encrypt</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">tokens</span>)
  <span class="ruby-identifier">aes</span>.<span class="ruby-identifier">encrypt</span>
  <span class="ruby-identifier">aes</span>.<span class="ruby-identifier">key</span> = <span class="ruby-ivar">@key</span>
  [<span class="ruby-identifier">aes</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">tokens</span>.<span class="ruby-identifier">join</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">aes</span>.<span class="ruby-identifier">final</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-string">&quot;m&quot;</span>).<span class="ruby-identifier">chomp</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-matches-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">matches?</span><span
            class="method-args">(crypted, *tokens)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="matches-3F-source">
            <pre><span class="ruby-comment"># File lib/sorcery/crypto_providers/aes256.rb, line 30</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">matches?</span>(<span class="ruby-identifier">crypted</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">tokens</span>)
  <span class="ruby-identifier">decrypt</span>(<span class="ruby-identifier">crypted</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">tokens</span>.<span class="ruby-identifier">join</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">CipherError</span>
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Class Methods</h3>
       </header>

    
      <div id="method-c-aes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">aes</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="aes-source">
            <pre><span class="ruby-comment"># File lib/sorcery/crypto_providers/aes256.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">aes</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{name} expects a 32 bytes long key. Please use Sorcery::Model::Config.encryption_key to set it.&quot;</span>) <span class="ruby-keyword">if</span> ( <span class="ruby-ivar">@key</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@key</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span> )
  <span class="ruby-ivar">@aes</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span><span class="ruby-operator">::</span><span class="ruby-constant">Cipher</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;AES-256-ECB&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

