<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sorcery::Model::Submodules::BruteForceProtection - sorcery-0.9.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../";
</script>

<script src="../../../js/jquery.js"></script>
<script src="../../../js/darkfish.js"></script>

<link href="../../../css/fonts.css" rel="stylesheet">
<link href="../../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    <div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    
  
    <li><a class="extend" href="BruteForceProtection/ClassMethods.html">Sorcery::Model::Submodules::BruteForceProtection::ClassMethods</a>
  
  
  </ul>
</div>

    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-included">::included</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Sorcery::Model::Submodules::BruteForceProtection">
  <h1 id="module-Sorcery::Model::Submodules::BruteForceProtection" class="module">
    module Sorcery::Model::Submodules::BruteForceProtection
  </h1>

  <section class="description">
    
<p>This module helps protect user accounts by locking them down after too many
failed attemps to login were detected. This is the model part of the
submodule which provides configuration options and methods for locking and
unlocking the user.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-included" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">included</span><span
            class="method-args">(base)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="included-source">
            <pre><span class="ruby-comment"># File lib/sorcery/model/submodules/brute_force_protection.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">included</span>(<span class="ruby-identifier">base</span>)
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">attr_accessor</span> <span class="ruby-value">:failed_logins_count_attribute_name</span>,        <span class="ruby-comment"># failed logins attribute name.</span>
                  <span class="ruby-value">:lock_expires_at_attribute_name</span>,            <span class="ruby-comment"># this field indicates whether user</span>
                                                              <span class="ruby-comment"># is banned and when it will be active again.</span>
                  <span class="ruby-value">:consecutive_login_retries_amount_limit</span>,    <span class="ruby-comment"># how many failed logins allowed.</span>
                  <span class="ruby-value">:login_lock_time_period</span>,                    <span class="ruby-comment"># how long the user should be banned.</span>
                                                              <span class="ruby-comment"># in seconds. 0 for permanent.</span>

                  <span class="ruby-value">:unlock_token_attribute_name</span>,               <span class="ruby-comment"># Unlock token attribute name</span>
                  <span class="ruby-value">:unlock_token_email_method_name</span>,            <span class="ruby-comment"># Mailer method name</span>
                  <span class="ruby-value">:unlock_token_mailer_disabled</span>,              <span class="ruby-comment"># When true, dont send unlock token via email</span>
                  <span class="ruby-value">:unlock_token_mailer</span>                        <span class="ruby-comment">#Â Mailer class</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@defaults</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:@failed_logins_count_attribute_name</span>              =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:failed_logins_count</span>,
                     <span class="ruby-value">:@lock_expires_at_attribute_name</span>                  =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:lock_expires_at</span>,
                     <span class="ruby-value">:@consecutive_login_retries_amount_limit</span>          =<span class="ruby-operator">&gt;</span> <span class="ruby-value">50</span>,
                     <span class="ruby-value">:@login_lock_time_period</span>                          =<span class="ruby-operator">&gt;</span> <span class="ruby-value">60</span> <span class="ruby-operator">*</span> <span class="ruby-value">60</span>,

                     <span class="ruby-value">:@unlock_token_attribute_name</span>                     =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unlock_token</span>,
                     <span class="ruby-value">:@unlock_token_email_method_name</span>                  =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:send_unlock_token_email</span>,
                     <span class="ruby-value">:@unlock_token_mailer_disabled</span>                    =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
                     <span class="ruby-value">:@unlock_token_mailer</span>                             =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>)
    <span class="ruby-identifier">reset!</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">before_authenticate</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:prevent_locked_user_login</span>
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">after_config</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:define_brute_force_protection_fields</span>
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">ClassMethods</span>)
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:include</span>, <span class="ruby-constant">InstanceMethods</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

