<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sorcery::Model::Submodules::UserActivation - sorcery-0.9.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../";
</script>

<script src="../../../js/jquery.js"></script>
<script src="../../../js/darkfish.js"></script>

<link href="../../../css/fonts.css" rel="stylesheet">
<link href="../../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    <div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    
  
    <li><a class="extend" href="UserActivation/ClassMethods.html">Sorcery::Model::Submodules::UserActivation::ClassMethods</a>
  
  
  </ul>
</div>

    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-included">::included</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Sorcery::Model::Submodules::UserActivation">
  <h1 id="module-Sorcery::Model::Submodules::UserActivation" class="module">
    module Sorcery::Model::Submodules::UserActivation
  </h1>

  <section class="description">
    
<p>This submodule adds the ability to make the user activate his account via
email or any other way in which he can recieve an activation code. with the
activation code the user may activate his account. When using this
submodule, supplying a mailer is mandatory.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-included" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">included</span><span
            class="method-args">(base)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="included-source">
            <pre><span class="ruby-comment"># File lib/sorcery/model/submodules/user_activation.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">included</span>(<span class="ruby-identifier">base</span>)
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">attr_accessor</span> <span class="ruby-value">:activation_state_attribute_name</span>,               <span class="ruby-comment"># the attribute name to hold activation state</span>
                                                                  <span class="ruby-comment"># (active/pending).</span>

                  <span class="ruby-value">:activation_token_attribute_name</span>,               <span class="ruby-comment"># the attribute name to hold activation code</span>
                                                                  <span class="ruby-comment"># (sent by email).</span>

                  <span class="ruby-value">:activation_token_expires_at_attribute_name</span>,    <span class="ruby-comment"># the attribute name to hold activation code</span>
                                                                  <span class="ruby-comment"># expiration date.</span>

                  <span class="ruby-value">:activation_token_expiration_period</span>,            <span class="ruby-comment"># how many seconds before the activation code</span>
                                                                  <span class="ruby-comment"># expires. nil for never expires.</span>

                  <span class="ruby-value">:user_activation_mailer</span>,                        <span class="ruby-comment"># your mailer class. Required when</span>
                                                                  <span class="ruby-comment"># activation_mailer_disabled == false.</span>

                  <span class="ruby-value">:activation_mailer_disabled</span>,                    <span class="ruby-comment"># when true sorcery will not automatically</span>
                                                                  <span class="ruby-comment"># email activation details and allow you to</span>
                                                                  <span class="ruby-comment"># manually handle how and when email is sent</span>

                  <span class="ruby-value">:activation_needed_email_method_name</span>,           <span class="ruby-comment"># activation needed email method on your</span>
                                                                  <span class="ruby-comment"># mailer class.</span>

                  <span class="ruby-value">:activation_success_email_method_name</span>,          <span class="ruby-comment"># activation success email method on your</span>
                                                                  <span class="ruby-comment"># mailer class.</span>

                  <span class="ruby-value">:prevent_non_active_users_to_login</span>              <span class="ruby-comment"># do you want to prevent or allow users that</span>
                                                                  <span class="ruby-comment"># did not activate by email to login?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@defaults</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:@activation_state_attribute_name</span>             =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:activation_state</span>,
                     <span class="ruby-value">:@activation_token_attribute_name</span>             =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:activation_token</span>,
                     <span class="ruby-value">:@activation_token_expires_at_attribute_name</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:activation_token_expires_at</span>,
                     <span class="ruby-value">:@activation_token_expiration_period</span>          =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
                     <span class="ruby-value">:@user_activation_mailer</span>                      =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
                     <span class="ruby-value">:@activation_mailer_disabled</span>                  =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
                     <span class="ruby-value">:@activation_needed_email_method_name</span>         =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:activation_needed_email</span>,
                     <span class="ruby-value">:@activation_success_email_method_name</span>        =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:activation_success_email</span>,
                     <span class="ruby-value">:@prevent_non_active_users_to_login</span>           =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-identifier">reset!</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># don&#39;t setup activation if no password supplied - this user is created automatically</span>
    <span class="ruby-identifier">sorcery_adapter</span>.<span class="ruby-identifier">define_callback</span> <span class="ruby-value">:before</span>, <span class="ruby-value">:create</span>, <span class="ruby-value">:setup_activation</span>, <span class="ruby-value">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">password_attribute_name</span>).<span class="ruby-identifier">present?</span> }
    <span class="ruby-comment"># don&#39;t send activation needed email if no crypted password created - this user is external (OAuth etc.)</span>
    <span class="ruby-identifier">sorcery_adapter</span>.<span class="ruby-identifier">define_callback</span> <span class="ruby-value">:after</span>, <span class="ruby-value">:create</span>, <span class="ruby-value">:send_activation_needed_email!</span>, <span class="ruby-value">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:send_activation_needed_email?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">after_config</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:validate_mailer_defined</span>
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">after_config</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:define_user_activation_fields</span>
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">sorcery_config</span>.<span class="ruby-identifier">before_authenticate</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:prevent_non_active_login</span>

  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">ClassMethods</span>)
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:include</span>, <span class="ruby-constant">InstanceMethods</span>)


<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

